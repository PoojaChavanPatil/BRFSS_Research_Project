{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "6b4896dd-4738-421d-9b04-e61b0ce2364e",
   "metadata": {},
   "source": [
    "# BRFSS ANALYSIS (2013–2019): BINGE DRINKING & PHYSICAL HEALTH OUTCOMES\n",
    "# Pooja Chavanpatil\n",
    "# Last Updated: Sept 2025"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6883742d-01bb-4ce1-977c-1fc62a14ea62",
   "metadata": {},
   "outputs": [],
   "source": [
    "options(warn = 1)  # Show warnings as they occur\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "531f4578-a2f9-4164-95d1-348e8a812d1f",
   "metadata": {},
   "source": [
    "# STEP 1: Install Required Packages (One-Time Setup)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "06a333be-0231-4d5c-85b4-79e80b3c504a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'utils' is in use and will not be installed\"\n",
      "Installing packages into 'C:/Users/chava/AppData/Local/R/win-library/4.5'\n",
      "(as 'lib' is unspecified)\n",
      "\n",
      "Warning message:\n",
      "\"package 'splines' is a base package, and should not be updated\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "package 'tidyverse' successfully unpacked and MD5 sums checked\n",
      "package 'knitr' successfully unpacked and MD5 sums checked\n",
      "package 'tibble' successfully unpacked and MD5 sums checked\n",
      "package 'kableExtra' successfully unpacked and MD5 sums checked\n",
      "package 'officer' successfully unpacked and MD5 sums checked\n",
      "package 'skimr' successfully unpacked and MD5 sums checked\n",
      "package 'compareGroups' successfully unpacked and MD5 sums checked\n",
      "package 'car' successfully unpacked and MD5 sums checked\n",
      "package 'haven' successfully unpacked and MD5 sums checked\n",
      "package 'foreign' successfully unpacked and MD5 sums checked\n",
      "package 'tidyr' successfully unpacked and MD5 sums checked\n",
      "package 'magrittr' successfully unpacked and MD5 sums checked\n",
      "package 'data.table' successfully unpacked and MD5 sums checked\n",
      "package 'labelled' successfully unpacked and MD5 sums checked\n",
      "package 'ggplot2' successfully unpacked and MD5 sums checked\n",
      "package 'gridExtra' successfully unpacked and MD5 sums checked\n",
      "package 'ggeffects' successfully unpacked and MD5 sums checked\n",
      "package 'ggthemes' successfully unpacked and MD5 sums checked\n",
      "package 'gghighlight' successfully unpacked and MD5 sums checked\n",
      "package 'ggThemeAssist' successfully unpacked and MD5 sums checked\n",
      "package 'ggrepel' successfully unpacked and MD5 sums checked\n",
      "package 'ggpattern' successfully unpacked and MD5 sums checked\n",
      "package 'RColorBrewer' successfully unpacked and MD5 sums checked\n",
      "package 'ggpubr' successfully unpacked and MD5 sums checked\n",
      "package 'mice' successfully unpacked and MD5 sums checked\n",
      "package 'lme4' successfully unpacked and MD5 sums checked\n",
      "package 'lmerTest' successfully unpacked and MD5 sums checked\n",
      "package 'MuMIn' successfully unpacked and MD5 sums checked\n",
      "package 'MASS' successfully unpacked and MD5 sums checked\n",
      "package 'MASSExtra' successfully unpacked and MD5 sums checked\n",
      "package 'arm' successfully unpacked and MD5 sums checked\n",
      "package 'lattice' successfully unpacked and MD5 sums checked\n",
      "package 'pscl' successfully unpacked and MD5 sums checked\n",
      "package 'survival' successfully unpacked and MD5 sums checked\n",
      "package 'survey' successfully unpacked and MD5 sums checked\n",
      "package 'svycoxme' successfully unpacked and MD5 sums checked\n",
      "package 'srvyr' successfully unpacked and MD5 sums checked\n",
      "package 'survminer' successfully unpacked and MD5 sums checked\n",
      "package 'simPH' successfully unpacked and MD5 sums checked\n",
      "package 'ltm' successfully unpacked and MD5 sums checked\n",
      "package 'effects' successfully unpacked and MD5 sums checked\n",
      "package 'gt' successfully unpacked and MD5 sums checked\n",
      "package 'gtExtras' successfully unpacked and MD5 sums checked\n",
      "package 'gtsummary' successfully unpacked and MD5 sums checked\n",
      "package 'ggsurvfit' successfully unpacked and MD5 sums checked\n",
      "package 'glue' successfully unpacked and MD5 sums checked\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"cannot remove prior installation of package 'glue'\"\n",
      "Warning message in file.copy(savedcopy, lib, recursive = TRUE):\n",
      "\"problem copying C:\\Users\\chava\\AppData\\Local\\R\\win-library\\4.5\\00LOCK\\glue\\libs\\x64\\glue.dll to C:\\Users\\chava\\AppData\\Local\\R\\win-library\\4.5\\glue\\libs\\x64\\glue.dll: Permission denied\"\n",
      "Warning message:\n",
      "\"restored 'glue'\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "package 'flextable' successfully unpacked and MD5 sums checked\n",
      "package 'huxtable' successfully unpacked and MD5 sums checked\n",
      "package 'modelsummary' successfully unpacked and MD5 sums checked\n",
      "package 'broom' successfully unpacked and MD5 sums checked\n",
      "package 'broom.helpers' successfully unpacked and MD5 sums checked\n",
      "package 'broom.mixed' successfully unpacked and MD5 sums checked\n",
      "package 'tidycat' successfully unpacked and MD5 sums checked\n",
      "package 'jtools' successfully unpacked and MD5 sums checked\n",
      "package 'summarytools' successfully unpacked and MD5 sums checked\n",
      "package 'cmprsk' successfully unpacked and MD5 sums checked\n",
      "package 'sjstats' successfully unpacked and MD5 sums checked\n",
      "package 'sjPlot' successfully unpacked and MD5 sums checked\n",
      "package 'sjmisc' successfully unpacked and MD5 sums checked\n",
      "package 'sjlabelled' successfully unpacked and MD5 sums checked\n",
      "package 'parameters' successfully unpacked and MD5 sums checked\n",
      "package 'performance' successfully unpacked and MD5 sums checked\n",
      "package 'insight' successfully unpacked and MD5 sums checked\n",
      "package 'wesanderson' successfully unpacked and MD5 sums checked\n",
      "package 'showtext' successfully unpacked and MD5 sums checked\n",
      "package 'patchwork' successfully unpacked and MD5 sums checked\n",
      "package 'svyVGAM' successfully unpacked and MD5 sums checked\n",
      "package 'ggalluvial' successfully unpacked and MD5 sums checked\n",
      "package 'dotwhisker' successfully unpacked and MD5 sums checked\n",
      "package 'explore' successfully unpacked and MD5 sums checked\n",
      "package 'mgcv' successfully unpacked and MD5 sums checked\n",
      "package 'coxme' successfully unpacked and MD5 sums checked\n",
      "package 'see' successfully unpacked and MD5 sums checked\n",
      "package 'report' successfully unpacked and MD5 sums checked\n",
      "package 'ggiraph' successfully unpacked and MD5 sums checked\n",
      "package 'regmedint' successfully unpacked and MD5 sums checked\n",
      "package 'ggblanket' successfully unpacked and MD5 sums checked\n",
      "package 'flexoki' successfully unpacked and MD5 sums checked\n",
      "\n",
      "The downloaded binary packages are in\n",
      "\tC:\\Users\\chava\\AppData\\Local\\Temp\\RtmpWkZV61\\downloaded_packages\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "installing the source package 'extrafont'\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "# NOTE: This block installs all necessary packages for analysis.\n",
    "\n",
    "install.packages(c(\n",
    "  \"tidyverse\", \"knitr\", \"tibble\", \"kableExtra\", \"officer\", \"skimr\", \"compareGroups\", \n",
    "  \"car\", \"haven\", \"foreign\", \"tidyr\", \"magrittr\", \"utils\", \"data.table\", \"labelled\", \n",
    "  \"ggplot2\", \"gridExtra\", \"ggeffects\", \"ggthemes\", \"gghighlight\", \"ggThemeAssist\", \n",
    "  \"ggrepel\", \"ggpattern\", \"RColorBrewer\", \"ggpubr\", \"mice\", \"lme4\", \"lmerTest\", \n",
    "  \"MuMIn\", \"MASS\", \"MASSExtra\", \"arm\", \"lattice\", \"pscl\", \"survival\", \"survey\", \n",
    "  \"svycoxme\", \"srvyr\", \"survminer\", \"simPH\", \"ltm\", \"effects\", \"gt\", \"gtExtras\", \n",
    "  \"gtsummary\", \"ggsurvfit\", \"glue\", \"flextable\", \"huxtable\", \"modelsummary\", \"broom\", \n",
    "  \"broom.helpers\", \"broom.mixed\", \"tidycat\", \"jtools\", \"summarytools\", \"cmprsk\", \n",
    "  \"sjstats\", \"sjPlot\", \"sjmisc\", \"sjlabelled\", \"parameters\", \"performance\", \"insight\", \n",
    "  \"wesanderson\", \"extrafont\", \"showtext\", \"patchwork\", \"svyVGAM\", \"ggalluvial\", \n",
    "  \"dotwhisker\", \"explore\", \"mgcv\", \"coxme\", \"see\", \"report\", \"ggiraph\", \"regmedint\", \n",
    "  \"ggblanket\", \"flexoki\", \"splines\"\n",
    "))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1be2032-a2f2-45a5-8948-83b0f3c4103e",
   "metadata": {},
   "source": [
    "# STEP 2: Load Cleaned Dataset (2013–2019)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cd5f4467-15ee-45af-8bbe-4293ff52e727",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n",
      "Attaching package: 'dplyr'\n",
      "\n",
      "\n",
      "The following objects are masked from 'package:stats':\n",
      "\n",
      "    filter, lag\n",
      "\n",
      "\n",
      "The following objects are masked from 'package:base':\n",
      "\n",
      "    intersect, setdiff, setequal, union\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Load necessary package\n",
    "library(dplyr)   # For data manipulation\n",
    "\n",
    "# Set the file path to the .rda file\n",
    "file_path <- \"C:/Users/chava/Downloads/Recent_Research_Activity/brfss_2013_2019_cleaned.rda\"\n",
    "\n",
    "# Load the .rda file (contains `all_data` object)\n",
    "load(file_path)\n",
    "\n",
    "# Renamed the loaded object for clarity\n",
    "brfss_merged <- all_data\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "67d235e4-9333-4710-84ac-dcb62cb41f1a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "tibble [3,189,916 × 30] (S3: tbl_df/tbl/data.frame)\n",
      " $ year          : int [1:3189916] 2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 ...\n",
      " $ fmd           : num [1:3189916] 1 NA 0 NA 0 NA 1 NA NA NA ...\n",
      " $ binge         : num [1:3189916] 0 0 1 0 0 0 0 0 0 0 ...\n",
      " $ race          : chr [1:3189916] \"Non-Hispanic Black\" \"Non-Hispanic White\" \"Non-Hispanic White\" \"Non-Hispanic White\" ...\n",
      " $ sex           : num [1:3189916] 0 0 0 0 1 0 0 0 1 0 ...\n",
      " $ age           : chr [1:3189916] \"60-64\" \"50-59\" \"50-59\" \"60-64\" ...\n",
      " $ inc           : chr [1:3189916] \"$50k-$75k\" \"$75k+\" \"$75k+\" \"$50k-$75k\" ...\n",
      " $ edu           : chr [1:3189916] \"College Graduate\" \"Attended College\" \"College Graduate\" \"HS Graduate\" ...\n",
      " $ emp           : chr [1:3189916] \"Not in Labor Force\" \"Employed\" \"Employed\" \"Not in Labor Force\" ...\n",
      " $ marital       : chr [1:3189916] \"Divorced\" \"Married\" \"Married\" \"Married\" ...\n",
      " $ ins           : num [1:3189916] 1 1 1 1 1 1 1 1 1 1 ...\n",
      " $ home          : chr [1:3189916] \"Own\" \"Own\" \"Own\" \"Own\" ...\n",
      " $ smoke         : chr [1:3189916] \"Smoker\" \"Non-Smoker\" \"Smoker\" \"Non-Smoker\" ...\n",
      " $ heavy         : chr [1:3189916] \"No\" \"No\" \"Yes\" \"No\" ...\n",
      " $ active        : chr [1:3189916] \"No\" \"Yes\" \"No\" \"Yes\" ...\n",
      " $ bmi           : chr [1:3189916] \"Obese\" \"Normal Weight\" \"Overweight\" \"Normal Weight\" ...\n",
      " $ asthma        : chr [1:3189916] \"Yes\" \"No\" \"No\" \"No\" ...\n",
      " $ arth          : chr [1:3189916] \"Yes\" \"No\" \"Yes\" \"No\" ...\n",
      " $ copd          : chr [1:3189916] \"Yes\" \"No\" \"No\" \"No\" ...\n",
      " $ chd           : chr [1:3189916] NA \"No\" \"No\" \"No\" ...\n",
      " $ diab          : chr [1:3189916] \"No\" \"No\" \"No\" \"No\" ...\n",
      " $ kidney        : chr [1:3189916] \"Yes\" \"No\" \"No\" \"No\" ...\n",
      " $ stroke        : chr [1:3189916] \"No\" \"No\" \"No\" \"No\" ...\n",
      " $ disab         : chr [1:3189916] \"Yes\" \"No\" \"Yes\" \"No\" ...\n",
      " $ strata        : num [1:3189916] 11081 11081 11081 11081 11082 ...\n",
      " $ weight        : num [1:3189916] 238 738 569 607 630 ...\n",
      " $ psu           : num [1:3189916] 2.01e+09 2.01e+09 2.01e+09 2.01e+09 2.01e+09 ...\n",
      " $ bad_phys      : num [1:3189916] 1 NA 0 0 0 NA 0 0 NA NA ...\n",
      " $ activity_limit: num [1:3189916] 1 NA NA NA NA NA NA 0 NA NA ...\n",
      " $ srh           : num [1:3189916] 1 0 0 0 0 0 1 0 0 0 ...\n"
     ]
    }
   ],
   "source": [
    "#structure check \n",
    "str(brfss_merged)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1196b99b-598c-4497-ad0e-0ab554138062",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 6 × 30</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>year</th><th scope=col>fmd</th><th scope=col>binge</th><th scope=col>race</th><th scope=col>sex</th><th scope=col>age</th><th scope=col>inc</th><th scope=col>edu</th><th scope=col>emp</th><th scope=col>marital</th><th scope=col>⋯</th><th scope=col>diab</th><th scope=col>kidney</th><th scope=col>stroke</th><th scope=col>disab</th><th scope=col>strata</th><th scope=col>weight</th><th scope=col>psu</th><th scope=col>bad_phys</th><th scope=col>activity_limit</th><th scope=col>srh</th></tr>\n",
       "\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>⋯</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>2013</td><td> 1</td><td>0</td><td>Non-Hispanic Black</td><td>0</td><td>60-64</td><td>$50k-$75k</td><td>College Graduate</td><td>Not in Labor Force</td><td>Divorced</td><td>⋯</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>11081</td><td>238.0161</td><td>2013000580</td><td> 1</td><td> 1</td><td>1</td></tr>\n",
       "\t<tr><td>2013</td><td>NA</td><td>0</td><td>Non-Hispanic White</td><td>0</td><td>50-59</td><td>$75k+    </td><td>Attended College</td><td>Employed          </td><td>Married </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>11081</td><td>737.6942</td><td>2013000593</td><td>NA</td><td>NA</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td> 0</td><td>1</td><td>Non-Hispanic White</td><td>0</td><td>50-59</td><td>$75k+    </td><td>College Graduate</td><td>Employed          </td><td>Married </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>Yes</td><td>11081</td><td>568.5274</td><td>2013000600</td><td> 0</td><td>NA</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td>NA</td><td>0</td><td>Non-Hispanic White</td><td>0</td><td>60-64</td><td>$50k-$75k</td><td>HS Graduate     </td><td>Not in Labor Force</td><td>Married </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>11081</td><td>606.9764</td><td>2013000606</td><td> 0</td><td>NA</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td> 0</td><td>0</td><td>Non-Hispanic White</td><td>1</td><td>65+  </td><td>$35k-$50k</td><td>College Graduate</td><td>Not in Labor Force</td><td>Married </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>11082</td><td>629.8471</td><td>2013000608</td><td> 0</td><td>NA</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td>NA</td><td>0</td><td>Non-Hispanic Black</td><td>0</td><td>40-49</td><td>$75k+    </td><td>College Graduate</td><td>Employed          </td><td>Divorced</td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>11081</td><td>272.2382</td><td>2013000630</td><td>NA</td><td>NA</td><td>0</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 6 × 30\n",
       "\\begin{tabular}{lllllllllllllllllllll}\n",
       " year & fmd & binge & race & sex & age & inc & edu & emp & marital & ⋯ & diab & kidney & stroke & disab & strata & weight & psu & bad\\_phys & activity\\_limit & srh\\\\\n",
       " <int> & <dbl> & <dbl> & <chr> & <dbl> & <chr> & <chr> & <chr> & <chr> & <chr> & ⋯ & <chr> & <chr> & <chr> & <chr> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t 2013 &  1 & 0 & Non-Hispanic Black & 0 & 60-64 & \\$50k-\\$75k & College Graduate & Not in Labor Force & Divorced & ⋯ & No & Yes & No & Yes & 11081 & 238.0161 & 2013000580 &  1 &  1 & 1\\\\\n",
       "\t 2013 & NA & 0 & Non-Hispanic White & 0 & 50-59 & \\$75k+     & Attended College & Employed           & Married  & ⋯ & No & No  & No & No  & 11081 & 737.6942 & 2013000593 & NA & NA & 0\\\\\n",
       "\t 2013 &  0 & 1 & Non-Hispanic White & 0 & 50-59 & \\$75k+     & College Graduate & Employed           & Married  & ⋯ & No & No  & No & Yes & 11081 & 568.5274 & 2013000600 &  0 & NA & 0\\\\\n",
       "\t 2013 & NA & 0 & Non-Hispanic White & 0 & 60-64 & \\$50k-\\$75k & HS Graduate      & Not in Labor Force & Married  & ⋯ & No & No  & No & No  & 11081 & 606.9764 & 2013000606 &  0 & NA & 0\\\\\n",
       "\t 2013 &  0 & 0 & Non-Hispanic White & 1 & 65+   & \\$35k-\\$50k & College Graduate & Not in Labor Force & Married  & ⋯ & No & No  & No & No  & 11082 & 629.8471 & 2013000608 &  0 & NA & 0\\\\\n",
       "\t 2013 & NA & 0 & Non-Hispanic Black & 0 & 40-49 & \\$75k+     & College Graduate & Employed           & Divorced & ⋯ & No & No  & No & No  & 11081 & 272.2382 & 2013000630 & NA & NA & 0\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 6 × 30\n",
       "\n",
       "| year &lt;int&gt; | fmd &lt;dbl&gt; | binge &lt;dbl&gt; | race &lt;chr&gt; | sex &lt;dbl&gt; | age &lt;chr&gt; | inc &lt;chr&gt; | edu &lt;chr&gt; | emp &lt;chr&gt; | marital &lt;chr&gt; | ⋯ ⋯ | diab &lt;chr&gt; | kidney &lt;chr&gt; | stroke &lt;chr&gt; | disab &lt;chr&gt; | strata &lt;dbl&gt; | weight &lt;dbl&gt; | psu &lt;dbl&gt; | bad_phys &lt;dbl&gt; | activity_limit &lt;dbl&gt; | srh &lt;dbl&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| 2013 |  1 | 0 | Non-Hispanic Black | 0 | 60-64 | $50k-$75k | College Graduate | Not in Labor Force | Divorced | ⋯ | No | Yes | No | Yes | 11081 | 238.0161 | 2013000580 |  1 |  1 | 1 |\n",
       "| 2013 | NA | 0 | Non-Hispanic White | 0 | 50-59 | $75k+     | Attended College | Employed           | Married  | ⋯ | No | No  | No | No  | 11081 | 737.6942 | 2013000593 | NA | NA | 0 |\n",
       "| 2013 |  0 | 1 | Non-Hispanic White | 0 | 50-59 | $75k+     | College Graduate | Employed           | Married  | ⋯ | No | No  | No | Yes | 11081 | 568.5274 | 2013000600 |  0 | NA | 0 |\n",
       "| 2013 | NA | 0 | Non-Hispanic White | 0 | 60-64 | $50k-$75k | HS Graduate      | Not in Labor Force | Married  | ⋯ | No | No  | No | No  | 11081 | 606.9764 | 2013000606 |  0 | NA | 0 |\n",
       "| 2013 |  0 | 0 | Non-Hispanic White | 1 | 65+   | $35k-$50k | College Graduate | Not in Labor Force | Married  | ⋯ | No | No  | No | No  | 11082 | 629.8471 | 2013000608 |  0 | NA | 0 |\n",
       "| 2013 | NA | 0 | Non-Hispanic Black | 0 | 40-49 | $75k+     | College Graduate | Employed           | Divorced | ⋯ | No | No  | No | No  | 11081 | 272.2382 | 2013000630 | NA | NA | 0 |\n",
       "\n"
      ],
      "text/plain": [
       "  year fmd binge race               sex age   inc       edu             \n",
       "1 2013  1  0     Non-Hispanic Black 0   60-64 $50k-$75k College Graduate\n",
       "2 2013 NA  0     Non-Hispanic White 0   50-59 $75k+     Attended College\n",
       "3 2013  0  1     Non-Hispanic White 0   50-59 $75k+     College Graduate\n",
       "4 2013 NA  0     Non-Hispanic White 0   60-64 $50k-$75k HS Graduate     \n",
       "5 2013  0  0     Non-Hispanic White 1   65+   $35k-$50k College Graduate\n",
       "6 2013 NA  0     Non-Hispanic Black 0   40-49 $75k+     College Graduate\n",
       "  emp                marital  ⋯ diab kidney stroke disab strata weight  \n",
       "1 Not in Labor Force Divorced ⋯ No   Yes    No     Yes   11081  238.0161\n",
       "2 Employed           Married  ⋯ No   No     No     No    11081  737.6942\n",
       "3 Employed           Married  ⋯ No   No     No     Yes   11081  568.5274\n",
       "4 Not in Labor Force Married  ⋯ No   No     No     No    11081  606.9764\n",
       "5 Not in Labor Force Married  ⋯ No   No     No     No    11082  629.8471\n",
       "6 Employed           Divorced ⋯ No   No     No     No    11081  272.2382\n",
       "  psu        bad_phys activity_limit srh\n",
       "1 2013000580  1        1             1  \n",
       "2 2013000593 NA       NA             0  \n",
       "3 2013000600  0       NA             0  \n",
       "4 2013000606  0       NA             0  \n",
       "5 2013000608  0       NA             0  \n",
       "6 2013000630 NA       NA             0  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# View first few rows\n",
    "head(brfss_merged)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "084b7230-86a1-47d6-a75c-a76d70503439",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>\n",
       ".list-inline {list-style: none; margin:0; padding: 0}\n",
       ".list-inline>li {display: inline-block}\n",
       ".list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n",
       "</style>\n",
       "<ol class=list-inline><li>3189916</li><li>30</li></ol>\n"
      ],
      "text/latex": [
       "\\begin{enumerate*}\n",
       "\\item 3189916\n",
       "\\item 30\n",
       "\\end{enumerate*}\n"
      ],
      "text/markdown": [
       "1. 3189916\n",
       "2. 30\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "[1] 3189916      30"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "dim(all_data)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9fb37aad-13ae-483a-b972-29c33c507716",
   "metadata": {},
   "source": [
    "# Step 2"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2c3eeba7-6c35-4aad-9bdd-806cc40547e2",
   "metadata": {},
   "source": [
    "\n",
    "# STEP 3: Convert Variables to Factors and Sample the Dataset\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fe1f2f7b-29f0-4995-b389-36f4c1b1c808",
   "metadata": {},
   "source": [
    "\n",
    "# 3A. Convert Selected Variables to Factor\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d5b286f9-5b47-41f1-ae38-0db90dc55024",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define list of variables to be converted to factors\n",
    "factor_vars <- c(\n",
    "  \"year\", \"fmd\", \"binge\", \"race\", \"sex\",\n",
    "  \"age\", \"inc\", \"edu\", \"emp\", \"marital\",\n",
    "  \"ins\", \"home\", \"smoke\", \"heavy\", \"active\",\n",
    "  \"bmi\", \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"strata\", \"psu\",\n",
    "  \"bad_phys\", \"activity_limit\", \"srh\"\n",
    ")\n",
    "\n",
    "# Apply factor conversion across all selected columns\n",
    "brfss_merged <- brfss_merged %>%\n",
    "  mutate(across(all_of(factor_vars), as.factor))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6770faea-53c6-412e-8f27-a84068a87d81",
   "metadata": {},
   "source": [
    "\n",
    "# 3B. Take a Stratified Random Sample\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "881687e0-a033-4bee-ba96-899d06439f36",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Sample 5,000 observations per year (2013–2019)\n",
    "set.seed(123)  # For reproducibility\n",
    "brfss_merged <- brfss_merged %>%\n",
    "  group_by(year) %>%\n",
    "  sample_n(size = 5000, replace = FALSE) %>%\n",
    "  ungroup()\n",
    "\n",
    "# At this stage, `brfss_merged` is the sampled version of the full dataset\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "6392d834-2589-4a3a-b2b4-347808e0e9f7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "2013 2014 2015 2016 2017 2018 2019 \n",
       "5000 5000 5000 5000 5000 5000 5000 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Check counts per year \n",
    "table(brfss_merged$year)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d2d0e5ac-8703-4af3-ba39-139db44cfbe9",
   "metadata": {},
   "source": [
    "# Filtering out the null rows"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de01ea1d-4266-4b70-922e-97926a6b4b59",
   "metadata": {},
   "source": [
    "\n",
    "# STEP 4: Filter Incomplete Cases (Complete-Case Analysis)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "2124831d-21ad-45b6-a8a0-0cc85bc34b77",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "   year     fmd      binge                    race      sex         age     \n",
       " 2013:391   0:1405   0:2344   Hispanic          : 212   0:1791   18-24:152  \n",
       " 2014:368   1:1357   1: 418   Non-Hispanic Black: 231   1: 971   25-29:142  \n",
       " 2015:353                     Non-Hispanic Other: 220            30-39:370  \n",
       " 2016:410                     Non-Hispanic White:2099            40-49:408  \n",
       " 2017:379                                                        50-59:729  \n",
       " 2018:417                                                        60-64:320  \n",
       " 2019:444                                                        65+  :641  \n",
       "        inc                    edu                      emp      \n",
       " $15k-$25k:669   Attended College:897   Employed          :1011  \n",
       " $25k-$35k:316   College Graduate:804   Not in Labor Force:1662  \n",
       " $35k-$50k:346   HS Graduate     :792   Unemployed        :  89  \n",
       " $50k-$75k:349   Less than HS    :269                            \n",
       " $75k+    :503                                                   \n",
       " <$15k    :579                                                   \n",
       "                                                                 \n",
       "          marital     ins         home             smoke      heavy     \n",
       " Cohabiting   : 128   0: 277   Other: 161   Non-Smoker:1309   No :2581  \n",
       " Divorced     : 989   1:2485   Own  :1595   Smoker    :1453   Yes: 181  \n",
       " Married      :1111            Rent :1006                               \n",
       " Never Married: 534                                                     \n",
       "                                                                        \n",
       "                                                                        \n",
       "                                                                        \n",
       " active                bmi       asthma      arth       copd       chd      \n",
       " No :1048   Normal Weight: 784   No :2038   No :1218   No :2190   No :2463  \n",
       " Yes:1714   Obese        :1139   Yes: 724   Yes:1544   Yes: 572   Yes: 299  \n",
       "            Overweight   : 839                                              \n",
       "                                                                            \n",
       "                                                                            \n",
       "                                                                            \n",
       "                                                                            \n",
       "  diab      kidney     stroke     disab          strata         weight         \n",
       " No :2224   No :2567   No :2535   No : 989   412019 :  29   Min.   :    2.957  \n",
       " Yes: 538   Yes: 195   Yes: 227   Yes:1773   62029  :  25   1st Qu.:  100.830  \n",
       "                                             272049 :  25   Median :  257.940  \n",
       "                                             272059 :  23   Mean   :  561.499  \n",
       "                                             541011 :  23   3rd Qu.:  639.211  \n",
       "                                             241011 :  20   Max.   :13349.339  \n",
       "                                             (Other):2617                      \n",
       "         psu       bad_phys activity_limit srh     \n",
       " 2013000220:   2   0:1405   0:1504         0:1340  \n",
       " 2013003193:   2   1:1357   1:1258         1:1422  \n",
       " 2013004603:   2                                   \n",
       " 2013004758:   2                                   \n",
       " 2013004950:   2                                   \n",
       " 2014000911:   2                                   \n",
       " (Other)   :2750                                   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A tibble: 6 × 30</caption>\n",
       "<thead>\n",
       "\t<tr><th scope=col>year</th><th scope=col>fmd</th><th scope=col>binge</th><th scope=col>race</th><th scope=col>sex</th><th scope=col>age</th><th scope=col>inc</th><th scope=col>edu</th><th scope=col>emp</th><th scope=col>marital</th><th scope=col>⋯</th><th scope=col>diab</th><th scope=col>kidney</th><th scope=col>stroke</th><th scope=col>disab</th><th scope=col>strata</th><th scope=col>weight</th><th scope=col>psu</th><th scope=col>bad_phys</th><th scope=col>activity_limit</th><th scope=col>srh</th></tr>\n",
       "\t<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>⋯</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><td>2013</td><td>1</td><td>1</td><td>Non-Hispanic White</td><td>1</td><td>30-39</td><td>$75k+    </td><td>HS Graduate     </td><td>Employed          </td><td>Married      </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>231051</td><td>  75.10972</td><td>2013000710</td><td>0</td><td>0</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td>1</td><td>1</td><td>Non-Hispanic White</td><td>1</td><td>18-24</td><td>$35k-$50k</td><td>HS Graduate     </td><td>Unemployed        </td><td>Never Married</td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>532019</td><td>1078.97680</td><td>2013000280</td><td>1</td><td>0</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td>1</td><td>0</td><td>Non-Hispanic White</td><td>0</td><td>50-59</td><td>$50k-$75k</td><td>College Graduate</td><td>Employed          </td><td>Divorced     </td><td>⋯</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>261061</td><td> 162.90356</td><td>2013003802</td><td>0</td><td>0</td><td>0</td></tr>\n",
       "\t<tr><td>2013</td><td>1</td><td>0</td><td>Non-Hispanic White</td><td>0</td><td>50-59</td><td><span style=white-space:pre-wrap>&lt;$15k    </span></td><td><span style=white-space:pre-wrap>Less than HS    </span></td><td>Not in Labor Force</td><td><span style=white-space:pre-wrap>Divorced     </span></td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>Yes</td><td>451032</td><td> 428.35406</td><td>2013000603</td><td>1</td><td>1</td><td>1</td></tr>\n",
       "\t<tr><td>2013</td><td>1</td><td>0</td><td>Non-Hispanic White</td><td>0</td><td>25-29</td><td>$15k-$25k</td><td>Attended College</td><td>Employed          </td><td>Never Married</td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>412019</td><td> 681.92897</td><td>2013004448</td><td>1</td><td>0</td><td>1</td></tr>\n",
       "\t<tr><td>2013</td><td>1</td><td>0</td><td>Non-Hispanic White</td><td>1</td><td>50-59</td><td>$50k-$75k</td><td>College Graduate</td><td>Not in Labor Force</td><td>Divorced     </td><td>⋯</td><td>No</td><td>No </td><td>No</td><td>No </td><td>561011</td><td>  18.11160</td><td>2013004302</td><td>1</td><td>1</td><td>1</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A tibble: 6 × 30\n",
       "\\begin{tabular}{lllllllllllllllllllll}\n",
       " year & fmd & binge & race & sex & age & inc & edu & emp & marital & ⋯ & diab & kidney & stroke & disab & strata & weight & psu & bad\\_phys & activity\\_limit & srh\\\\\n",
       " <fct> & <fct> & <fct> & <fct> & <fct> & <fct> & <fct> & <fct> & <fct> & <fct> & ⋯ & <fct> & <fct> & <fct> & <fct> & <fct> & <dbl> & <fct> & <fct> & <fct> & <fct>\\\\\n",
       "\\hline\n",
       "\t 2013 & 1 & 1 & Non-Hispanic White & 1 & 30-39 & \\$75k+     & HS Graduate      & Employed           & Married       & ⋯ & No & No  & No & No  & 231051 &   75.10972 & 2013000710 & 0 & 0 & 0\\\\\n",
       "\t 2013 & 1 & 1 & Non-Hispanic White & 1 & 18-24 & \\$35k-\\$50k & HS Graduate      & Unemployed         & Never Married & ⋯ & No & No  & No & No  & 532019 & 1078.97680 & 2013000280 & 1 & 0 & 0\\\\\n",
       "\t 2013 & 1 & 0 & Non-Hispanic White & 0 & 50-59 & \\$50k-\\$75k & College Graduate & Employed           & Divorced      & ⋯ & No & Yes & No & Yes & 261061 &  162.90356 & 2013003802 & 0 & 0 & 0\\\\\n",
       "\t 2013 & 1 & 0 & Non-Hispanic White & 0 & 50-59 & <\\$15k     & Less than HS     & Not in Labor Force & Divorced      & ⋯ & No & No  & No & Yes & 451032 &  428.35406 & 2013000603 & 1 & 1 & 1\\\\\n",
       "\t 2013 & 1 & 0 & Non-Hispanic White & 0 & 25-29 & \\$15k-\\$25k & Attended College & Employed           & Never Married & ⋯ & No & No  & No & No  & 412019 &  681.92897 & 2013004448 & 1 & 0 & 1\\\\\n",
       "\t 2013 & 1 & 0 & Non-Hispanic White & 1 & 50-59 & \\$50k-\\$75k & College Graduate & Not in Labor Force & Divorced      & ⋯ & No & No  & No & No  & 561011 &   18.11160 & 2013004302 & 1 & 1 & 1\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A tibble: 6 × 30\n",
       "\n",
       "| year &lt;fct&gt; | fmd &lt;fct&gt; | binge &lt;fct&gt; | race &lt;fct&gt; | sex &lt;fct&gt; | age &lt;fct&gt; | inc &lt;fct&gt; | edu &lt;fct&gt; | emp &lt;fct&gt; | marital &lt;fct&gt; | ⋯ ⋯ | diab &lt;fct&gt; | kidney &lt;fct&gt; | stroke &lt;fct&gt; | disab &lt;fct&gt; | strata &lt;fct&gt; | weight &lt;dbl&gt; | psu &lt;fct&gt; | bad_phys &lt;fct&gt; | activity_limit &lt;fct&gt; | srh &lt;fct&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n",
       "| 2013 | 1 | 1 | Non-Hispanic White | 1 | 30-39 | $75k+     | HS Graduate      | Employed           | Married       | ⋯ | No | No  | No | No  | 231051 |   75.10972 | 2013000710 | 0 | 0 | 0 |\n",
       "| 2013 | 1 | 1 | Non-Hispanic White | 1 | 18-24 | $35k-$50k | HS Graduate      | Unemployed         | Never Married | ⋯ | No | No  | No | No  | 532019 | 1078.97680 | 2013000280 | 1 | 0 | 0 |\n",
       "| 2013 | 1 | 0 | Non-Hispanic White | 0 | 50-59 | $50k-$75k | College Graduate | Employed           | Divorced      | ⋯ | No | Yes | No | Yes | 261061 |  162.90356 | 2013003802 | 0 | 0 | 0 |\n",
       "| 2013 | 1 | 0 | Non-Hispanic White | 0 | 50-59 | &lt;$15k     | Less than HS     | Not in Labor Force | Divorced      | ⋯ | No | No  | No | Yes | 451032 |  428.35406 | 2013000603 | 1 | 1 | 1 |\n",
       "| 2013 | 1 | 0 | Non-Hispanic White | 0 | 25-29 | $15k-$25k | Attended College | Employed           | Never Married | ⋯ | No | No  | No | No  | 412019 |  681.92897 | 2013004448 | 1 | 0 | 1 |\n",
       "| 2013 | 1 | 0 | Non-Hispanic White | 1 | 50-59 | $50k-$75k | College Graduate | Not in Labor Force | Divorced      | ⋯ | No | No  | No | No  | 561011 |   18.11160 | 2013004302 | 1 | 1 | 1 |\n",
       "\n"
      ],
      "text/plain": [
       "  year fmd binge race               sex age   inc       edu             \n",
       "1 2013 1   1     Non-Hispanic White 1   30-39 $75k+     HS Graduate     \n",
       "2 2013 1   1     Non-Hispanic White 1   18-24 $35k-$50k HS Graduate     \n",
       "3 2013 1   0     Non-Hispanic White 0   50-59 $50k-$75k College Graduate\n",
       "4 2013 1   0     Non-Hispanic White 0   50-59 <$15k     Less than HS    \n",
       "5 2013 1   0     Non-Hispanic White 0   25-29 $15k-$25k Attended College\n",
       "6 2013 1   0     Non-Hispanic White 1   50-59 $50k-$75k College Graduate\n",
       "  emp                marital       ⋯ diab kidney stroke disab strata weight    \n",
       "1 Employed           Married       ⋯ No   No     No     No    231051   75.10972\n",
       "2 Unemployed         Never Married ⋯ No   No     No     No    532019 1078.97680\n",
       "3 Employed           Divorced      ⋯ No   Yes    No     Yes   261061  162.90356\n",
       "4 Not in Labor Force Divorced      ⋯ No   No     No     Yes   451032  428.35406\n",
       "5 Employed           Never Married ⋯ No   No     No     No    412019  681.92897\n",
       "6 Not in Labor Force Divorced      ⋯ No   No     No     No    561011   18.11160\n",
       "  psu        bad_phys activity_limit srh\n",
       "1 2013000710 0        0              0  \n",
       "2 2013000280 1        0              0  \n",
       "3 2013003802 0        0              0  \n",
       "4 2013000603 1        1              1  \n",
       "5 2013004448 1        0              1  \n",
       "6 2013004302 1        1              1  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Removed rows with any missing (NA) values\n",
    "brfss_merged2 <- brfss_merged %>%\n",
    "  filter(complete.cases(.))\n",
    "\n",
    "# Display a summary of the cleaned dataset\n",
    "summary(brfss_merged2)\n",
    "\n",
    "head(brfss_merged2)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "6c804100-4f77-4805-aea9-974f39fe7fc9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "32238"
      ],
      "text/latex": [
       "32238"
      ],
      "text/markdown": [
       "32238"
      ],
      "text/plain": [
       "[1] 32238"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Check how many rows were dropped due to missing data\n",
    "nrow(brfss_merged) - nrow(brfss_merged2)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68b21849-001c-4eeb-b9dd-64c0db0a22b7",
   "metadata": {},
   "source": [
    "# Derive MCC variable from the cleaned dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "01eb6e0f-4261-4155-8b2e-57f7f657bb8d",
   "metadata": {},
   "source": [
    "\n",
    "# STEP 5: Derive MCC (Multiple Chronic Conditions) Variable\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "23489a8a-c441-4f9e-9ec3-7f2ac6b2b64a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "   year     fmd      binge                    race      sex         age     \n",
       " 2013:391   0:1405   0:2344   Hispanic          : 212   0:1791   18-24:152  \n",
       " 2014:368   1:1357   1: 418   Non-Hispanic Black: 231   1: 971   25-29:142  \n",
       " 2015:353                     Non-Hispanic Other: 220            30-39:370  \n",
       " 2016:410                     Non-Hispanic White:2099            40-49:408  \n",
       " 2017:379                                                        50-59:729  \n",
       " 2018:417                                                        60-64:320  \n",
       " 2019:444                                                        65+  :641  \n",
       "        inc                    edu                      emp      \n",
       " $15k-$25k:669   Attended College:897   Employed          :1011  \n",
       " $25k-$35k:316   College Graduate:804   Not in Labor Force:1662  \n",
       " $35k-$50k:346   HS Graduate     :792   Unemployed        :  89  \n",
       " $50k-$75k:349   Less than HS    :269                            \n",
       " $75k+    :503                                                   \n",
       " <$15k    :579                                                   \n",
       "                                                                 \n",
       "          marital     ins         home             smoke      heavy     \n",
       " Cohabiting   : 128   0: 277   Other: 161   Non-Smoker:1309   No :2581  \n",
       " Divorced     : 989   1:2485   Own  :1595   Smoker    :1453   Yes: 181  \n",
       " Married      :1111            Rent :1006                               \n",
       " Never Married: 534                                                     \n",
       "                                                                        \n",
       "                                                                        \n",
       "                                                                        \n",
       " active                bmi       asthma      arth       copd       chd      \n",
       " No :1048   Normal Weight: 784   No :2038   No :1218   No :2190   No :2463  \n",
       " Yes:1714   Obese        :1139   Yes: 724   Yes:1544   Yes: 572   Yes: 299  \n",
       "            Overweight   : 839                                              \n",
       "                                                                            \n",
       "                                                                            \n",
       "                                                                            \n",
       "                                                                            \n",
       "  diab      kidney     stroke     disab          strata         weight         \n",
       " No :2224   No :2567   No :2535   No : 989   412019 :  29   Min.   :    2.957  \n",
       " Yes: 538   Yes: 195   Yes: 227   Yes:1773   62029  :  25   1st Qu.:  100.830  \n",
       "                                             272049 :  25   Median :  257.940  \n",
       "                                             272059 :  23   Mean   :  561.499  \n",
       "                                             541011 :  23   3rd Qu.:  639.211  \n",
       "                                             241011 :  20   Max.   :13349.339  \n",
       "                                             (Other):2617                      \n",
       "         psu       bad_phys activity_limit srh       MCC      \n",
       " 2013000220:   2   0:1405   0:1504         0:1340   No :1598  \n",
       " 2013003193:   2   1:1357   1:1258         1:1422   Yes:1164  \n",
       " 2013004603:   2                                              \n",
       " 2013004758:   2                                              \n",
       " 2013004950:   2                                              \n",
       " 2014000911:   2                                              \n",
       " (Other)   :2750                                              "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Reference: Price et al.\n",
    "\n",
    "# Define chronic condition variables (already recoded as Yes/No)\n",
    "chronic_conditions <- c(\"asthma\", \"arth\", \"copd\", \"chd\", \"diab\", \"kidney\", \"stroke\")\n",
    "\n",
    "# Create MCC variable:\n",
    "# 'Yes' if respondent has 2 or more of the listed chronic conditions\n",
    "# 'No' otherwise\n",
    "\n",
    "brfss_merged2$MCC <- apply(brfss_merged2[, chronic_conditions], 1, function(row) {\n",
    "  yes_count <- sum(row == \"Yes\", na.rm = TRUE)\n",
    "  \n",
    "  if (yes_count >= 2) {\n",
    "    return(\"Yes\")\n",
    "  } else {\n",
    "    return(\"No\")\n",
    "  }\n",
    "})\n",
    "\n",
    "# Convert MCC to factor\n",
    "brfss_merged2$MCC <- factor(brfss_merged2$MCC)\n",
    "\n",
    "# Summary of the updated dataset\n",
    "summary(brfss_merged2)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "e2f206ac-7d8b-4562-9453-2ec5cc9b4d36",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'ggplot2' was built under R version 4.5.1\"\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAOVBMVEUAAAAAv8RNTU1oaGh8\nfHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3////ccKm3AAAACXBI\nWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO3di3biaLYDYB8TyI3QGd7/YY+5xhhQLJfZElX6\n1ppOkQtQ+qWEkHRPs42IP9ao70DE3yBDiphBhhQxgwwpYgYZUsQMMqSIGWRIETPIkCJmkCFF\nzCBDipjBnENqjl7e2Y+b49a/V02zOF1ol++b4x8378v2+va+Vzdv+f5d+Vh2f7Pl5y/vNTTu\n+sZcy/6a7tzr33wut/ciGd6N/uWR9y52HjGkbkrkx81x68v+7XZ/fj3+8bUZXv+5l+OH9NX2\n/2Z/PqTL6xtzLftrunOvf7FpN9vbkQzvxuXlw8fFKPMO6fBy3TbU16R5htQ0X/0Li9Pn3HZx\nf0hj78pX91l63b1cvzTL++813uD6fnO+vWk3vHw9fOxVJMO7Mbz8OubOxd4jhrRdc1+S5hrS\nxYW3Zn28L29/PqTF+TPDS/M5wx0eXN9v/mxIn4fPMDciGd6N4eWvMXcu9h4ypGNVvxf7T2zd\n57fmpTuR7/O3MIvmu/t0131afFn/fNzp3faXX9tmcTjEz+7Vq+/t5XucfK3apl19bU8PK3t3\nZXN8IPPafPUeFZ1GdHzv01ve25+bvnFDnz9fN752V3v8iPW297f8uSv9+3+81d5f4tb13fvo\n/Qe2b+fl9+/13Y/56r5XbFfrn3v/srgTyfBuXN+tBfcY/V/2yCEt94/KPw4d7/60On9G7L5n\nPj4aP7ft5926yy/nt73u/7R/TNJ7j6PP5nwlV0PaHh/ItO321yG99W761g0tB5+Zu1Xs32P9\n87fs3ZX+/T/cau8vcfP67n308QNXN4d052PWvVfvbZq3O5EM78bV3dq+NfkuaaSHDOlz99Cu\nO9zd5+Cv/Wfur91jha/jZ7xl18C3/fG+7R8D7j6u927d5Xa9/V7u3vbVtJ/b75ddVfvvcdB9\nXn373n53bdv0b/14V173s113H3pjSP1v27ub++juc7t7BDS8Kwdt873dXlz77l4tL/6WvbvS\nu//7G+j9JW5f372P7l5/uGc3nmy49zGL3Yd0nwvOT2C+NeenGgeRDO/G8PLuIN9unHPc8Igh\ndSe/n8P+68/r4XS+dyPaP6Q7PMQ7/PGnHv13O3w6/d69erV/1L7/iP57HLweq7n6+WLSuyvr\n/Wt33fl1SIdPu+3r9V25/Iv9XD7fwfPfsndXLt68vfhL3L6+ex/9evie5bu9MSR4i33L45Mw\ndyPphzbwNeq5kNjOPaSTXrEX51fuPsHt3vC2/5zZndLn28v5QPvv1uv84ueTZP89Tq85LGCz\nr+hwSLtHMLvPsttfh3T8RmC5uL4rP9e2HVz7tn89l3dl+ObF8DP98PruffTpA5c3hnTvY5bd\nN0gf/QdkbfNLJHfv1u5V7dWr4qYHDKld9r5v761rezrI/eG8t+fXnh/+Xw/p4tueu/2+rsXh\n8/n68O3Yb0M6fqVYNNd35fSW4UO74R28uCvDN18V9M713f7o7e45tOsh3fuYzT7XxfvVlV9H\nMrwbV4O/ua246REP7S4uXbxy98Xo8GXpvfvm4vVj0xvSzY+8GNLd27s9pN0D/Nfzd/y/D+ml\nub4rB6v+d+GbPx/Sneu7O6TBNcEhdX/v/TMh529u+ldyGcnwbgwv37rrccfDh9T2f066+z7h\nZf+YZNH8PPO9f9DRe7deLXrf/15c0d4vD+12C2nPnQNDOn4fcHpod31DveeFN+3L1XUN78rw\nzVffxA+vD350/3ufEQ/t9r5WP4/J+g/tLiMZ3o3h5d375aHdSA8f0qrZ/37Y1+E7ke7S4bSO\nnzzP9ei/W68Wq+N30e3winZeD6+582TD/oPPzwp2//g+3eBwSMcnF05PNlzfUFe+w7d1uwdO\nn7e6fnFXhm/u/SVuX9+9jz4+T/B+a0j3PubqLHpPNgwiGd6Nq8t5smG8hw/pa//Uw9f5ZI4/\n4dj/EP3wxO7+Pfvv1qvFZ9N+nZ/+7l/RTvfA8PXwDPDX8NaPn3H3Tx8fLrw0y+/eM8m9p8z3\nT2bv3vR9fVeO1offnfnuvrHr/YpQb0gXd2X45t5f4vb13fvo9/0T8x9Nb0jne33vYw5Pf7/+\nLOD95+nvQSTDu3F1uXt38veP/10PH9LpB4fHFi2O35G8n76hX/eO+PL5vuMn3p2X6yvqvabp\nP7nRu/HuIdH+i83+wuEHla+nTi767Vz2frJ584bOt9T/cnrxbczlj0cHb+79JW5e372P3h5+\nzPp2vqbevb73MccfyP78vunp9xmuI7m6G1eXX/MD2bEeP6TtZvfbK6fPbOfPce+7329Zfx5+\n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\nbfZetsMLO1/HV7Tfu48cXFHhvQ5OzubhmmZx/EWbxX4KbbPqvkJ9ts378MLOoll1E9q87MaX\nIT2PnM3DNc1b89W9XHcvu7g/muX+1Z9NO7hwfO/9i+/uZXP4CrZedl+f9rPaXTy8ff/Pt7ZZ\nvG/DQob0cE3TTah7+da97OJeNuvD63fjuriwt2w+fz5w9/6fh4d6r1dDet2/PkvykCE9XFf6\ndrHdPWjb/izh520D3TdNi9ePzc9bF81Ht7PzR/4MqWk23Ve5PAHhIUN6uK70q67zm2Y1Zkjb\n77fuW6lmsf556+bz7eXGkLpvrz6vPjpEMqSH60r/2X1Vee/+N2ZIna/X1cvu69DhrS+Hx3ZX\nQ/psu71tHn//Y4wM6eG60n83L90evrcX3yNt14MLlx/VHkezahbvn5sbQ+oGt2ja4ceFRob0\ncLvSdyva/aio/6zdul0NLhzf+/v8UT/L+b68uDl9JXvPU+Imcg4Pt+v6e7PcPXN3+XOkr+GF\nndfmpfsi8/26W9hxOevt98/3SG33mO9wse3e8JUnG0xkSA+3K333JWQ3lcOXk8XpCe3hhb3j\nK9rN7t3b07PchyGdLr79PP39pvprxYUM6eGOX0ja0x+7L0Cr9ufX6y4u7Ox++a593T3Ae99/\n0KrpvkgdvqztLr623Xj2V9T9qc2OTGRIETPIkCJmkCFFzCBDiphBhhQxgwwpYgYZUsQMMqSI\nGWRIETPIkCJmkCFFzCBDiphBhhQxg/8HGXQkyliMrykAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot MCC frequency\n",
    "library(ggplot2)\n",
    "ggplot(brfss_merged2, aes(x = MCC, fill = MCC)) +\n",
    "  geom_bar() +\n",
    "  labs(title = \"Prevalence of Multiple Chronic Conditions (MCC)\",\n",
    "       x = \"MCC Status\", y = \"Count\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "484ae374-9d30-4235-a76f-dfc353b22e68",
   "metadata": {},
   "source": [
    "# STEP 6: Visualize Race Distribution with Pie Chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "ad56df8d-14e1-47ce-97a6-7dc4bf9cf339",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAPFBMVEUAAAAAv8RNTU1oaGh8\nfHx8rgCMjIyampqnp6eysrK9vb3HfP/Hx8fQ0NDZ2dnh4eHp6enw8PD4dm3///92hJcwAAAA\nCXBIWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO3ciXbiuBpFYRehE5KqTJf3f9eLB4xnZPtI\n+mXtb63uhAAOSN6RcVIUVwC7FbEfAHAEhAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQ\nEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIg\nQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBI\ngAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAA\nIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEB\nAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQI3EIqGi+X35X3rZ3evpuL/at/33q3nbhF\n74YzV/a/4dLjeHnvXWyfT9GqLn6+nbrPdXCx8nG+femj/vzr9vn5s73q/f4Q3l+K09SAudz3\n46Uo3n6ePl0kpOjuaKd1JT3ueKkvDq8eXpgNYeruszecfxznwcOqn08/pNf7hXoHH1ysnDtb\n+6o/bxq9ft4fQn2b06gGl/te6q9/PX2+SEfx2D1vPz8v6+5b3/Hn47GzTFy9+JWlL699HN/n\nftBf54nAP4pTmUz5mL/HFyuX4nzr4+tUPamX4t/1+u++iY/7svZR3ub3rXgdPBSX+34Wp1tD\nP+fTvmcNUzohXb+LdXPbuWMxsZaFDun6Uz/+4fPpbf5UNIvIR/E2vtjc5HHvr/pHxKVMoiz1\npdnYS/E7+chd7nuu16Kv6us4iG5I988utyk/Nwcen7djlbe6ksERf/eOl3KfqS9+v5Wvmr6a\nI6ryw+/L7Qf3/dDu/dRso7nz7UN7w2t9/9P9VdftK5dT8fLZ/4ajrz4ex/AYceKYcXDl6LkP\nbnqpF6rvKrPyELZ/s9mfPEv3vW9itJwhYRMr0qnzoqE+nK++/K/zcqi5b7tTfZc7RXXxq33J\n0fbx2u5Et0/abcyE9Nl5yXLrtv/ypdnI4Kvt4/gtXnoPa2pFGhy+Lh3Nlls7F50tl3l3N/Zz\nnl1Ulu7bhsSx3YF0XyOdqr3qvToiea9eL3+XLyF+q73tu1qkbkco4x24+bS6WL0uuEX38lgP\nzr/XtoHT7drPU9HfqzoLx+0g8f33+nvr7ae6+df197U5h9DZSP+rnddI3bXu/nz6If2U692/\n75mLXZ+PVXa06DWfds9QuN/3pV6pPnuPC4nrnbWr9s3u4f9bUZ7IrX6mXuov/3YOSKZCGnyt\n/P9Xe6Gof4J/lzv4dEiXZoV4q2/yWX3H4dHY4KuPJ/Devzg8i1dd+qnP0702DQwudrycrosh\nfZ9f6zMVExbvW52oKH+cENKBdEK6//bjto98vp+b9aU9ifDS3x+r+06E9Fr+hP/pXN09nrmf\nk3isV8OQXpoX/z+Dm1y7Gxl/88brd/fi/fkMH/hv9ezaFW1w8e61eiRLK9K1XKsnz2E/uW99\naHohpCO578e/p/Y45ePU7ndTe+t0SKfm4s+p3YenQnrccTqk3k7nHlL14ff2wL+u4+czucN+\nnXun7AcXy6Wxd5g4HVJ5vNsZmPt1T+97e6Av/6YfFxLV7q9f998Qftx+Ol/+/UwfqPXv237p\nqz3ZUP6pQHOUFTqker8ePZ/eI398/tu2/7j4cGl/X9vc775gDYahKMYhOd73m7N2R/LYX9+b\nPwR46byoOT0O7U7F6CX5Y8eoflfSefnw9thLJw/tZkPaeGg3dYP78+ntv+f+KcDBxbvf8+nr\n/sQ6p7CHNxtfXHPfj5W//oZpj136thN3/uatPqf01rywP5WfVtd+j8+W3c8zD3/yT4VUvWz5\nKrdRR/U5uOGl2eveBucjrt2NDL469zia59N7XP/qM+TVZ+fRxcbPqf3Tn+aXqu/D48TmJ8xn\n0f17wnX3feNvhI6kE9J3/WcyL+Xe3pxT+ixO3+3p7+r/p/Hp7/Lva9rXRPXp70t9qNd5yd00\nUP3RTPVS5ly8/jbfpnPD2xHlpT79Pf69y9OQmvPdg+fTXwjOxenfbT/+udQn/wYXK7+nzlFe\n82c+7Vfa5a48qf81WqZd7nsp7/v7MTq9gZR1Qrr9jCx/Pn/cD/jLH5iXx2nk5lelvV/I3j1+\nX9P8Qrb8sfxSDF/o3F46tTf/epy66t6w/wvZx127Gxl8tfM4zr1r3ga/oC39nO+3fZ+42Nyt\n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\nuScSOhzmc4E+poJ16KCY0ycki1NRUNDBMbVu2hToB1OY45WKFWI/VoTDZAMChAQIEBIgQEiA\nACEBAoQECBASIM6xoV4AAAG9SURBVEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEB\nAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKE\nBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQI\nEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBAS\nIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBA\nSIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiA\nACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAh\nAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEC\nhAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAj8H5F+wpptotzzAAAAAElFTkSuQmCC",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#count and percentage for each race\n",
    "race_dist <- brfss_merged2 %>%\n",
    "  count(race) %>%\n",
    "  mutate(perc = n / sum(n) * 100)\n",
    "\n",
    "# Plot pie chart\n",
    "ggplot(race_dist, aes(x = \"\", y = n, fill = race)) +\n",
    "  geom_bar(stat = \"identity\", width = 1, color = \"black\") +\n",
    "  coord_polar(theta = \"y\") +\n",
    "  labs(\n",
    "    title = \"Race Distribution in BRFSS 2013–2019\",\n",
    "    fill = \"Race\"\n",
    "  ) +\n",
    "  theme_void() +\n",
    "  theme(legend.position = \"right\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8402802-ec84-421e-821d-536c9e510620",
   "metadata": {},
   "source": [
    "# Bar Plot: Binge Drinking by Year"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "87824e76-1a97-40fd-88a1-8b6c32a97b05",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAOVBMVEUAAAAAv8RNTU1oaGh8\nfHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3////ccKm3AAAACXBI\nWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO2di3aqCLsE+VFjEmPG4/s/7BHwgrd4AZpqdtda\ns2MMFF+wOyCaTLENIXSmGHuAEKZAihRCD6RIIfRAihRCD6RIIfRAihRCD6RIIfRAihRCD6RI\nIfRAihRCD3QoUtEw+9x/9s7K5cf6/N7Lpe595b6ymH+9NMmrkz+13kexONxcFB/v+YMT3Yu0\nS27z2XsrF8uzey+XuveVP5XzF0d5afHn1iuL7+bGd1G+pw9WdCpS/WE9P+vCayv/fhXF58Ol\nXlJuf8ripWPSIEVa7fuzKYvVe/pgRfcibX/f+Zl7TOG6KDaPl3pJ+fPaIWmQIh3O6FrneGHK\n9FCk5sbhn2VZzJqfwat5UX7tl/qZ7064VrdW3i6rQ9KuTbNd5C4l9ee/5e5p2N/6C2V1a288\nbXpTzPZfnlXVXc52d/+c1jtNeLmV4qNp+uX3sFvuszxXn7ZRHYp+qk6X1yu3N70fMrjTQ5Ga\n9OyTPq+fpFSJ+WyeAdX3f189HTqlfl0lqSgW1ZcvJfXnZXWA+VN/qWyKVBtbm/4o6vDuwv1R\nSY+mywnbW1k2l0S2t76HeuvNPcv9+dt36zz1u9ots/1TpfbKZ5teFO+cGAccvTxHOsZxl7mf\n7WZRJX93yrbL0Kqs7l/XP4D3C56tfLi5C+/mhqT6fF6fqP2lv1SumlVrY2vT6/3P/sWuUJ91\n4j+P6vaEZ1spV9tN/STw+nvYLdeMsN6d3TZHonnxe9o/i2K53G+yvfL5puf3z2uDE31ctfts\nPqv/qWK2qW4vm2f8383tOi6b1lnMVZF+bkmqs6yi/H2gv1CuyqYOtbG96fqUrjmANjdPJ6Xt\nxVpb+ai3Uq9x/T0UzdFmXdVsUay3Z2d22/rk7nBidz3FYdM/r+71wKSPIi3W2/YTpebD7JCd\n+vaB1spnN1srtm8Xxdc+rn/pL+fZn6DVd7Y3vaq/8Lk/21qvPudHa3ux661cig7ba75Ytac5\n2n2fX4Hczf51c+WzTYdJ0P3UbvNVP62+7sC2dfvPIpV/FGnH7PZXrj0N5WK1bS/b2nRZHv7Z\nfpXHey8nvLGVS9HZpuuP9SHp7MyuPdzZyhebDpOgj6t269bVgONXzot0f+Xdc//FH0UqV0X7\nKdhN/ZVye77skepg1ByWdgeL+fL7t1Wkm2vetbfvqT9Wh6TzM7v2Ou2VLzcdJkEfRTpl7s65\nV1ms76+8rE617hbpd/f12Y2v3Dy1u7GBs01XSW+OGrOz52Tni7W2Up5O7a6/h+OpXb38vNh8\nX762fJyovfLlpsMk6OeIVF4nfX814Kt5zv7RLDe/s/L9ItVduXHm2NZfKtufnW9691lzsaD5\n6upobS/W2srH/rpDeet72D8D2r/8uyo+ZxdndqeJrvWrFGla9FCkn7I6W7pMenN9+rvY364u\nIJfXl79/90/I/yjSdnk897ujv5jn7LPzTa/3r9/sDgtfx4vnlxO2trIqyvXx8vfl91A0I5T7\nK2+z8vLMrv3T4rTy5abDJOhUpAOtF3r2X9keXjFtkr46XU27Wnm53f5dpPrE6E/9dttyXHx2\nvunZPuxfh7UPB7vWYu2tLI/f3/X3UBSf7XtW1+8aPE3UWvlq02EK9FCkxc3r0827axY/ze3f\n6k03X9crz5br1hp3ivTVevPQbX3bcfnZ2aZXhwvSX2VRfvysThc6ToudbeVrVpTLG6Jmgeot\nQodXgjbF5Zlde6LWylebDhNg6EdyM+xbyQbWv8LX1Zld+IcYrEjNC6k/89d+pYGif511mXcp\n/MsMVqTDc5jXfsmOon+Vi2eA4Z9juFO71aLK+bep/kVm588Awz9Hnu2G0AMpUgg9kCKF0AMp\nUgg9kCKF0AMpUgg9kCKF0AMpUgg9kCKF0APSIv0X7XDeaEclRVJrzcb10o5HiqTWmo3rpR2P\nFEmtNRvXSzseKZJaazaul3Y8UiS11mxcL+14pEhqrdm4XtrxSJHUWrNxvbTjkSKptWbjemnH\nI0VSa83G9dKOR4qk1pqN66UdjxRJrTUb10s7HimSWms2rpd2PFIktdZsXC/teKRIaq3ZuF7a\n8UiR1Fqzcb2045EiqbVm43ppxyNFUmvNxvXSjkeKpNaajeulHY8USa01G9dLOx4pklprNq6X\ndjxSJLXWbFwv7XikSGqt2bhe2vFIkdRas3G9tOORIqm1ZuN6accjRVJrzcb10o5HiqTWmo3r\npR2PFEmtNRvXSzseKZJaazaul3Y8UiS11mxcL+14pEhqrdm4XtrxSJHUWrNxvbTjkSKptWbj\nemnHo58i/d9zeD0oKZKfdjxSJLXWbFwv7XikSGqt2bhe2vH4F4s07rRm0fTSjkeKlCJNSDse\nKVKKNCHteKRIKdKEtOORIqVIE9KOx9tF+q/Ns9Fk4DVtONBn7nsnRyT1tGY/472045EipUgT\n0o5HitTbtE9qKXthktrxSJFSpAlpxyNFSpEmpB2PFClFmpB2PFKkFGlC2vFIkVKkCWnHI0VK\nkSakHY8UKUWakHY8UqQUaULa8UiRUqQJaccjRUqRJqQdjxQpRZqQdjxSpBRpQtrxSJFSpAlp\nxyNFSpEmpB2PFClFmpB2PFKkFGlC2vFIkVKkCWnHI0VKkSakHY8UKUWakHY8UqQUaULa8UiR\n/tEieU3LJ0XqbVqvaHpNyydF6m1ar2h6TcsnReptWq9oek3LJ0XqbVqvaHpNywddpElqIdH0\nmpZPiqTWQqLpNS2fFEmthUTTa1o+KZJaC4mm17R8UiS1FhJNr2n5pEhqLSSaXtPySZHUWkg0\nvablkyKptZBoek3LJ0VSayHR9JqWT4qk1kKi6TUtnxRJrYVE02taPimSWguJpte0fFIktRYS\nTa9p+aRIai0kml7T8kmR1FpINL2m5ZMiqbWver20z5Ii3WSgB2WSWkjiB9I+S4p0k4EelElq\nIYkfSPssKdJNBnpQJqmFJH4g7bOkSDcZ6EGZpBaS+IG0z5Ii3WSgB2WSWkjivbR8UiS1FhJN\nLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS\n8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2f\nFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR\n1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmt\nhUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpI\nNL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTT\nS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLy+dxkcqaw43bywy09yaphUTT\nS8vnySNSuf/vDgPtvUlqIdH00vJ5rkjl8Z/bDLT3JqmFRNNLy+f5Iv3Ro2kmPkXiaPk8VaTm\ngHT+FOm/Ns/uvReZpPZVb7QHhmlAT7xQpOM/1zy7914cbpJayM94Ly2f54t0ceuMgfbeJLWQ\naHpp+TxTpPLmzTYD7b1JaiHR9NLyeb5IObXrRwuJppeWz2tFunflbqC9N0ktJJpeWj4vnNrd\nf2PDNBOfInG0fPJeO7UWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8t\nnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJ\nkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJ\nrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRa\nSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE\n00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9\ntHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vL\nJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxS\nJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VS\nayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUW\nEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR\n9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0v\nLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLy\nSZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8U\nSa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tn7eL9F+bZ/fei0xS+6o32gN95r53\nckRSayE/4720fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2f\nFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR\n1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmt\nhUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpI\nNL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTT\nS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20\nfFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8sn\nRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIk\ntRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJr\nIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYS\nTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH0\n0vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8t\nnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJ\nkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJ\nrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fJ4pUVuw/3llkoL03SS0kml5aPs8U\nqfXhTpMG2nuT1EKi6aXlkyKptZBoemn5PC5S2f6YInXWQqLppeVzVaSvRVFs5+vTHcenSNtt\nu0j/tXl2773IJLWveqM9MHwbOnBRpM2s2LEtip/jXYcC5YjUjxbyM95Ly+eiSB/Fctei7Xcx\nP78/RepNC4mml5bPRZF2JTr+1yZF6k0LiaaXls/jIuXUrl8tJJpeWj63T+2WxcfxrrL1X4rU\nXQuJppeWz+XFhrKoKX9P9x3e0ZB3NvSihUTTS/uQJrbFx8/2+nnJn6uUy9/2XecLvDLA5R2f\ns6KYLTcvKLZjR9NLC4mml/YhxYHVi0VqVjnedb7AKwO8sOx9Btp7k9RCoumlfcg+9J/F7MVV\nfj+K8s5hI0VCayHR9NI+5BD609Wy38XutK2663dezFb11zcfu5O/zeUqH8Vn9cm6nF+sWS+w\nrA5YxxWbxW4OcDnPgfLj9+YKNxlo701SC4mml/YhxyPS8lCk+tn+8vS0f/fV+tbsYpXtunrR\ntCjmxcfFmtVny+rGacVmsZsDXM7T4vkmDbT3JqmFRNNL+5BDZj+2hyLNN9uvoqy6Nd9u5tV9\ndcuWxddxldaNujkXa9aXr6ulTys2i90c4PzTVTH/rQ+G32eXwB8x0N6bpBYSTS/tQw5FWmyP\np3b7W7Pq1m9zq15ycVyldeO0fPvWsrkQcVrx/tHlokizojmFrI5jLzzXGmjvTVILiaaX9iH7\nsH6fTu0O97ZvHU/yWqv8vfxX88lhxfuduPHOhnPjUwy09yaphUTTS/uQY3DLl4v00xxqbi3/\nVRbNJYaXizQ/nNrNd/7nryQOtPcmqYVE00v7kOurdofPLk/trlZZNE9+2msfb33XJ4KnFZ8u\n0u/pnQ3F8VnZYwbae5PUQqLppX1Ik/DN8nB0OdVhWV2Umx+vwJ1+seH0OtL2bpG21dWC1opP\nF2m7Ob6z4e71iRsMtPcmqYVE00v7kOOl5vVlHU6Xv/e31pernN5WdF2k36pmpxWfL9J7DLT3\nJqmFRNNL+5DDi5/r7WUd6hdkv5tbH0Ux/zlfZf92uHtF2n5WF6+PK6ZIHC0kml7azhT33m/d\n2wYuPl9eXNp4joH23iS1kGh6aTtQn7q98qLom5s5//TYoxQpRQJpO7B89W0673FRmLJYz4vf\nzbz1x0+eYaC9N0ktJJpe2i58zYrilTeOvsf1C7KfxWq7ufzjJw8YaO9NUguJppeWz3WRVqfX\np55moL03SS0kml5aPheFWRTfv8Vs+5MipUgkLZ+LwlQNmh/ejv48A+29SWoh0fTS8rk88qxm\n1a8MvvKuhoqB9t4ktZBoemn55AVZtRYSTS8tnxRJrYVE00vL587vI939C3a3GWjvTVILiaaX\ntst2e97SHdpFKtt/sOEly0B7b5JaSDS9tF222/OW7tAuzFerR8//LlLFQHtvklpINL20Xbbb\n85bucOfU7kUG2nuT1EKi6aXtst2et3SHXGxQayHR9NJ22W7PW7rD1a9RlHmONKwWEk0vbZft\n9rylO+TXKNRaSDS9tF222/OW7nD1axSvXWXYM9Dem6QWEk0vbZft9rylO+Rig1oLiaaXtst2\ne97SHa7e/f3i/xmpYaC9N0ktJJpe2i7bbS/28pOWp7n6u3bzd36XcKC9N0ktJJpe2i7bbS1V\nHP/pnatTu1xsGFgLiaaXtst2W0ulSBPSQqLppe2y3dZSuiK9yUB7b5JaSDS9tF2221oqRZqQ\nFhJNL22X7baWUhbpa1H9tvn61rL3GWjvTVILiaaXtst2W0vpirSZ1c+PivxduxSJpO2y3dZS\nuiJ9FMvmfwuTv2uXIoG0XbbbWkp51e7l/1tfxUB7b5JaSDS9tF2221oqRZqQFhJNL22X7bYX\nk72zYX9q9+of7x9o701SC4mml7bLdnve0h0uLzac/teXrzDQ3pukFhJNL22X7fa8pTtcHeiO\n/+vLVxho701SC4mml7bLdnve0h3ygqxaC4mml7bLdnve0h1SJLUWEk0vbZft9rylO1wWadFc\nIZzlOVKKBNJ22W7PW7rD9d9sqO/NVbsUiaTlc/U3G+r3Bq3zOlKKRNLyufM3G1KkFImk5XP1\nNxs+NtvtZpn32qVIJO1D/nefnrd0h6u/2bB/Qfa136MYaO9NUguJppf2IbQi7Q5G9QuyL/4F\nlIH23iS1kGh6aR+CK9J7DLT3JqmFRNNL+xBakeavXfY+MNDem6QWEk0v7UNoRSrzl1aH1kKi\n6aV9CK1I6/mrT49qBtp7k9RCoumlfQitSPm7doNrIdH00j4kRfrntJBoemkfQivSmwy09yap\nhUTTS/uQp4s00G+ap0hyLSSaXtqHPFukof5kQ/5ApFwLiaaX9iFPFqlQHZHyByIH10Ki6aV9\nCO3ULn8gcnAtJJpe2ofQipS/aze4FhJNL+1DUqR/TguJppf2IbQi5Q9EDq6FRNNL+xBakfIH\nIgfXQqLppX0IrUj5A5GDayHR9NI+hFektxho701SC4mml/YhKdI/p4VE00v7kKeLNBRnRVrP\ni+Ijv0YxrBYSTS/tQ1BFWjcXGl58e1DFQHtvklpINL20D0EVqbr2vfvnjd82H2jvTVILiaaX\n9iGoItWvwm6K8nXLQHtvklpINL20D+EV6a03mg+09yaphUTTS/uQFOmf00Ki6aXlkyKptZBo\nemn5pEhqLSSaXlo+50Uq8sdPBtdCouml5ZMiqbWQaHpp+eQtQmotJJpeWj4pkloLiaaXlk+K\npNZCouml5ZMiqbWQaHpp+aRIai0kml5aPimSWguJppeWz9tF+q/Ns3vvRSapfdUb7YE+c987\nOSKptZCf8V5aPimSWguJppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZP\niqTWQqLppeWTIqm1kGh6afmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRI\nai0kml5aPimSWguJppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTW\nQqLppeWTIqm1kGh6afmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0k\nml5aPimSWguJppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLp\npeWTIqm1kGh6afmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0kml5a\nPimSWguJppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLppeWT\nIqm1kGh6afmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0kml5aPimS\nWguJppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLppeWTIqm1\nkGh6afmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0kml5aPimSWguJ\nppeWT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLppeWTIqm1kGh6\nafmkSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0kml5aPimSWguJppeW\nT4qk1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLppeWTIqm1kGh6afmk\nSGotJJpeWj4pkloLiaaXlk+KpNZCouml5ZMiqbWQaHpp+aRIai0kml5aPimSWguJppeWT4qk\n1kKi6aXlkyKptZBoemn5pEhqLSSaXlo+KZJaC4mml5ZPiqTWQqLppeXzRJHKHYeP5e1FBtp7\nk9RCouml5fO4SOXhnzslqhho701SC4mml5ZPiqTWQqLppeXz5HOk8s8eTTPxKRJHy+eFIp0/\nRfqvzbN770UmqX3VG+2BYRrQE88V6Xhml4sNnbWQn/FeWj7PF+n8xjkD7b1JaiHR9NLyeapI\n5Y1bZwy09yaphUTTS8vnmSKVp39TpM5aSDS9tHyeeUH29OHelbuB9t4ktZBoemn5PPE60uFy\n3f03Nkwz8SkSR8sn77VTayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH0\n0vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8t\nnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJ\nkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJ\nrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRa\nSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE\n00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdEcWfu/53ht42OS\nIqm1ZolPkZ4jRVJrzRKfIj1HiqTWmiU+RXqOFEmtNUt8ivQcKZJaC4mm17R8UiS1FhJNr2n5\npEhqLSSaXtPySZHUWkg0vablkyKptZBoek3LJ0VSayHR9JqWT4qk1kKi6TUtnxRJrYVE02ta\nPimSWguJpte0fFIktRYSTa9p+aRIai0kml7T8kmR1FpINL2m5ZMiqbWQaHpNyydFUmsh0fSa\nlk+KpNZCouk1LZ8pFOnJB+XVDKVInGn5pEjqaSHR9JqWT4qknhYSTa9p+aRI6mkh0fSalk+K\npJ4WEk2vafmkSOppIdH00vJJkdTTpkhvaPmkSOppU6Q3tHxSJPW0KdIbWj4pknraFOkNLZ8U\nST1tivSGlk+KpJ42RXpDyydFUk+bIr2h5ZMiqadNkd7Q8kmR1NOmSG9o+aRI6mlTpDe0fFIk\n9bQp0htaPkmBe7IAAAkMSURBVCmSetoU6Q0tnxRJPW2K9IaWT4qknjZFekPLJ0VST5sivaHl\nkyKpp02R3tDySZHU06ZIb2j5pEjqaVOkN7R8UiT1tCnSG1o+KZJ62hTpDS2fFEk9LSSaXlo+\nKZJ6Wkg0vbR8UiT1tJBoemn5vF2k/9o8uff+e5F+H5T/MaZ9dtxoW9qaPnPfOzkiqaeF/Iz3\n0vJJkdTTQqLppeWTIqmnhUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLR9pkZ7ce5DE\nD6SFRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHU\nWkg0vbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2F\nRNNLyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0\nvbR8UiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNL\nyydFUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8\nUiS1FhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydF\nUmsh0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1\nFhJNLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh\n0fTS8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJN\nLy2fFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS\n8kmR1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2f\nFEmthUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLyydFUmsh0fTS8kmR\n1FpINL20fFIktRYSTS8tnxRJrYVE00vLJ0VSayHR9NLySZHUWkg0vbR8UiS1FhJNLy2fFEmt\nhUTTS8snRVJrIdH00vJJkdRaSDS9tHxSJLUWEk0vLZ8USa2FRNNLy+eFIpU77nyp370HSfxA\nWkg0vbR8ni9Sefznmn73HiTxA2kh0fTS8kmR1FpINL20fFIktRYSTS8tn7eL9F8IWvpPf4/0\nc0R6koF2hZfWbFwv7XikSGqt2bhe2vFIkdRas3G9tOORIqm1ZuN6accjRVJrzcb10o5HP+9s\neBKvByVF8tOORz/vtXsSrwclRfLTjkeKpNaajeulHY8USa01G9dLOx4pklprNq6XdjxSJLXW\nbFwv7XikSGqt2bhe2vFIkdRas3G9tOORIqm1ZuN6accjRVJrzcb10o5HiqTWmo3rpR2PFEmt\nNRvXSzseKZJaazaul3Y8UiS11mxcL+14pEhqrdm4XtrxSJHUWrNxvbTjkSKptWbjemnHI0VS\na83G9dKOR4qk1pqN66UdjxRJrTUb10s7HimSWms2rpd2PFIktdZsXC/teKRIaq3ZuF7a8UiR\n1Fqzcb2045EiqbVm43ppxyNFUmvNxvXSjkeKpNaajeulHQ9pkUKYKilSCD2QIoXQAylSCD2Q\nIoXQAylSCD2QIoXQAylSCD2QIoXQAylSCD2QIoXQAwMX6fB/Qj/9H9HL7fnnvWrbN3rUlgON\nO4y27Diu+DHrqKUwbJHK/T/l6ZOyfX/P2vaNPrUdH2j9XhhCO9C0HbUYxEUqt4M8KOVBVnZ5\nTO5q+y7S0Huh08TiaVOkpzn7MdTaZ93jeaUtuz8mN7S9PMwDee/s3KH2Qv+PWYr0NP5F6uM0\n/maGuntv79xhpu0uTpE6UG5vPdadI3RLe7yvf+0g3u7z3t65ffw0ufFTarjHLEV6gjuP9QAR\nGirwF7d68/Ywr7BIQ01b1TNFeszlg9BTNG9py64Xfgeb9ra3ezTvjNtHj3TTdtUyGLpIl49E\nTw/KbW1X61DTqvdCD0dP2bR9nEYQGPoF2daHHvfeHW1H61/T9tAj3V7o4egpmzZFeobjuVa/\nL2ff1W67PdTDTKvfC91aL54272wIIRxIkULogRQphB5IkULogRQphB5IkULogRQphB5IkTqz\n+VqUxfzrnVU/ikVzY1F89DlSkJMidWVdFjXl5o2Vy+K7+vBdTOE1yX+aFKkrs+JjV6HfebF8\nY+Wfun+bsvjpfa4gJUXqStHswk31sbnd3FqXs2JWf2lWrLebj6Iq3Ka5a/9huz+525/Y7ZfZ\n8bPYHeGW20Yz134/4S1SpK4sitXxdrtI8+JjUfzuPv2tWlOf/+0+Luulv4vPwyplsV7vT+wO\ny2xXzcnicq+RfjvhPVKkrvyWxWz5/VvfbhdpWZ24VUeVqjuf1a1l8bVd15cXFrtj1J6fYrFo\nTuyOy+wOYbtnTuujJhiQInVm8zmrjiRVGdpFqqo1a97uXFWj/sJi36H2tYXqfK6+cVpm187V\n5/ykCXxSpD5YLz/m1VGkXaTq1tfuWPNTncYVe7b1IWl1dpzZP8lqLbOdH24VeXxMyAPVF9VR\n5rJIm93BZllszkoyK36XradVt4r0Ucy+Vr8pkhN5oLpSFJv9x33u2w1YFr/1udrstJ93h6Oy\nOBc0H0/L1PdsUiQn8kB1ZVnMd0+PNsuqMNXrq5t5qwHr3RHmp15oWV2rq69k755RLdqCQ1lO\ny1TrnGkCnjxQnZnt39nwW3Vhx2e7AfvXkjbN2x/qa3Wronk7w4HDoqdllkWeI7mRB6o7X/Pq\n5dP6BG931va5bTfge1+a34+iPnJVHE4Gt4dP9zdOy9Q3UiQn8kDJ+Tm+rSFMhxRJzvzsml2Y\nBimSmN1Tn7x5boKkSGLK80t2YSKkSCH0QIoUQg+kSCH0QIoUQg+kSCH0QIoUQg+kSCH0QIoU\nQg+kSCH0wP8Dpr44z2TWclQAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Binge prevalence by year\n",
    "brfss_merged2 %>%\n",
    "  count(year, binge) %>%\n",
    "  group_by(year) %>%\n",
    "  mutate(perc = n / sum(n) * 100) %>%\n",
    "  ggplot(aes(x = factor(year), y = perc, fill = binge)) +\n",
    "  geom_col(position = \"dodge\") +\n",
    "  labs(title = \"Binge Drinking Prevalence by Year\",\n",
    "       x = \"Survey Year\", y = \"Percentage\",\n",
    "       fill = \"Binge Drinker\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57571a92-a366-4171-9735-e06c5044db8e",
   "metadata": {},
   "source": [
    "# Bar Plot: Activity Limitation by Binge Status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "3eb0013a-5adc-4ceb-bf4c-85b524f75311",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\nQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGeli\njRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ\n6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJF\nJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0Q\nQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGeli\njRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ\n6WKNEEJFJBnpYo0QQkWk2/nva6SLNUII9VoII+adRS9skcQQQmWLJCNdrBFCqIgkI12sEUKo\niCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawR\nQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNd\nrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgk\nI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKo\niCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawR\nQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNd\nrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgk\nI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKo\niCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawR\nQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNd\n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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = binge, fill = activity_limit)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(title = \"Proportion of Activity Limitation by Binge Drinking Status\",\n",
    "       x = \"Binge Drinker\", y = \"Proportion\", fill = \"Activity Limitation\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0c122e4-e1d1-41fa-891c-0692f1092106",
   "metadata": {},
   "source": [
    "# Stacked Bar Plot: Race × MCC"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "fc41123f-224f-4525-a138-61b595d45f19",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAOVBMVEUAAAAAv8RNTU1oaGh8\nfHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3////ccKm3AAAACXBI\nWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO3diVoi2dq04fzTAasc2o/zP9ifxZikoEEaL7F6\n93Nfe5eigIEZUQxlVw1rAL82pAMA/wsYEmDAkAADhgQYMCTAgCEBBgwJMGBIgAFDAgwYEmBg\nH9KwMz6/70+ef/rz+ey8F85xdsYrn7zu83kYHg4nxqc/H/t3P/48jft3/z5t8j29Hi8yP/3T\nV93fwuFh9XlDrk2qYeL7Gzj/6Pb02bcOnaka0sZqd3L+6fmJK63dffjmIbVRPE6yrPbvrob9\nVb2P+3j7c81P//xVT7dw1Jf0d3iZDem7G3jxu3bz9wJ3VDCk7ZuPP8OmOlc//e1Hvvvwz1/+\nfXri4XA3ND7srvB9c+fztnn79jg8XTotfO3DZzcXWX13vjOPw8fsam/+nYIh9axqSNuKXvgN\nu35IZydehrfte2+b97afeRj+7D/5OLxeOC187cktHL8739RnOytD+h9WN6TNo6mXw8n35/as\n6W3/sKi9+XzY3AMcHrG8jMPj6+TCmzdnj382lx8Pz7o2H1mNw8P0Kc3ps4eHTccsH/s7jdXw\nvv346+l+5719an76eBv2kT4PT7g+T8+8Tl9g/95qc2/3uBvs+vVxGJ53v4Fs7rH2N6t9ndWX\nkR9u4J9xd+nJLduf83hlu3NuXMqDHhQO6b2VdHvybf/E4PVUn6f29GU/pNXxKdWVIb0eL98+\n8nh8f2fy2S9DWu8f243j7qqehukCv54+XO4YabU/w9/TA9X5PdJ4CrfeXW7cXeL0THH9PLxd\nG9Lz9r23s1u2O+fpyo5DupQHPSgc0vq4hIfh77od+4fTA5rHw2+0m1/GzWdfx/bk5jSk6SOf\nzZ3Jy+f6c9Orj+3Z39afT6fXBs4+++XFjNX2sd3bYbXj7OHm/PThcsdIH/vf+R+Hj9Nnd2/f\nxu1KXraVftkG2kzrdf25fe70vr2bed8/YDzOYf6NGraX2N6cyS3b3+zjlZ1ebLiQBz24y5Bm\nH2u/vh1PDNuV7R5ZXR7S6vjb+vYsrZmf00eQk89+GdLb9qNtThdf+br2otkp0tP21YvpI6nT\nS2/bMT/stri9puftM67tmVe7D39uHzu+Ds9nFzxFmdycs3fPr2xyga950IO7DOlp8xTm78fk\n05PBrA+vSZzur+ZDetj/7vsxO8vO2We/DKk9qGt3PF8nPU979tFTpO0D1LNHUocxPBxepli/\nv7487pMe7+AepqNZ7R+VXhrS7BZP78c/T1/yeNavedCD0iEdXqn6GI/FuzSk0wUvD+l4lbOz\nzL7g16W0E+3O6K3dIczLuTU/fX6V+98F3s8fSW0/+jken139GWfj2J9rMppxeqvPvsg3Q5rf\nj+9Pf8mDHhQO6e34YsPmsc32KfXLhfpUD+l181VXxyfwz9MXFz6+nj6/yv1TlafzR1K7z77t\nH56u/2we4q3+flx+DDv5TriG9CUPelA4pFV7pnE6+f58+rOUiw/trg7pVw/t2uOz8djDycvd\nH+Pj19OHy50itd/9P88eSe2/xMv+BxseJs/3Jq9djJM/GV7tnnPdOKTx4kO7r3nQg7ohvX95\npWq2j2M/ts813navVrXuvM7OuBp2P2X2PHs9YufssxeGtLnT2b4qsPvMuOv09uHm64XT+8ud\nIm3v0x6mj6QOX+JhmPy03OvkDm/7p6/Pu8++t+uYvh4xu5pvhjS5srMhzfOgB1VDaj8idHxO\ntHv5e7V7qDd5kXrfj/bZv2P7jf1xePpsLzsPZ2fcPGxa7V7gfr8wpLPPXhjS6+4LnB6RtR8J\n+tw8sXm6dHp/uVOkFn88eyR1+BLvu6+4/dmIXebN1xrfjy9/b39t8/zYv1Y/H9LsOzF/d3Jl\n+2/Ufj2zPOhBwZAOTj+0uv8D2fFj92LWfEgvx7PvzrhqH5+e8fwPZE8X3Zl+9sKQPofd/dzh\n2doh3tP64un1LNLuLC/za22et33+c7iCtrrV6WXx1+N34WX/Y0iTV+2GC9+JL++ermz/29Hp\nJvDIrjdVQ3pYTf8zirftjwi131DfHyY/dXZ4xPIyHn7E5m3z6Zftx8/OeP4jQpM3889eGNLm\nbu5x+pnP9lL18Hx8HDc/PY+0neLH+Wf3xu1C/rSv/rZ/tvVnE3u/v4/2Az/tDIcHYudD+vKd\n+Pru8cq2p3cX+JoHPbAP6X/Qn84eSfWWB2uGJHg/PFfqRG950DCkH0yeK3WhtzzYYUg/eJj8\nKFAPesuDHYYEGDAkwIAhAQYMCTBgSIABQwIMGBJgwJAAA4YEGPxLhvRPOsBXRFJ0GKkGQ1qK\n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\nolBCDwAAAABJRU5ErkJggg==",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = race, fill = MCC)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(title = \"Distribution of MCC by Race/Ethnicity\",\n",
    "       x = \"Race\", y = \"Proportion\", fill = \"MCC Status\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "84e59592-42b8-4b86-bee5-4b74bc13c747",
   "metadata": {},
   "source": [
    "# Plot: Smoking Status × Binge Drinking"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "8a1cbb0c-39ea-4750-a027-f80123e2312d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\nNG5IdcOQhiESMbw8c8SQsohEDC/PHI35yYbTxU983dL3XilEIp5ozwyV+lm70vdeKUQiYp2z\nYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJi\nnbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlE\nImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JI\nWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2z\nYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJi\nnbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlE\nImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JI\nWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2z\nYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJi\nnbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlE\nImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JIWUQiYp2zYkhZRCJinbNiSFlEImKds2JI\nWUQiYp2zYkhZRCJinbNiSFlEImKds5p4SP89qvS9VwqRiIc7M21VJ8YjUhaRiFjnrBhSFpGI\nWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGI\nWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGI\nWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesBgyp3ju+s3/bXf7M1y1975VCJOKZ\n+szP0Eekujktp774aKDS914pRCKe6s/sDBxSffqFIT2FSMRT/ZmdJ4ZUn9+vn90RrSGSo+cK\nNDfDhtQ9IB2fIt0Y0n+PKn3vlUIk4uHOTFZ6h2eGdPylPkzpmQel0vdeKUQinmjPDD0xpP57\nT5/elb73SiESMbw8czRoSLW8y5AGIhIxvDxz9MSQ6st3GdIQRCKGl2eOnhzS+QGJIQ1CJGJ4\neebomVO7w6t2p2HxYsPjiEQ80Z4Z4mftsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpn\nxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETE\nOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKI\nRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQ\nsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpn\nxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETE\nOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKI\nRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQ\nsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpn\nxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETE\nOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKI\nRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6Z8WQsohExDpnxZCyiETEOmfFkLKIRMQ6ZzXx\nkP57VOl7rxQiEQ93ZtqqToxHpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIR\nsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQs\nIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkx\npCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHO\nWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIR\nsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQs\nIhGxzlkxpCwiEbHOWTGkLCIRsc5ZMaQsIhGxzlkxpCwiEbHOWTGkLCIRsc5ZXQ9pVVcd89ct\nfe+VQiTC3LSQq8GsqoohORGJmKRPh9a+fu3fH3CTerXpX3R5hSG/gcsP6+p9wI1HKH3vlUIk\nYpI+nR4APgcOqbvJ6aLLKwz5DVwffMBtxyh975VCJGKSPh2K+1YtBt5k81rV27vHfPBolx++\nVN8cdGql771SiERM0qdj6du33f83L7vTtvaizbJafO4/v33dnfxtr2/yWr21H6zr5dUt91dY\ntQ9Ypxt2V7v5G7j8cFMvNzevN7XS914pRCIm6dPpEWl1HNL+VbPdR9v69KR//97i6ibNulq2\nHyyr16tbth+t2nfON+yudvM3cP374cUGKyIRk/TpWNvX5jik5bZ5r+p2W8tmu2wv269sdXoV\n4NTx7vorueXuo+7a5xt2V7v5G7j9+2FIJkQiJunTsbYvzenU7vDeon1v0723v+bL6Sa9d87X\n77+36l6ION+w++TN38Akf4zhSt97pRCJmKRPh1V8nE/tjpf237t4jLga0u3rv3cfHG/4/QMM\nQ8oiEjFJn04vNtSDh/TVPdTcuv57XXUvMQwf0na12D2tWtlfuyt975VCJGKSPumrdsePrk/t\n5CYv3ZOf/q1P733sTwTPN3x4SJvDSxy1+7W70vdeKUQiJulT1/Dt6vjocp7Dqn1Rbnl6Be6j\nWl7cpP0+UvPtkHY3/Ojf8OEhvVbty9+b717jm07pe68UIhGT9On0Itn6eg7nl78P762vb3L+\nsSId0qad2fmGDw+p/whpVfreK4VIxCR9OpxIva6b6znsvyH70b33WlXLr8ubHJ7GfDek5q19\nTDndkCHNBZEIc9M6+/M36xe4/JBTOzMiEeam7U/dVvZC82JDFpEIc9MO/2aQu9C8/J1FJMJd\ntfddo1/tP0HKN2SziETEOmfFkLKIRMQ6Z9UfUlXxQ6tuRCLMTQthSFlEIsxNC+HULotIRKxz\nVgwpi0hErHNW3/xkQ+3+RnDpe68UIhHmpoX0h1RXFc+RzIhEuPs0yfF/1B/Me29H7r/eLnY3\nzQyRCHefJjn+j745tbOL3U0zQyTC3adJjv+jq+Es3T/bdxS7m2aGSIS7T5Mc/0dXQ6p5RPIi\nEuHu0yTH/9HVcNbLFX9BpBORCHefJjn+j/h77bKIRLj7NMnxf8SQsohEuPs0yfF/xE82ZBGJ\ncPdpkuP/iCFlEYlw96l/Nd+5Fv+GbBaRCHefeteqTr9Mbsjf2VC3Dm+7j7uLn/m6sbtpZohE\nPFOfIeH1rpUb0t2/RajuvamP/3tuR7SGSI6e6s+A8HrXyg3p7t9rx5DGIxLxVH8GhNe71jyG\nVPff1v0tPSF2N80MkYjnCvR4eL1rzePU7vQUqWm+HdJ/j4rdTTNDJOLhztzr8Z3jX7e9+IsN\nvQEdTuoOU3rmQSl2N80MkYgn2jMovN61ckP68eXv/pCaEad3sbtpZohEDC/PsPB61woO6ScM\naRwiEcPLMyy83rXmMSQ5tTu9aseQHkYkYnh5hoXXv1r4JxuWb7euWvf+z5CeRCRieHmGhTfJ\n8X809Ccb+m+Pa+LFhscRiXiiPYPCm+T4P7r+V8357yN5EYlw92mS4//o9jdkt/z7SCZEItx9\nmuT4P7oazEvVvfB9+k8/u8TuppkhEuHu0yTH/9H1I8/rct2e2i35L/Z5EIlw92mS4//o23/V\n3Pyvm8fuppkhEmFsWRBDyiISYWxZEP+qeRaRiFjnrBhSFpGISfr0v+9Ncvwf8Xc2ZBGJmKRP\ncxvS3Z9smFLpe68UIhGT9GluQ7r7dzZMqfS9VwqRiEn6NLch3f07G6ZU+t4rhUjEJH1iSP8Y\nIhGT9GluQ+LUzoxIxCR9mtuQeLHBjEjEJH2a25B4+duMSMQkfZrdkFJK33ulEImYpE8PD8lV\neP4bsllEIibp06NDsr2Kxn9DNotIxCR9enBIVeoRif+GrBmRiEn6NLdTO/7Tl2ZEIibpE0P6\nxxCJmKRPcxtSTOl7rxQiEZP0iSH9Y4hETNKneQ1pvayqV15scCISMUmfZjWkdffsaG36UhdK\n33ulEImYpE+zGtJrtWp/iXxPtvS9VwqRiEn6NKsh7V+q21ZP/scshyl975VCJGKSPj08JBcZ\nkv9fRdorfe+VQiRikj4xpH8MkYhJ+sSQ/jFEIibpE0P6xxCJmKRPMxtS5q8rbpW+90ohEjFJ\nnxjSP4ZIhLlpIfyIUBaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGI\nWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrCYe0n+PKn3vlUIk4uHOTFvVifGIlEUk\nItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aU\nRSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkr\nhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLW\nOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUk\nItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aU\nRSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkr\nhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLW\nOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUk\nItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aU\nRSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkr\nhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jkrhpRFJCLW\nOSuGlEUkItY5K4aURSQi1jkrhpRFJCLWOSuGlEUkItY5K4aURSQi1jmrIUOqd45v6/3b7uJn\nvm7pe68UIhHP1Gd+BgypPv5Snz7ufTRQ6XuvFCIRT/VndhhSFpGIp/ozO0OfI9Xn5dQXHw1U\n+t4rhUjEcwWam2eGdHyKdGNI/z2q9L1XCpGIhzszWekdBg7pdC53fLGhPr3mMEzpe68UIhFP\ntGeGnhhS/52nT+9K33ulEIkYXp45Gjak+vo9hjQQkYjh5ZmjQUPqfd/o/C5DGoJIxPDyzNGg\nb8ie31y+y5AeRiRieHnmaMj3kc4/0XDxMw282DAAkYgn2jND/KxdFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGI\nWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIW\nkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wY\nUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjn\nrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGIWOesGFIWkYhY56wYUhaRiFjnrBhSFpGI\nWOesGFLWnUj+94+Kdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXd\niaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJ\ndc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXd\niaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJ\ndc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXd\niaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJ\ndc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXd\niaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc6KIWXdiaR0oUuJdc5q4iH996jShS7l\nTiSlC13Kw52ZtqoTK/WIVPreK4VIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hE\nrHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmL\nSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YM\nKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxz\nVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hE\nrHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmL\nSESsc1YMKW3twRcAAAYrSURBVItIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hE\nrHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmL\nSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YM\nKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxz\nVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hE\nrHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmLSESsc1YMKYtIRKxzVgwpi0hErHNWDCmL\nSESsc1YMKYtIRKxzVgwpi0hErHNWzwyp3unedh8+83VL33ulEIl4pj7z88SQ6sMv3f+e2xGt\nIZKjp/ozOwwpi0jEU/2ZndFDem5HtIZIjp4r0NxMPKT/AJdJCu8yYkj7Fxvq02sOv8e875Ei\niGSsMUNqRp7elUJrBJGMxZDQEMl444Z0eNWOIf12RDIWQ0JDJOON+cmG45p+2Y5ojSKSsUr9\nrF1JtEYQyVgMCQ2RjMeQ0BDJeAwJDZGMx5DQEMl4DAkNkYzHkNAQyXgMCQ2RjMeQ0BDJeAwJ\nDZGMx5DQEMl4DAkNkYzHkNAQyXgMCQ2RjMeQ0BDJeAwJDZGMx5DQEMl4DAkNkYzHkNAQyXgM\nCQ2RjMeQ0BDJeAwJDZGMx5DQEMl4DAkNkYzHkNAQyXgMCQ2RjPcvDgmYHEMCJsCQgAkwJGAC\nDAmYAEMCJsCQgAkwJGACDAmYAEMCJsCQgAn8pSHVF29uXaG+819g/23/bfbnEIHJnxpSV4Rv\n61D//Nm/jghc/tSQ7vfkhwesf6FFRGDzR4d0OIOpm96ZTN2/Ynvx4XOn63a/9G4a/L1nEIHN\n3xpSU5/fdI1ozu05Pz3oLr6+7o2b/jVEYPPHh3R4e77KxT95r69bX1/8FxGBxR8bUq8ON4d0\nffHFdU9nOfUfbxERTO+vDakrw1VDLl7z/bZF9fkfx83fbhERTO+fGFLv0/f+cXxxPvMnW0QE\nNn9uSE397ZBOH/3Yor96XkMENn9vSF0drp9Sd5+p64sC3bxu/8O/hwhM/tKQgGIYEjABhgRM\ngCEBE2BIwAQYEjABhgRMgCGNs31/qavl+72rVNX1Oz8d6f3yOzjvfENn/hjSKOu62qu331/n\nsSH1j3R1xfsDxCxwH42yqF53xd8sq9X313lsB/0jMaTfh/tolEPHt+3b3f9fqpdms6he2sen\nzWtVvW6O11lVn013pc1LVe9ntxvN4vP64ao9UvvAtHv366XaX7P7sPv8/te3ulrcPZlEHkMa\n5WW3j6Oq2jW/+ljsfnndLaLun6itjg80u4vay1fHK5yG1DtSd+ln9+mVDGm1v5wlzQtDGmWz\ne3BYfWz277f7+Wib/9HVfdk0xxO11b733R6W2+a9qnePK7srbJenIV0eqWnP9T52z5xOGzoP\nafeg1nxVvAAxLwxpnO1b+wi0+Gq6gu9+OTwGLdqPNtWi/WjVPdocV3BxhermkfaXbD7fljeG\nVFevn/L7QGEMabT16nXZPnqc+355KnY6Ebu++Pje7SPtHs6q3lnd+eqfu3PCxSb358MjGNIk\n2jOt74f0XrePUz8P6eJIr9Xi/XNzY0i7wS2q+ivzB8ODGNIo+zO5preM0y/9U7vds6aX5no+\nV6d2t4+0vfzwdPV3XhKfGe6PUVbVcvfQsF21Q7kc0sWLDc3pjK3/4tv+CtX3R/o6vBix/7De\nHaH7sN59Ys2LDTPDkMZZHH4eYXM9pMuXvzfHM7bzkK5e/r48Un18lfvwkvnhw7fzy99vpf7E\nuIkhjfS+bL9tenwK1D8Nu/iG7Fv1ev3MqP2G7EfvFO18pP3L47snSbsHqfbz3Yerejee7pu7\ndVWzo5lhSGVxivZHMKRS2udAu9O019K/D0yCIZVyeA7EN4T+BoZUzPvi8CQKfwBDAibAkIAJ\nMCRgAgwJmABDAibAkIAJMCRgAgwJmABDAibw/+eW+rqwxt43AAAAAElFTkSuQmCC",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = smoke, fill = binge)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(title = \"Binge Drinking by Smoking Status\",\n",
    "       x = \"Smoking Status\", y = \"Proportion\", fill = \"Binge Drinker\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "11584376-1e4f-4345-bebc-19b359eabb25",
   "metadata": {},
   "source": [
    "# Bar Plot: Physical Activity × Bad Physical Health"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "6740d40b-7c34-40e3-b437-79f50980841f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\nUqQQFiBFCmEBUqQQFiBFCmEBUqQQFiBFCmEBUqQQFiBFCmEBVl2k9urChvbmMhBYd5FGleyE\nMo1dlXUXaZTJz6j24Ji6Ki5FatvWyKxzkU6xveLXYOVFOinltmea7osN41cgRVonk8Ok1it5\nJdZepKNGrkVqj3O6TOzQrL5I4yzHtUiTO5zSVyBFWid3zoA7xeez/iIN78XORXKMz8egSIan\nvy/Rc/qbxKqLFAKLFCmEBUiRQliAFCmEBUiRQliAFCmEBUiRQliAFKlMM7LdDde/G1e8++5D\nze29b+03z7DfNs3Tx0+2N1QkRSrTnNgtWqT3bo3vX1dQWMu+HTYhTRInRSpzVPulefq+SN8s\nfm+xbfPcbO890V1e+rEvzWb20wcqKVKZk9/HRrw07cvhc1R6uHhtm83badz+uX+44+O5Ga+N\ni00XOK3u87jm4zJNczX0sOl2gZ/dhG772d1om8/Dr3ocqOQFKnNdpOfe95euTv207E/z2l3r\neRsf/xxmYM/jxG0YeOnfaYGR924Xsx3uOy1zKtLhudl3d+/7Pg0Pnbu3zx5JnRSpzFikbt+w\n7a8/fR5em/aw69vSKb/r7tofPrp7hnH9DOyjv7Jp/hy6Qc25SJcFRvpivQ9zu/Myp2Okj75/\nw4DX/tpL39KeXXteOoiSIpU5n2zYH4bWjMYPlej70zbb9+O4vj+fp8X2769PkyJdFhhpz2cW\nzsucTzZsTn+adTO8LkMFD4e3pk2P1EmRyowtaienv/uf/R7mvd9hvHfTr82pXpeDmKdxscvd\n5wUGPo7lfJ8scy7SW/PRDXi9dLh/9E+/MwzipEhlpkf4lyJ1e4v9eNxz2G2a9uOmSNtm8/a+\nnxZpssDhcDyyasbp4nTlw5FWd/dLv5+aFmmTed0/QIpUplCkbu/Snh55O7Xlepr2eVWk6QLH\ns3CfTXtvate1aD/M5zZfnjpokxepTKFIneWD7G03D9tdTja8nE4xfBw+r46Rzgv0fBw/Qtp2\nwybLnNa9O3722j/Uz+lYUcOjpEhlSkV6b/ozc8dJ2ut47/50vvrlPCm7FOm4wGFYaPyOQn/Q\ndF6mOdWx79z4sVN7+kpF9kj/BnmRypSK1H922l90E7b29XTvrtsLbftTD8NX466LdFrgMPlb\nsforp2XeLkX6c6zc5Bt2KdK/QF6k+XzM/Xh09gLhnyNFms/TzXdOl18g/HOkSHPpDl3mnQOY\nvUD4B0mR5tKez8ChFgj/IClSCAuQIoWwAClSCAuQIoWwAClSCAuQIoWwAClSCAuQIoWwAClS\nCAvw/yJgNJTVTtHwAAAAAElFTkSuQmCC",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = active, fill = bad_phys)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(title = \"Bad Physical Health by Physical Activity Status\",\n",
    "       x = \"Physically Active?\", y = \"Proportion\", fill = \"Bad Physical Health\") +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "972dc505-e2af-4c61-8596-bcdf3b122b01",
   "metadata": {},
   "source": [
    "# Bad Physical Health by Binge Drinking Status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "fdd3698e-fb1e-4bf6-8de2-cf90cdba9f48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAOVBMVEUAAAAAv8RNTU1oaGh8\nfHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3////ccKm3AAAACXBI\nWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO2di3qqWqNDOWhr79u/7/+wRwEV0dkl1WSmJOPb\nu95gQmBEEW1X8x1CuJum9gqEsARSpBAeQIoUwgNIkUJ4AClSCA8gRQrhAaRIITyAFCmEB5Ai\nhfAAUqQQHsDDi9QMrF9/O8L2uR9n9mxNs5qsxeqlOPlo/PNV/ueCf5rgbNRbZugeLCT+eU3O\nI87cXMPM7fPnTwu8McKB9+d2tz6b7f56H2nM5T2LAlaknZe/HuH0cwZP40X+eyWuFKmfukKR\nColvKtIQ8XdF2rH5YYHzivR0GPL96gyzd+jfAlCk/vKjbX75mvTLLd40n+Mb3cXn+kyUwlLO\nV/muHU4tUnfxQ8R/z/z12jTlF+15m+K1ad+HIT9TpAcMeBjx47cvSb8u0pUbX03778nPV/mP\nFemHiDfM/P3ZNNt/T3ULbfPVX3ltnlOkBwx45s9uN62ap92Nz93x83BEvrv/tW3W7/1UZw/s\nJ+6ODk5PuGfzbdpm9T5a2OnRZphtuhbDlc1qdwj00d/1vm7al7Lyw+p9fG8Pb7m6K5/P+7cU\nH6fJd8M0z9vJ6D8V6WM3wyH12RynxP2CR/O99BvqfFWuRTz8OG2hfczXYarxoicrt9m/JA27\naTpId/urXb38Y/jLvMe9cQx6vlu7i9MmXQDwIj11h+HvZ4fPL6ej8/MH9hOfbfHzh9fH6z2j\nRwtFGsRrT6N89wt4/qFIz90UH7sp+0W97Vz7GC/qNEw7Gf2HIr2N3pOcz3FMfFjwcb7NYZbx\nqlyNOJh+2kLDNu7uHy96unKf++e5YTdNB+lut8eX6dLwPevz8Zth5rMddFak0SZdALgivfc7\nYL1/0t4dQLxsv7e77f61v6992z3c7g+lJw90E48OdKbz7V4mnk5HjGePXj20272B6Pf6S/dz\n3c/UL/2K8sMq7471u8V8DU//6934q/1cOyNXxzXbT9XJMx69XKTP7om5X6HpHIfEhwUf5ztu\nqPGqXI04mH7cQuOY40VfrNywAqctPxpkf3t9ylUYfuBrf3Dw9nm2gMtNMyrSaJMuAFiRdhu5\nex7qnl83w7PV8/6yGWRoNxcPjA6Pup+Th/cibMdHJaNHp0Ua6J7AV/37gGHI7hzItr1U/rDK\nx8U8decvtsf2jCZ/7obpHhqPfjbZiW65/Wnh/QvAdI5D4km+Tta9tJuzVbkacRjrOMIQ862/\nflr0JPJxBT6uDbI/lmvar38Mf+CrPyp/ej8t4HLTjIq0rDdNgCIdGNm9GrrTPbEennKfVtMH\nRsfP/c/ywxejFor0NDxFfr6/rIch+/c1T9eUH61y/1S+V687nHraP91+nVZgdfYe/Th6uUir\n8Y3JHBeOHUbol9G9RTutytWI46X3T/dDeZqLRZ8vZOz0dJCmeR3K/NPwJ7ZdqPOX5smmGY0x\n2qQLAFWkdvzEdNqs3e4ZnlVXzfSBiyKVH74Y9eqh3Xb37n3/XPvaHkU6TLa+UP7KKnevA93h\n1Fc3wur12tKujH65nmetmsxRLNLo8rQqVyNedmC84X4sUvtDkZrhQ+6fhp/wse5PX1zfNKMx\nRpt0AQCKdOXW1SKt8UXq3h/sT8g2683b19lk162arPL+deBwOPX+PBxHTZd2bfTL9Txr3mSO\nW4o0XpUrEX8u0veU010f/cmGixXtZ2zfm/FbsKvDT69tT9W83DRnIY+bdAFwinR+iDYcqmMP\n7cbXVmdvAbq7xwclP3R/3WxHh1Ofz0dH2tOh3ZXRL1fhux19Xjydo1ikbXFVpuNPTR8fe40X\nfTHzZn/sVizS1+7x1ZVHLg/tRqcyTpEuN800ZL9JFwCnSJum/6LVcNKg3wn9yYazB0bzdD/L\nD1+MWnxFOj49vncX/bv2/XPlz6t8mOdlNTqcOjnyPLzxnoxeLtJzv7Knl4/RHMUidYc9wyfb\n11ZlEnE0wnA2oIs5XvTVmctF6rpy5chxPHzP6ezb2yni5abpd/57cev/WThF2r24b/oT1Z/9\nAUN3imx78cAwz/E80fWHD4OfPXq9SB/tvmSr/W4fztW+dueU3wpvGL6ni1m1vSD9udrN8Tjo\nvWk/h9Pf49HLRfrsTmV8dicGp3Ocnb8fz7df6Fs7fLJ0WJWrEaem9+en+5jjRU/2y2tf1h+K\nNMpcGH5gvduw+z26GT42+vqeBv3qpnraDveMNukC4BTp8nPX4frkgW7aVXN6lr7y8GgB40en\nRTqwfxZ+PdzYG9l/qPhyY5Heh2P44dPD9uvwyObq6OUiHVZ2c2WOceKz+UafXJ9W5WrEqenD\nJ6bN0PrxOOczb6aZp0Xqjgx/HL7na324a7+WfaRx0P6efjtuTlf70+t/H1KRpl/1aZrDF/jP\nH+juWY1OJF0+PF7A6NHrRXrqTt7uTx61zx/v/ZPfW/krQpeL2R4+9frovs8yeuV43a3mZjr6\nD0XaPVe3h3NUkznOEp/N9zL6ztBxVa5FvDC9+wrT00d/fbTos5lXm7Ntd71Ir6MvD10ffuD9\nqT0O2UcaBx3u+Vgdt/5pky6ACgeof+qg+FXng/ffrMoWe+AEHv4vkSL9yGfbqHypct6q9B+k\nfqx/+7ssdYf/g6RIPzB5Y1GTuatyeA/z29+urDv8HyRF+oGVzufus1flvfuN4TfQ6qCH/3v8\nGalDUCZFCuEBpEghPIAUKYQHkCKF8ABSpBAeQIoUwgNIkUJ4AClSCA/Aokj/1V6BijhnZ5Ii\nLRzn7ExSpIXjnJ1JirRwnLMzSZEWjnN2JinSwnHOziRFWjjO2ZmkSAvHOTuTFGnhOGdnkiIt\nHOfsTFKkheOcnUmKtHCcszNJkRaOc3YmKdLCcc7OJEVaOM7ZmaRIC8c5O5MUaeE4Z2eSIi0c\n5+xMUqSF45ydSYq0cJyzM0mRFo5zdiYp0sJxzs4kRVo4ztmZpEgLxzk7kxRp4ThnZ5IiLRzn\n7ExSpIXjnJ1JirRwnLMzSZEWjnN2JrcVqe1/7ji/HD2ojLNMztmZ3FSkoTfDj9Fl+/0XemQt\nk3N2JrcUqf1Okf4sztmZzDi0u16kP9Aja5mcszN5cJH+u4X/LR/j7Dcp8FiJFbijSN1bp/Z4\nzuF2au9qAsbZZ8qwFO4p0vcvD+9q72oCxtnnubAYUiQIxtnnubAY7itS+50iXcU4+zwXFkOK\nBME4+zwXFsM932w43j1zmbV3NQHj7DNlWAo1vmtXe1cTMM5OFEmJFAmCcXaiSEqkSBCMsxNF\nUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJ\ngnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJ\nIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESK\nBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPs\nRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIi\nRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJx\ndqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIp\nkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTB\nODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESR\nlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWC\nYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXai\nSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqTEg4v03y3U3tUEjLPfpMBjrVMg\nr0gQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEw\nzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1Ek\nJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEg\nGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0o\nkhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRI\nEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5O\nFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVS\nJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhn\nJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJIS\nKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCM\nsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJ\niRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQI\nxtmJIimRIkEwzk4USYkUCYJxdqJISswoUttxuNJd9vfPXWbtXU3AOPtcGxbC3Fek9vvYnPbs\n1gxq72oCxtln67AMZhapPf5IkX7COPtsHZbBL4rUnq63v+mRgUwpkh3zitS/IB3eIl0p0n+3\nUHtXEzDOfpMCD/NXht8U6fCjHao090Wp9q4mYJx9pgxL4RdFGl/71eFd7V1NwDj7PBcWw6wi\ntRdXU6TrGGef58Ji+EWR2vOrKdIVjLPPc2Ex/LJIpxekFOkaxtnnubAYfnNoN5y1OxYrJxsu\nMM4+U4alkO/aQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhn\nJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJIS\nKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCM\nsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJ\niRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQI\nxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeK\npESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikS\nBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMT\nRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkU\nCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZ\niSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqRE\nigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj\n7ESRlEiRIBhnJ4qkxIOL9N8t1N7VBIyz36TAY61TIK9IEIyzE0VSIkWCYJydKJISKRIE4+xE\nkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJF\ngmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2\nokhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimR\nIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4\nO1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGU\nSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJg\nnJ0okhIpEgTj7ESRlEiRIBhnJ4qkxLRIm7bpAS6z9q4mYJwdKI4yk8JsmiZFegDG2e/3YzDw\n+ePqY5OJPsd3/jRDcZyfJ+zuf23/sZSLIrXN609TP4bau5qAcfb7/Tg+mb9fe2w60SehSN1j\ns4oEfSU6UHtXEzDOfr8fg4Qvzar42PHKpln/ylp0kZ6a7ex1mk3tXU3AOPv9fhyM7S4/npqm\n3exvfq2bp0vvB883+4m2ffW6i5e2Wb0epvt6GsY4jlYo0vZ5d7S4nU7Zv9U5LKWw0uc3v9r1\n1z3b4CZq72oCxtnv9+P4irST9r0/fttd2+5Pgz0VivTUT7Tpjgbfmpfhzf5r/3g3666Fo9EK\nReom3LfxbMpDkYalXF/paYacbHgExtnv9+Og4PPu+qp5+/7+3Ou4P4jbricF2L2CPO+vr7e7\n3rW7CXdt2R1Wfe7u+vr+2N3z3c/6vLvRjEe7fK+1v6fr7mbfv/Mph0O7YSnXV/p6hhTpPoyz\n3+/HQcGn7tbX+8u6L8HuWOnrsgBf311retufunMP7f6l5fl9mG4/6/ENy2G060Vadff2Cx5P\nORTpsJSrK31/7tnU3tUEjLPf78fg6lt3FLU+SN7fOylAOzr9vf+5f0l67w4Jdwdpq4P4J/kn\no31ProxeRc6mHJ1sSJGoGGe/34/j25/dK8tzs3p9/7papOkM3c/d61b/Run7c9W0H5MiTUeb\nDngq0vmUvyjSdrPaVXkDPXdXe1cTMM5+vx+TE3L703DXDu2mM3Q/dy9H7eGR18MAx0O702jX\ni7Rqzobc/r5IX8M3hFrkubvau5qAcfb7/RjOI2z271Wa5mM4xfCyf68/Pdkwvt7/XPXvrdrd\nfJ+nkw2bw4mDw2jXi7SfcHdIuZ5OOb9Iz83+9PfXujtjgqL2riZgnP1+P8ZfWtgcD7YKp79P\n1/uf783+fNsw30t/79fhrPZptOtF6s+Tny+3/7+dWaTxqyqM2ruagHH2+/0Yn0fYPbU36+7U\n9f5T1SsfyJ6uD/c0/XHc7givfTnc+7l7bXn+Go9W+Bzpq5vgezrla4pUCePsQHFu4ePaF4sI\n5NAOgnF2oDi3sL72VVcCOdkAwTg7UJx/s1N3XWnJk9s5/f0QjLMjzfkn7fB1CD75QBaCcXai\nSEqkSBCMsxNFUmJcpKbJl1YfhHF2oDjKpEgQjLMDxVEmh3YQjLMTRVIiRYJgnJ0okhKFbza0\nhd8DfAi1dzUB4+xAcZQZF6ltGsp7pP9bPsXstTXHc78fyLFhjAvzOuoR8s/b1bacQDE7T+ha\n3O8HcmwYhUM7KLUtJ1DMzhO6Fvf7gRwbxqQ4a+SXVQ/UtpxAMTtP6Frc7wdybBiTIrV5RXoI\nxew8oWtxvx/IsWFMivO53uD/QGRtywkUs/OErsX9fiDHhnHxHiln7R5BMTtP6Frc7wdybBgp\nEoRidp7QtbjfD+TYMGp8s6G25QSK2XlC1+J+P5Bjw0iRIBSz84Suxf1+3Dg2+LhpJjV+Q7a2\n5QSK2XlC1+J+P24buzn+kGDO32xo9wyX/e3+7rnLrG05gWJ2ntC1mGvDnG00nkq7SD/+FaF2\ndNEe/pvfoxRp0czWYcY2Gk+lXaQf/65dinQzxew8oWsxW4cZ22g81d8tUju+bMddmkltywkU\ns/OErsV8H27fRuOptIv006Hd8S3S93exSP/dQm3LCRSz84SuxU0K/OhkeewLc2WL9NPJhlGB\nhoO6oUpzX5RqW06gmJ0ndC1myjBrG42n0i7SP09/j4v0/cvDu9qWEyhm5wldi3kuzNtG46nE\ni/QvUqSbKGbnCV2LmULN2kbjqf5ukS4O7Y5n7VKkKcXsPKFrMc+FedvobLI/8M2G9cu1SdvR\n/ynSzxSz84SuxTwX5m2j+8eGMfebDePLQ5tysuGCYnae0LWYKcOsbXT/2DCmv2rO+PeRaltO\noJidJ3Qt7vcDOTaM6x/IbvP7SPdRzM4Tuhb3+4EcG8akME/DP6QO/eeaaltOoJidJ3Qt7vcD\nOTaM6SvP8/pzf2i3Rv7lhtqWEyhm5wldi/v9QI4No/ir5sCTi7UtJ1DMzhO6FiBp1EmRIBSz\n19YcD0gadfKr5hCK2WtrjocokhIpEoRi9tqa40H6cf/YMPI3GyAUs9fWHA/Sj/vHhjHnmw2P\ngudzNYrZa2uOB+nH/WPDmPM3Gx4Fz+dqFLPX1hwP0o/7x4Yx5282PAqez9UoZq+tOR6kH/eP\nDSNFglDMXltzPEg/7h8bRg7tIBSz19YcD9KP+8eGkZMNEIrZa2uOB+nH/WPDyOlvCMXstTXH\ng/Tj/rFh5ANZCMXstTXHg/RjMqHQb5rn35DFUMxeW3M8SD/Op1P6kw35N2QxFLPX1hwP0o+z\nyRrlV6T8G7KPoZi9tuZ4kH5MJhQuUv7py8dQzF5bczxIPyYTpkiLp5i9tuZ4kH5MJhQuEgWe\nz9UoZq+tOR6kH5MJU6TFU8xeW3M8SD8mE8oW6XPdNM852fAAitlra44H6cdkQtUiffbvjj7R\ny+T5XI1i9tqa40H6MZlQtUjPzWb/A/6ZLM/nahSz19YcD9KPyYSqRepO1W2bX/xjlvPg+VyN\nYvbamuNB+nH/2DAuikT44gXP52oUs9fWHA/Sj/vHhpEiQShmr605HqQf948NI0WCUMxeW3M8\nSD/uHxtGigShmL225niQftw/NozzIuH/XPEens/VKGavrTkepB/3jw0jRYJQzF5bczxAcZTJ\nV4QgFLPX1hwPUSQlUiQIxey1NcdDFEmJFAlCMXttzfEQRVIiRYJQzF5bczxEkZRIkSAUs9fW\nHA9RJCVSJAjF7LU1x0MUSYkUCUIxe23N8RBFUiJFglDMXltzPESRlEiRIBSz19YcD1EkJVIk\nCMXstTXHQxRJiRQJQjF7bc3xEEVSIkWCUMxeW3M8RJGUSJEgFLPX1hwPUSQlUiQIxey1NcdD\nFEmJFAlCMXttzfEQRVIiRYJQzF5bczxEkZRIkSAUs9fWHA9RJCVSJAjF7LU1x0MUSYkUCUIx\ne23N8RBFUiJFglDMXltzPESRlEiRIBSz19YcD1EkJVIkCMXstTXHQxRJiRQJQjF7bc3xEEVS\nIkWCUMxeW3M8RJGUSJEgFLPX1hwPUSQlUiQIxey1NcdDFEmJFAlCMXttzfEQRVIiRYJQzF5b\nczxEkZRIkSAUs9fWHA9RJCVSJAjF7LU1x0MUSYkUCUIxe23N8RBFUiJFglDMXltzPESRlEiR\nIBSz19YcD1EkJVIkCMXstTXHQxRJiRQJQjF7bc3xEEVSIkWCUMxeW3M8RJGUSJEgFLPX1hwP\nUSQlUiQIxey1NcdDFEmJFAlCMXttzfEQRVIiRYJQzF5bczxEkZRIkSAUs9fWHA9RJCVSJAjF\n7LU1x0MUSYkUCUIxe23N8RBFUuLBRfrvFmpbTqCYvbbmeG5S4LHWKZBXJAjF7LU1x0MUSYkU\nCUIxe23N8RBFUiJFglDMXltzPESRlEiRIBSz19YcD1EkJVIkCMXstTXHQxRJiRQJQjF7bc3x\nEEVSIkWCUMxeW3M8RJGUSJEgFLPX1hwPUSQlUiQIxey1NcdDFEmJFAlCMXttzfEQRVIiRYJQ\nzF5bczxEkZRIkSAUs9fWHA9RJCVSJAjF7LU1x0MUSYkUCUIxe23N8RBFUiJFglDMXltzPESR\nlEiRIBSz19YcD1EkJVIkCMXstTXHQxRJiRQJQjF7bc3xEEVSIkWCUMxeW3M8RJGUSJEgFLPX\n1hwPUSQlUiQIxey1NcdDFEmJFAlCMXttzfEQRVIiRYJQzF5bczxEkZRIkSAUs9fWHA9RJCVS\nJAjF7LU1x0MUSYkUCUIxe23N8RBFUiJFglDMXltzPESRlEiRIBSz19YcD1EkJVIkCMXstTXH\nQxRJiRQJQjF7bc3xEEVSIkWCUMxeW3M8RJGUSJEgFLPX1hwPUSQlUiQIxey1NcdDFEmJFAlC\nMXttzfEQRVIiRYJQzF5bczxEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJ\nFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG\n2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qk\nRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE\n4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNF\nUiJFgmCcnSosNKQAAAqDSURBVCiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2Yki\nKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoE\nwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISswpUrvjcNl2l/3dc5dZe1cTMM4+14aF\nMKNI7eFHe7w9ujWD2ruagHH22TosgxQJgnH22Tosg7nvkdpTc9qzWzOovasJGGef78Mi+E2R\nDm+RrhTpv1uovasJGGe/SYGH+SvDzCIdj+UOJxva4zmH26m9qwkYZ58pw1L4RZHGV351eFd7\nVxMwzj7PhcUwr0jt9FqKdB3j7PNcWAyzijT63Oh0NUW6gnH2eS4shlkfyJ4uzq+mSFOMs89z\nYTHM+Rzp9I2Gs+805GTDJcbZZ8qwFPJdOwjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMT\nRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkU\nCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZ\niSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqRE\nigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj\n7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VS\nIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmC\ncXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2Yki\nKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoE\nwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xE\nkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJF\ngmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2\nokhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlHhwkf67hdq7moBx9psUeKx1CuQVCYJxdqJI\nSqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJB\nMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtR\nJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiR\nIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJyd\nKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqk\nSBCMsxNFUiJFgmCcnSiSEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDO\nThRJiRQJgnF2okhKpEgQjLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQl\nUiQIxtmJIimRIkEwzk4USYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAY\nZyeKpESKBME4O1EkJVIkCMbZiSIpkSJBMM5OFEmJFAmCcXaiSEqkSBCMsxNFUiJFgmCcnSiS\nEikSBOPsRJGUSJEgGGcniqREigTBODtRJCVSJAjG2YkiKZEiQTDOThRJiRQJgnF2okhKpEgQ\njLMTRVIiRYJgnJ0okhIpEgTj7ESRlEiRIBhnJ4qkRIoEwTg7USQlUiQIxtmJIimRIkEwzk4U\nSYkUCYJxdqJISqRIEIyzE0VSIkWCYJydKJISKRIE4+xEkZRIkSAYZyeKpESKBME4O1EkJVIk\nCMbZiSIpkSJBMM5OFEmJ3xSp3dFf9jfnzl97VxMwzv4LoZbAL4rUDj/6/+b3yECmFMmOFAmC\ncfb5Qi2Cu4s0v0cGMqVIdjy4SP+FcAMPcVeKO4rUnWxoj+cchFngfrsZ5+xM7inS9x2Hd1Sc\nZXLOziRFWjjO2ZncV6ThrF2KpItzdiYp0sJxzs7knm82HNqk3iNrmZyzM6nxXTs6zjI5Z2eS\nIi0c5+xMUqSF45ydSYq0cJyzM0mRFo5zdiYp0sJxzs4kRVo4ztmZpEgLxzk7kxRp4ThnZ5Ii\nLRzn7ExSpIXjnJ1JirRwnLMzSZEWjnN2JinSwnHOziRFWjjO2ZmkSAvHOTuTFGnhOGdnkiIt\nHOfsTFKkheOcnUmKtHCcszNJkRaOc3YmKdLCcc7OJEVaOM7ZmaRIC8c5O5MUaeE4Z2eSIi0c\n5+xMLIoUApoUKYQHkCKF8ABSpBAeQIoUwgNIkUJ4AClSCA8gRQrhAaRIITyAFCmEB5AihfAA\nDIp0/EfYLTGOTmX5RWqPPxxxfg6hkiItmtY2OZsUaeH4JueSIi0c3+RcUqSF45ucS4q0cHyT\nc0mRFo5vci4p0sLxTc4lRVo4vsm5LL9I+WZDIGBQpBDwpEghPIAUKYQHkCKF8ABSpBAeQIoU\nwgNIkUJ4ACnSjTQ9zx/d9RmztJuv8V3nE1y9O/xBsgdvpDnwPrNI/SzHu84nuHp3+INkD97I\n4PpLs5o5y9dz025/HDMsgOzKGzlIv7/s//962h227e/6Wjer9+7x7fPu4G87neW5ednf+GzX\nkzm7CTa7F6zigOGvkL11I8dXpM2hSO3+qG13a9v2B3C7R7trq8ks35/Nen9j3TxP5tzf2vw4\nYPgrZG/dyOH9zvP3wfv19vu1affdWn9v1/v7upZtmtfjLKMrXUUmc+5u9VOXBgx/huytGzkU\n6en7eGg3XFvtr33117opn46zjK6cph9f2/QnIkoDhj9D9taNDF6/nY7EDveOr50dk02KdH36\n158mCH+G7K0bOZ5saGcX6WP/GnV9+te22V65ezx3+BNkb93I5Vm7w63pod3FLE/7l53rRdq9\nwj1d3J1Duz9I9taN9F5vN4dXl5P3m/1JufXxDNzb/uZolv3nSN/FIu1mfCsPGP4M2Vs3cvya\nwufU+9PZ6uHa53SW09eKLov0dXmsmNPff5DsrRsZvjj3/Pl98UZm//npW3/tuWnWH+ezrDbb\n45TX3gy9HD9eujJg+Ctkbz2I5tF/ZeThAwYkKdLddIdum+6TWtEBA54U6W42/SHc17+nrDVg\nwJMi3c/rqmmeH6n9wwcMcFKkEB5AihTCA0iRQngAKVIIDyBFCuEBpEghPIAUKYQHkCKF8ABS\npBAewP8DQ33DvRywAJsAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = binge, fill = bad_phys)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(\n",
    "    title = \"Proportion of Bad Physical Health by Binge Drinking Status\",\n",
    "    x = \"Binge Drinking\",\n",
    "    y = \"Proportion\",\n",
    "    fill = \"Bad Physical Health\"\n",
    "  ) +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8f34cd35-9d5b-4f19-aad6-f17afb4e034e",
   "metadata": {},
   "source": [
    "# Activity Limitation by Binge Drinking Status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "c9a885f9-b500-4d86-8e59-a30b8c6d50d8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\nt6inH3/4Rs9xhcfjj7d/lNM3TI8XXhOp2zO8unzP22p4IGfqaffvwq6PJ/vD678Wk0inn5Bp\nmv3n+sdXdJfcDY4vnV89fIDBtcPL2+HeeHfmabPm+mzxzeA9He/bX/XR7eQMO/+kSLu7P21/\nopfuRdqnn0jTf0Rovzs68fj3F49P9x9/un/pT7+t2/Hhsd1979ajkC6L9DT48NDl5Xc837eH\nJaee9sfL5tvuI0cv3UeEfrVHiT/Y9+P3lZ/C78F/5fHftTtO4uV/AYh0xmvbRD9fedvj92+k\nvqy++odWssv/HhDphJPXGD/+8fevYb76xyizy/8eEOmEu/Bb8Dc//nP3R4P/iH4c9fK/hh89\n1AD/CogEMAOIBDADiAQwA4gEMAOIBDADiAQwA4gEMAOIBDADCxLpv/QP8CMgBQ2ItDBIQQMi\nLQxS0IBIC4MUNCDSwiAFDYi0MEhBAyItDFLQgEgLgxQ0INLCIAUNiLQwSEEDIi0MUtCASAuD\nFDQg0sIgBQ2ItDBIQQMiLQxS0IBIC4MUNCDSwiAFDYi0MEhBAyItDFLQgEgLgxQ0INLCIAUN\niLQwSEEDIi0MUtCASAuDFDQg0sIgBQ2ItDBIQQMiLQxS0IBIC4MUNCDSwiAFDZ8Tqe2/bhh/\nH1z582GEtpCChk+JtPNm92Xwvf34dzxihDpIQcNnRGo/EOnXQAoabti1uyzSP+MRI9RBChpm\nFum/z1GXAyHUayGMmHe0vXxDpO6lU3s45nAL6WKNEEK9FsKv4TsifXx59y5drBFCqIh0AJG+\nDCFURDowJVL7gUh/gRAqIh1ApC9DCBWRDlz+ZMPh4psfNV2sEUKoiCQjXawRQqiIJCNdrBFC\nqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12s\nEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQj\nXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiI\nJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFC\nqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12s\nEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQj\nXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiI\nJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFC\nqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12s\nEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQj\nXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiI\nJCNdrBFCqIgkI12sEUKoiHQ7/32OdLFGCKFeC2HEvLPohS2SGEKobJFkpIs1QggVkWSkizVC\nCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSL\nNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFk\npIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggV\nkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVC\nCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSL\nNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFk\npIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggV\nkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVC\nCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSL\nNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFk\npIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkWSkizVCCBWRZKSLNUIIFZFkpIs1QggV\nkWSkizVCCBWRZKSLNUIIFZFkpIs1QggVkca0HfsT3ff+8tsfNV2sEUKoiHSB9uNgTjs6dxPp\nYo0QQkWkc9rDF0T6HIRQEemcoTntwaWbSRdrhBAqIp3Rb5D2L5EuiPTf50gXa4QQ6rUQRsw2\n1QG+ItL+S7tT6faNUrpYI4RQ2SKd0Z6e+uLuXbpYI4RQEemU9uwkIv0NQqiIdMrgfaPjSUS6\nCiFURDplZM/gJCJNQwgVkU7Z69OOPtPAwYZrEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJF\nJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0Q\nQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGeli\njRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ\n6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJF\nJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0Q\nQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGeli\njRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ\n6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJF\nJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0Q\nQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGeli\njRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ6WKNEEJFJBnpYo0QQkUkGelijRBCRSQZ\n6WKNEEJFpNv573OkizVCCPVaCCPmnUUvbJHEEEJliyQjXawRQqiIJCNdrBFCqIgkI12sEUKo\niCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawR\nQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNd\nrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgk\nI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKo\niCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawR\nQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiIJCNdrBFCqIgkI12sEUKoiCQjXawRQqiLFGnd\nNj3SR00Xa4QQ6hJFWjcNIs0KIdTZRDoby6e2u3R0k92lp/c8P3XlLufr/v1nG59tm6db7v1V\n0sUaIYQ6l0jPG5GeR5d0s34m0gUD/ibSyaXn6/6VkxuLt0R70sUaIYQ6l0gPzX3zMLrk8rhe\nFekyl0S6jZN73DfvNy/xBdLFGiGEOpdITfO+m/C3+6Zdd7t6TX/xXXfxXfO6uWB76e6S/RUn\nW6TN//fN/cfbXXP/3p3bvZZ5uW9G624f6aFpHt66++0edOqHG599a1dv8zzrq6SLNUIIdSaR\nnjebo4du3+69OyJ2fxz4+2Y7tW8bbfZWrLsb/mke+/ueirQxpvlzt/nyMBDpuT86sB6I1D9S\n2+nW9ldOcLZrx8GGeSGEOpNIWzeeu3279ebry2Gjsfny0g349gb7S183nm13sF77+56K9LBx\nbHOfP/ubd9ffNX+2dxysu1ly9fGxarqt1Or946k5P46xX/fkLCLNDCHUmURqD0cA7vYvQA4D\nf7cd8LYdWNE5dJj7U5Heuj3C4833u4zPj6uRSHfbW263dP19rrx44g1ZMYRQ5xHpZfcb/nkw\nzoeBf2peNjd4HFix3SQ9H/bEzl4jDb4cRVrttyGj605PXQaRxBBCnUek/VucD5dEet9cvB5u\nYrqNyfpwtPxTIj00d0/PbzOJ9L7evAS7W4uP3aWLNUIIdR6R2m5/7n27t3a+a7ex6K17VXSc\n+c3mqL3w7tEVkbov75O7duN1Tjk7atdr32qP3aWLNUIIdRaRXnZvIT1sduLWm1228UGB7dnN\n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",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = binge, fill = activity_limit)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(\n",
    "    title = \"Proportion of Activity Limitation by Binge Drinking Status\",\n",
    "    x = \"Binge Drinking\",\n",
    "    y = \"Proportion\",\n",
    "    fill = \"Activity Limitation\"\n",
    "  ) +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd5595bb-7365-4ce0-bb25-ab5b4a8e0c57",
   "metadata": {},
   "source": [
    "# Self-Rated Health by Binge Drinking Status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "a87ca8c1-09fe-4ff9-ab89-55130f7a045a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAOVBMVEUAAAAAv8RNTU1oaGh8\nfHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3////ccKm3AAAACXBI\nWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO2di3qiSqNEOWhi7vH3/R/2iHgBtbOD01WlYa1v\n78QLtFjUkhadmWYDAP9Mk94AgL8AIgFUAJEAKoBIABVAJIAKIBJABRAJoAKIBFABRAKoACIB\nVKC6SM2e5eutI6yf+3Emr9Y0i9PV9+d2e321vty+i2UPm3xl6X5brjHYvtPFHze6u7Pw3H5+\nsofNe/nFsqWV2+fPnx7wl0/hwDDcy4jKof1hZCJtVbp5hNPPCTyNHvLpsBXv10YfL3va5Pbc\npPJW3CZS4bn9SqT9Jt8m0pbVDw84TaRRuJcrTN51fwGBSP3vj7a58Zh0435omsFr7mvTdjv5\n63V063H08a3HTV6OyvbztlhF2v36vNy8X7BfuUvi5T+X+h3jcBFph0ykzceth6SbRRpcaZuv\n/sJr83xlsfFDHK99Nu2vt8Uv0ubrYvN+weDJNRcz119uwBnjcBFph06kfXHWi+Zpe+VzO6ve\nz9O3t7+2zXI/5xrd0S28mzOcXoZH663aZjGcq53ubfarXd2K3cFm/4jb62fLXoqwWmyX/jiM\nOl5/+wZh2bQvP4o0XPo41vGRjwl8DEd46SNZH967rU9v4o7jn14ERll0G/R68UQvNm7VHZL2\nO+R8kN31r3bx8h/DXz7fY0Tnoe2X2v36fO7epZ2e7x9ELtLTbnL+PppUv5zm7OM7uoVH+2F8\n9/LsXc/g3jM5zmZBb6d3CT+JtD8iteNRx+tv+g18/kGk4dKnsUYiPe8ufZzWWx1WWe2f39tp\nJnYYv3dr3/RTFvs0Lzb0fOM+u1e0/Q45H2R3ve3mED8OfyXcQ0QXoQ1E+hjsxb+KTqT3frcs\nu/nEdlrxst6st3vjq7utfdve3XYT7LM7dgsPpj/n631s1k+nGePo3vGE4qs7Ur19HhfsXiq3\n7zHej0W5tsnbt3VdQ152FX7ZPU5/13D97YP2W18Uabj0+ViH57Z9kzF8JoNIvvZHouVh/jR8\nj3Q8eAyyGG7Q8KEvNm6/AaeMB4N015enZ1wY/mq4/R2XoQ1EWnRDbCUfnFT9c8hE2ka/q+3u\nVXe1fw177n43+4q0q4s7Pk4j7H6e3d3VYz2cqwzuPZPjq58iPr33C/YnavuX5ItlmyO7Zi/6\npQcLDtdf9edQ1m1zZf39Rp+WPh/r8NzOnsmurF1pV90psc/NaGZ3Gv9lMNZxhP0GvfWXTw99\ntj+OG/BxbZBuLte0X/8x/NVw+zsuQxuINIc3TQKRDgzavdi7s3u5PbwQPy3O7xjMqvuf5bsv\nRr3YW+v3l+XejcWg5z+ItDieZvzcrbs5teS0/r4x275fecr7jR5cORvromOHEfpBuyeym4EN\nZ3an8Z8+N+MnMNigdX959NDjBxl2+nyQpnndy/zT8FfDPU2Mx6ENxnjqjmBfmz+NSqR2+HJ1\nCnu30/avtYvm/I4Lkcp3X4x6/WVv+977Zdj04bLHxu1+rNvjfOi1Hd91uf6mmwgNnvLo0siq\ns7GKIg1+7w5Jg5nd4d71dqyPaw4MI/pRpPYHkZr9R9Q/DV8ItxTacb2vdvw69RcRiHTl2lWR\nljqRTpfXg/acLXu24z8Ob/63r83L1dvXZSdGQ1/t6sWGnI/1G5G6Q9JwZjd4zR+cDTiPZXR5\nc2Xl7RN8Gj/0aJD2vRm+Bbs6/PmlQbjF0Ppf78/HqekfxSPSeIq2n8ALp3aDd9vdze3g89cr\nR6/9tZf9FxsWo7cR3cWL9cdTnbOODZc+H6so0npwy7JZD2d2Z+OfN30492rPP34errzq5m5F\nkb629y+u3HM5tTsLt7/jMrTzJ/n5fMvHYA+DR6TV/mPR/UmDftf0JxtGdwzW2f0s330x6uiB\nTyeI3roX8ed+wYsX9LNNXjSDb8K9DxYcrt+fC+hega885d2li0cbjFUUaTft2X+G/d68LAYz\nu+ERqd1cNH1/NmC3QcOHvrpyWaSdK1dmjsPhr4Y7fErD0Prd/H41pz+IR6TtIX/Vn6j+7KcR\nu7N664s79usczx5dv/sw+Oje8QMvm/atG37V7E9Zb1X7bP/j9PdnP9Ciq87+fG+/LcP1X3dn\nqt+uvw3ZT81OS4/HGj238Xrd0eKt3U8uF+3oTPFhuf70/HnT+/PT/QYNH/psD7z2sv4g0taZ\np5+Hvxpu/5QuQ1s2T+v9Lf3p79XgXOLfwyPS5eeu+8tnd+yWXQze1F+5e/AAw3vHD/y1PLzr\nfhkseDxwXd/I7Qt619/Xw6ofh20Zrr/pR34pizRcejhWX6nTcxutN/iMejfA8O3E6RTC4IOe\n0wgvgxMMww09X3m1OVvxXKTdzPDH4a+F2z+ly9D6T2FXp4v96fW/ikmk86/6NM3ha/3jO3a3\nLAYnCC7vHj7A4N7zicP70+6b/vtH+eq+8fJ6XKywkZv+i7av3aAf790LaL8tw/W3r87/+RWh\nwdKDsXav74vzU2eHSy+D7wytm+HM7ujC09Xz07vv8DRPH/3l4YYOVz4k8aNIr4MvD10f/kq4\n+4guQ/tYHHP62H1F6C97lPiDfX96qlyF1xu+A7DWTpzEwz8+iHR/fLbNhO939h+kfixv/VMr\n2eH/DIh0b5y9x/lPDu9hbv1zlNnh/wyIdG8spn4F4H33533fRJujHv6vQKkBKoBIABVAJIAK\nIBJABRAJoAKIBFABRAKoACIBVACRACowG5G+0xsQhwSUINJsIAEliDQbSEAJIs0GElCCSLOB\nBJQg0mwgASWINBtIQAkizQYSUIJIs4EElCDSbCABJYg0G0hACSLNBhJQgkizgQSUINJsIAEl\niDQbSEAJIs0GElCCSLOBBJQg0mwgASWINBtIQAkizQYSUIJIs4EElCDSbCABJYg0G0hACSLN\nBhJQgkizgQSUINJsIAEliDQbSEAJIs0GElCCSLOBBJT8TqS2/7ll/Htw571DjUhAya9E2nuz\n/zH43W4exSNqRAJSfiNSu0GkPwAJKJkwtbsu0oN4RI1IQEplkb5/xf9mAgn8rg9/QfF/EGn3\n1qk9nnOYQHr3uiCBqc14XP5FpM2t07v07nVBAhOL8cAgkhASmFiMB+bfRGo3iPQDJDCxGA8M\nIgkhgYnFeGD+5ZsNx5unPmh697ogganNeFwi37VL714XJODrVBpEEkICvk6lQSQhJODrVBpE\nEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQh\nJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkIC\nvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODr\nVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6l\nQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpE\nEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQh\nJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkIC\nvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODr\nVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6l\nQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpEEkICvk6lQSQhJODrVBpE\nEkICvk6lQSQhJODrVBpEEkICvk6lqSzS969I714XJPC7PnzXLWEEjkhCSMDXqTSIJIQEfJ1K\ng0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSI\nJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hC\nSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQE\nfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDX\nqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1K\ng0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSI\nJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hC\nSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQE\nfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDX\nqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1K\ng0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1Kg0hCSMDXqTSIJIQEfJ1KM0Gkdsfhwu53\n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\noXGSbKhDmgAAAABJRU5ErkJggg==",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ggplot(brfss_merged2, aes(x = binge, fill = srh)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  scale_y_continuous(labels = scales::percent) +\n",
    "  labs(\n",
    "    title = \"Proportion of Self-Rated Health by Binge Drinking Status\",\n",
    "    x = \"Binge Drinking\",\n",
    "    y = \"Proportion\",\n",
    "    fill = \"Self-Rated Health\"\n",
    "  ) +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a276ab8-071f-4162-b50e-dded22cffedf",
   "metadata": {},
   "source": [
    "# STEP 7: Set Reference Levels for Categorical Variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "17f4d63e-7bb3-4863-aa2b-cf4d633d5acf",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 7A. Demographics\n",
    "\n",
    "brfss_merged2$race     <- relevel(factor(brfss_merged2$race), ref = \"Hispanic\")\n",
    "brfss_merged2$edu      <- relevel(factor(brfss_merged2$edu), ref = \"College Graduate\")\n",
    "brfss_merged2$inc      <- relevel(factor(brfss_merged2$inc), ref = \"$75k+\")\n",
    "brfss_merged2$marital  <- relevel(factor(brfss_merged2$marital), ref = \"Married\")\n",
    "brfss_merged2$ins      <- relevel(factor(brfss_merged2$ins), ref = \"1\")  # Insured\n",
    "brfss_merged2$emp      <- relevel(factor(brfss_merged2$emp), ref = \"Employed\")\n",
    "brfss_merged2$age      <- relevel(factor(brfss_merged2$age), ref = \"18-24\")\n",
    "brfss_merged2$sex      <- relevel(factor(brfss_merged2$sex), ref = \"0\")  # 0 = Female\n",
    "\n",
    "# 7B. Health Behaviors\n",
    "\n",
    "brfss_merged2$binge    <- relevel(factor(brfss_merged2$binge), ref = \"0\")  # Non-binge drinker\n",
    "brfss_merged2$fmd      <- relevel(factor(brfss_merged2$fmd), ref = \"0\")\n",
    "brfss_merged2$smoke    <- relevel(factor(brfss_merged2$smoke), ref = \"Non-Smoker\")\n",
    "brfss_merged2$heavy    <- relevel(factor(brfss_merged2$heavy), ref = \"No\")\n",
    "brfss_merged2$active   <- relevel(factor(brfss_merged2$active), ref = \"Yes\")\n",
    "brfss_merged2$bmi      <- relevel(factor(brfss_merged2$bmi), ref = \"Normal Weight\")\n",
    "brfss_merged2$home     <- relevel(factor(brfss_merged2$home), ref = \"Own\")\n",
    "\n",
    "\n",
    "# 7C. Chronic Conditions (Ref = No)\n",
    "\n",
    "brfss_merged2$asthma   <- relevel(factor(brfss_merged2$asthma), ref = \"No\")\n",
    "brfss_merged2$arth     <- relevel(factor(brfss_merged2$arth), ref = \"No\")\n",
    "brfss_merged2$copd     <- relevel(factor(brfss_merged2$copd), ref = \"No\")\n",
    "brfss_merged2$chd      <- relevel(factor(brfss_merged2$chd), ref = \"No\")\n",
    "brfss_merged2$diab     <- relevel(factor(brfss_merged2$diab), ref = \"No\")\n",
    "brfss_merged2$kidney   <- relevel(factor(brfss_merged2$kidney), ref = \"No\")\n",
    "brfss_merged2$stroke   <- relevel(factor(brfss_merged2$stroke), ref = \"No\")\n",
    "\n",
    "\n",
    "# 7D. Health Outcomes & Disability\n",
    "\n",
    "brfss_merged2$disab           <- relevel(factor(brfss_merged2$disab), ref = \"No\")\n",
    "brfss_merged2$MCC             <- relevel(factor(brfss_merged2$MCC), ref = \"No\")\n",
    "brfss_merged2$bad_phys        <- relevel(factor(brfss_merged2$bad_phys), ref = \"0\")\n",
    "brfss_merged2$activity_limit  <- relevel(factor(brfss_merged2$activity_limit), ref = \"0\")\n",
    "brfss_merged2$srh             <- relevel(factor(brfss_merged2$srh), ref = \"0\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "512217a8-8143-4226-8209-7bef874b79f5",
   "metadata": {},
   "source": [
    "# Create Continuous Age (Midpoint) and Age Squared for Adjustment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "632dc618-e881-4269-928a-a423e21a60d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# This transformation helps account for non-linear effects of age in regression models.\n",
    "\n",
    "brfss_merged2 <- brfss_merged2 %>%\n",
    "  mutate(\n",
    "    age_mid = case_when(\n",
    "      age == \"18-24\" ~ 21,\n",
    "      age == \"25-29\" ~ 27,\n",
    "      age == \"30-39\" ~ 35,\n",
    "      age == \"40-49\" ~ 45,\n",
    "      age == \"50-59\" ~ 55,\n",
    "      age == \"60-64\" ~ 62,\n",
    "      age == \"65+\"   ~ 75,\n",
    "      TRUE ~ NA_real_\n",
    "    ),\n",
    "    age_sq = age_mid^2\n",
    "  )\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "2479f447-b052-40ee-ab54-5a8e8cf57d87",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Without creating AgeMid, I wouldn't be able to compute AgeSq. \n",
    "#It’s not possible to square a string-based age group directly. \n",
    "#I’ve kept AgeMid in the dataset only as a computational step for AgeSq and can drop it from the final model if it’s not needed as a separate variable."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52689cf3-9870-4657-8bf4-296007f3bce8",
   "metadata": {},
   "source": [
    "# STEP 8: Generate Cramér's V Correlation Plot for Categorical Predictors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "3fd551eb-995f-44ea-9c0d-d5d315a87887",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "corrplot 0.95 loaded\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAACZ1BMVEX9/v0AAABmJQZoJQVq\nJgVsJgVuJwVwKAVyKAV0KQV2KQV4KgV6KwV8KwV+LAWALASCLQSELgSGLgSILwSKLwSMMASP\nMQSRMQSTMgSVMgSXMwSZNAObNQOdNgOfNwOhNwOjOAOlOQOnOgOpOwOrPAOtPQOvPgOxPwOz\nQAK1QQK4QgK6QwK8RAK+RQK+vr7ARgLCRwLESALGSQLISgLKSwLMTALNTQLOTwPQUATRUgXS\nUwXUVQbVVgfWVwfXWQjZWgnaXArbXQrdXwveYAzfYg3gYw3iZA7jZg/kZw/maRDnahHobBLp\nbRLrbxPscBTschXtcxbudRbvdxfveBjwehnxfBryfRvyfxvzgRz0gh30hB71hh/2hyD3iSD3\niiH4jCL5jiP6jyT6kSX7kyb8lCb8lif9mCj9/v3+mSn+myv+nSz+ny7+oC/+ojH+pDL+pTT+\npzX+qTf+qzn+rDr+rjz+sD3+sj/+s0D+tUL+t0P+uEX+ukb+vEj+vkn+v0v+wUz+w07+xFD+\nxlP+x1X+yFj+yVv+y13+zGD+zWP+zmX+z2j+0Wv+0m3+03D+1HP+1nX+13j+2Hv+2X3+24D+\n3IP+3YX+3oj+4Iv+4Y3+4pD+45L+5JT+5ZX+5pf+5pn+55r+6Jz+6Z7+6qD+6qH+66P+7KX+\n7af+7qj+7qr+76z+8K3+8a/+8rH+8rP+87T+9Lb+9bj+9rr+9rv/973/97//98D/+ML/+MT/\n+MX/+cf/+cj/+cr/+sz/+s3/+s//+9H/+9L/+9T//Nb//Nf//Nn//dv//dz//d7//uD//uH/\n/uP//+X///9o8bbIAAAAzXRSTlP/////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////\n////////////////////AP//////////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////\n////////////GwxBvwAAAAlwSFlzAAASdAAAEnQB3mYfeAAAIABJREFUeJztnYeD1MYX3yOn\n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\nTkSuQmCC",
      "text/plain": [
       "Plot with title \"\""
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(rcompanion)  # For cramerV\n",
    "library(corrplot)    # For correlation matrix visualization\n",
    "\n",
    "# 9A. Prepare Predictor Variables\n",
    "\n",
    "# Exclude outcome variables and design-specific columns\n",
    "categorical_vars <- setdiff(\n",
    "  names(brfss_merged2),\n",
    "  grep(\"srh|bad_phys|activity_limit|weight|strata|age_sq|psu\", names(brfss_merged2), value = TRUE)\n",
    ")\n",
    "# Extract only predictor variables\n",
    "predictor_data <- brfss_merged2[, categorical_vars]\n",
    "\n",
    "\n",
    "# 9B. Define Cramér’s V Matrix Function\n",
    "\n",
    "cramers_v_matrix <- function(df) {\n",
    "  vars <- names(df)\n",
    "  result <- matrix(NA, nrow = length(vars), ncol = length(vars),\n",
    "                   dimnames = list(vars, vars))\n",
    "  for (i in vars) {\n",
    "    for (j in vars) {\n",
    "      if (i != j) {\n",
    "        tbl <- table(df[[i]], df[[j]])\n",
    "        result[i, j] <- cramerV(tbl, bias.correct = TRUE)\n",
    "      } else {\n",
    "        result[i, j] <- 1  # perfect self-association\n",
    "      }\n",
    "    }\n",
    "  }\n",
    "  return(result)\n",
    "}\n",
    "\n",
    "\n",
    "# 9C. Compute and Visualize the Matrix\n",
    "\n",
    "\n",
    "# Compute the Cramér’s V matrix\n",
    "cramer_v_mat <- cramers_v_matrix(predictor_data)\n",
    "\n",
    "# Optional: Export plot to JPG file\n",
    "# jpeg(\"cramers_v_plot.jpg\", width = 2000, height = 2000, res = 300)\n",
    "\n",
    "# Visualize the matrix\n",
    "corrplot(\n",
    "  cramer_v_mat,\n",
    "  method = \"number\", is.corr = FALSE,\n",
    "  type = \"upper\",\n",
    "  tl.cex = 0.5,        # Text label size\n",
    "  tl.col = \"black\",    # Text label color\n",
    "  cl.cex = 0.6,        # Legend size\n",
    "  number.cex = 0.5,    # Number font size\n",
    "  number.digits = 2,   # Show 2 decimals\n",
    "  mar = c(1, 1, 1, 1)  # Margins\n",
    ")\n",
    "\n",
    "# dev.off()  # Uncomment to save if jpeg() is active\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "4fe113f7-e666-41fb-9741-59c963ef72e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#The actual PSU codes can change or increase over time, especially if the BRFSS design is updated.\n",
    "\n",
    "#PSU IDs are not “random” numbers — they often encode survey structure and year, even implicitly.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e33920f6-f605-4599-b3c2-26b566d92bea",
   "metadata": {},
   "source": [
    "#corrplot(cramer_v_mat, method = \"number\", order = \"hclust\", is.corr = FALSE)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2796791-91a2-4d1b-8da6-3fa326f27d97",
   "metadata": {},
   "source": [
    "### Because of the presence of MCC and other chronic condition variables together, there might be a possibility for collinearity. So inorder to make sure there are no issues with collinearity, we are constructing correlation plots and computing VIF scores"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a2fb342-c8e4-4b18-9061-772f90940e50",
   "metadata": {},
   "source": [
    "# STEP 9: Compute Variance Inflation Factors (VIF) "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9b0a247e-703f-4ba0-beb5-d0ed5bcfe8f9",
   "metadata": {},
   "source": [
    "# Step 9A : Compute Variance Inflation Factors (VIF) for Self-Rated Health Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "c633ed0c-4587-4eeb-84b3-96fa119db337",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'car' was built under R version 4.5.1\"\n",
      "Loading required package: carData\n",
      "\n",
      "\n",
      "Attaching package: 'car'\n",
      "\n",
      "\n",
      "The following object is masked from 'package:dplyr':\n",
      "\n",
      "    recode\n",
      "\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            GVIF Df GVIF^(1/(2*Df))\n",
      "binge   1.438383  1        1.199326\n",
      "race    1.180912  3        1.028102\n",
      "age_sq  1.727896  1        1.314495\n",
      "sex     1.122483  1        1.059473\n",
      "inc     1.879813  5        1.065152\n",
      "year    1.099244  6        1.007916\n",
      "edu     1.344172  3        1.050532\n",
      "emp     1.445631  2        1.096514\n",
      "marital 1.698648  3        1.092322\n",
      "ins     1.137114  1        1.066355\n",
      "home    1.422777  2        1.092155\n",
      "smoke   1.156350  1        1.075337\n",
      "heavy   1.351947  1        1.162733\n",
      "active  1.066540  1        1.032734\n",
      "bmi     1.137759  2        1.032791\n",
      "asthma  1.513896  1        1.230405\n",
      "arth    1.688390  1        1.299381\n",
      "copd    1.485312  1        1.218734\n",
      "chd     1.184284  1        1.088248\n",
      "diab    1.379237  1        1.174409\n",
      "kidney  1.130307  1        1.063159\n",
      "stroke  1.172087  1        1.082630\n",
      "disab   1.224051  1        1.106368\n",
      "MCC     3.438102  1        1.854212\n"
     ]
    }
   ],
   "source": [
    "library(car)  # Required for vif()\n",
    "\n",
    "# NOTE:\n",
    "# We use glm() instead of svyglm() because `vif()` only works with standard GLMs\n",
    "\n",
    "# Logistic regression model (non-survey) for VIF estimation\n",
    "model1 <- glm(\n",
    "  srh ~ binge + race + age_sq + sex + inc + year + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke +\n",
    "    disab + MCC,\n",
    "  data = brfss_merged2,\n",
    "  family = \"binomial\"\n",
    ")\n",
    "\n",
    "# Compute VIFs\n",
    "vif_values <- vif(model1)\n",
    "\n",
    "# View VIF results\n",
    "print(vif_values)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "45ac188e-6105-40f6-942c-14abac86ba2a",
   "metadata": {},
   "source": [
    "# Step 9B: Compute Variance Inflation Factors (VIF) for Bad Physical Health Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "5978d395-6bf5-4946-91cf-a310ecd26f42",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            GVIF Df GVIF^(1/(2*Df))\n",
      "binge   1.419342  1        1.191361\n",
      "race    1.189680  3        1.029370\n",
      "age_sq  1.734475  1        1.316995\n",
      "sex     1.125498  1        1.060895\n",
      "inc     1.944623  5        1.068768\n",
      "year    1.095001  6        1.007592\n",
      "edu     1.364084  3        1.053110\n",
      "emp     1.443264  2        1.096065\n",
      "marital 1.720165  3        1.094616\n",
      "ins     1.131550  1        1.063743\n",
      "home    1.435049  2        1.094502\n",
      "smoke   1.160789  1        1.077399\n",
      "heavy   1.339338  1        1.157298\n",
      "active  1.080364  1        1.039406\n",
      "bmi     1.144735  2        1.034371\n",
      "asthma  1.457952  1        1.207457\n",
      "arth    1.651264  1        1.285015\n",
      "copd    1.496918  1        1.223486\n",
      "chd     1.205257  1        1.097842\n",
      "diab    1.392029  1        1.179843\n",
      "kidney  1.113518  1        1.055234\n",
      "stroke  1.181880  1        1.087143\n",
      "disab   1.255539  1        1.120508\n",
      "MCC     3.335583  1        1.826358\n"
     ]
    }
   ],
   "source": [
    "# Logistic regression model (non-survey) for checking multicollinearity\n",
    "# Outcome: bad_phys (≥14 days of poor physical health in past 30 days)\n",
    "\n",
    "model2 <- glm(\n",
    "  bad_phys ~ binge + race + age_sq + sex + inc + year +\n",
    "    edu + emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC,\n",
    "  data = brfss_merged2,\n",
    "  family = \"binomial\"\n",
    ")\n",
    "\n",
    "# Compute VIF\n",
    "vif_values <- vif(model2)\n",
    "\n",
    "# View results\n",
    "print(vif_values)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d2c2d57a-45fa-4093-a0ab-d8f30272f938",
   "metadata": {},
   "source": [
    "# Step 9C : Compute Variance Inflation Factors (VIF) for Activity Limitation Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "a3f8b371-0eb5-46f7-a549-d6dd3013d98d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "            GVIF Df GVIF^(1/(2*Df))\n",
      "binge   1.433485  1        1.197282\n",
      "race    1.189695  3        1.029373\n",
      "age_sq  1.754323  1        1.324509\n",
      "sex     1.130073  1        1.063049\n",
      "inc     1.866215  5        1.064379\n",
      "year    1.097554  6        1.007787\n",
      "edu     1.340805  3        1.050093\n",
      "emp     1.417591  2        1.091158\n",
      "marital 1.688508  3        1.091232\n",
      "ins     1.126516  1        1.061374\n",
      "home    1.424487  2        1.092483\n",
      "smoke   1.162002  1        1.077962\n",
      "heavy   1.356404  1        1.164648\n",
      "active  1.080443  1        1.039444\n",
      "bmi     1.148698  2        1.035265\n",
      "asthma  1.443784  1        1.201576\n",
      "arth    1.642251  1        1.281503\n",
      "copd    1.512166  1        1.229701\n",
      "chd     1.216678  1        1.103031\n",
      "diab    1.408819  1        1.186937\n",
      "kidney  1.107365  1        1.052314\n",
      "stroke  1.170923  1        1.082092\n",
      "disab   1.220998  1        1.104988\n",
      "MCC     3.277815  1        1.810474\n"
     ]
    }
   ],
   "source": [
    "# Logistic regression model (non-survey) for VIF estimation\n",
    "# Outcome: activity_limit (≥14 days of activity limitation due to health)\n",
    "\n",
    "model3 <- glm(\n",
    "  activity_limit ~ binge + race + age_sq + sex + inc + year +\n",
    "    edu + emp + marital + ins + home +\n",
    "    smoke + heavy + active + bmi + asthma +\n",
    "    arth + copd + chd + diab + kidney + stroke +\n",
    "    disab + MCC,\n",
    "  data = brfss_merged2,\n",
    "  family = \"binomial\"\n",
    ")\n",
    "\n",
    "# Compute VIF\n",
    "vif_values <- vif(model3)\n",
    "\n",
    "# View VIF results\n",
    "print(vif_values)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "119eec44-4670-468e-8cc9-7264bd130905",
   "metadata": {},
   "source": [
    "# chi sq table 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "3addcd44-72ab-4802-acbd-4826fee156a6",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Installing package into 'C:/Users/chava/AppData/Local/R/win-library/4.5'\n",
      "(as 'lib' is unspecified)\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "package 'cardx' successfully unpacked and MD5 sums checked\n",
      "\n",
      "The downloaded binary packages are in\n",
      "\tC:\\Users\\chava\\AppData\\Local\\Temp\\RtmpWkZV61\\downloaded_packages\n"
     ]
    }
   ],
   "source": [
    "install.packages(\"cardx\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "id": "e7441c05-5bfa-4e43-a520-2c7cbda653d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Install if needed\n",
    "# install.packages(\"gtsummary\")\n",
    "\n",
    "#library(gtsummary)\n",
    "\n",
    "# Create a chi-squared-style table comparing binge and other variables with Self-Rated Health\n",
    "#tbl_srh <- brfss_merged2 %>%\n",
    "  #select(srh, binge, race, sex, age, inc, edu, emp, marital, ins, home,\n",
    "         #smoke, heavy, active, bmi, asthma, arth, copd, chd, diab, kidney, stroke, disab, MCC) %>%\n",
    "  #tbl_summary(by = srh, percent = \"column\") %>%\n",
    "  #add_p(test = everything() ~ \"chisq.test\") %>%\n",
    "  #bold_labels()\n",
    "\n",
    "# View table\n",
    "#tbl_srh\n",
    "\n",
    "#library(gt)\n",
    "#library(officer)\n",
    "\n",
    "#as_gt(tbl_srh) %>%\n",
    "  #gtsave(\"C:/Users/chava/Downloads/Recent_Research_Activity/Outputoutput/chi_squared_srh_table.html\")\n",
    "\n",
    "#as_flex_table(tbl_srh) %>%\n",
    "  #save_as_docx(path = \"C:/Users/chava/Downloads/Recent_Research_Activity/Output/chi_squared_srh_table.docx\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a49c50c-fb35-4e29-aea1-74a0d3a865d2",
   "metadata": {},
   "source": [
    "# STEP 10: Define Survey Design Object for BRFSS Using strata × year"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "aab8cae0-bf04-438e-8250-ac841af362bf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'survey' was built under R version 4.5.1\"\n",
      "Loading required package: grid\n",
      "\n",
      "Loading required package: Matrix\n",
      "\n",
      "Loading required package: survival\n",
      "\n",
      "Warning message:\n",
      "\"package 'survival' was built under R version 4.5.1\"\n",
      "\n",
      "Attaching package: 'survey'\n",
      "\n",
      "\n",
      "The following object is masked from 'package:graphics':\n",
      "\n",
      "    dotchart\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "library(survey)  # Required for survey-weighted analyses\n",
    "\n",
    "\n",
    "# 10A. Combine STRATA and YEAR into single variable\n",
    "\n",
    "\n",
    "# This allows for proper stratification across pooled years\n",
    "brfss_merged2 <- brfss_merged2 %>%\n",
    "  mutate(strata_year = interaction(strata, year))\n",
    "\n",
    "\n",
    "# 10B. Set survey options for singleton PSUs\n",
    "\n",
    "\n",
    "# This prevents errors from strata with only one PSU (a common issue in BRFSS)\n",
    "options(survey.lonely.psu = \"adjust\")\n",
    "\n",
    "\n",
    "# 10C. Create the Survey Design Object\n",
    "\n",
    "\n",
    "# Since there's no PSU in the public BRFSS file, we use ids = ~1\n",
    "brfss_svy <- svydesign(\n",
    "  ids     = ~1,\n",
    "  strata  = ~strata_year,\n",
    "  weights = ~weight,\n",
    "  data    = brfss_merged2,\n",
    "  nest    = TRUE\n",
    ")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "85ba0437-9d5f-4849-9f0f-eb416a0006cd",
   "metadata": {},
   "source": [
    "# Step 11 : Nested Models"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c6d7d162-b8fd-4e95-aa17-bab16fd04fd6",
   "metadata": {},
   "source": [
    "# Step 11A: Nested Survey-Weighted Logistic Models for Self-Rated Health (SRH)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5aeed120-b498-409b-90b0-a52b8bdf1a6b",
   "metadata": {},
   "source": [
    "## Model 0: Binge Drinking Only"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "2cd8e4f0-8a85-4ddc-ae84-480ddcd8983a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = srh ~ binge, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "            Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept) -0.04932    0.08121  -0.607    0.544    \n",
       "binge1      -0.75206    0.19040  -3.950 8.54e-05 ***\n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.000362)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 2 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.9518775</td><td>0.8116048</td><td>1.1163940</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4713927</td><td>0.3243811</td><td>0.6850308</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 2 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.9518775 & 0.8116048 & 1.1163940\\\\\n",
       "\tbinge1 & 0.4713927 & 0.3243811 & 0.6850308\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 2 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.9518775 | 0.8116048 | 1.1163940 |\n",
       "| binge1 | 0.4713927 | 0.3243811 | 0.6850308 |\n",
       "\n"
      ],
      "text/plain": [
       "            OR        2.5 %     97.5 %   \n",
       "(Intercept) 0.9518775 0.8116048 1.1163940\n",
       "binge1      0.4713927 0.3243811 0.6850308"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_base <- svyglm(\n",
    "  srh ~ binge,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "(summary(model_base))\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_base), confint(model_base)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c48d932f-6871-4004-9998-574db0222432",
   "metadata": {},
   "source": [
    "## Model 1: + Demographics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "73fef0ca-0c79-468e-b35f-ea2026610293",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = srh ~ binge + age_sq + sex + race, design = brfss_svy, \n",
       "    family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -9.667e-01  2.601e-01  -3.717 0.000216 ***\n",
       "binge1                 -4.541e-01  1.988e-01  -2.284 0.022622 *  \n",
       "age_sq                  3.982e-04  4.932e-05   8.073 2.68e-15 ***\n",
       "sex1                    9.022e-02  1.488e-01   0.607 0.544346    \n",
       "raceNon-Hispanic Black  4.055e-01  3.430e-01   1.182 0.237441    \n",
       "raceNon-Hispanic Other -2.642e-01  4.235e-01  -0.624 0.532927    \n",
       "raceNon-Hispanic White -2.748e-01  2.446e-01  -1.124 0.261530    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.000107)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 7 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.3803317</td><td>0.2282671</td><td>0.6336972</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.6350334</td><td>0.4298651</td><td>0.9381255</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.0003983</td><td>1.0003014</td><td>1.0004951</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.0944176</td><td>0.8172653</td><td>1.4655583</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.5000435</td><td>0.7650871</td><td>2.9410125</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.7678409</td><td>0.3343785</td><td>1.7632105</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.7597251</td><td>0.4700560</td><td>1.2279011</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 7 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.3803317 & 0.2282671 & 0.6336972\\\\\n",
       "\tbinge1 & 0.6350334 & 0.4298651 & 0.9381255\\\\\n",
       "\tage\\_sq & 1.0003983 & 1.0003014 & 1.0004951\\\\\n",
       "\tsex1 & 1.0944176 & 0.8172653 & 1.4655583\\\\\n",
       "\traceNon-Hispanic Black & 1.5000435 & 0.7650871 & 2.9410125\\\\\n",
       "\traceNon-Hispanic Other & 0.7678409 & 0.3343785 & 1.7632105\\\\\n",
       "\traceNon-Hispanic White & 0.7597251 & 0.4700560 & 1.2279011\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 7 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.3803317 | 0.2282671 | 0.6336972 |\n",
       "| binge1 | 0.6350334 | 0.4298651 | 0.9381255 |\n",
       "| age_sq | 1.0003983 | 1.0003014 | 1.0004951 |\n",
       "| sex1 | 1.0944176 | 0.8172653 | 1.4655583 |\n",
       "| raceNon-Hispanic Black | 1.5000435 | 0.7650871 | 2.9410125 |\n",
       "| raceNon-Hispanic Other | 0.7678409 | 0.3343785 | 1.7632105 |\n",
       "| raceNon-Hispanic White | 0.7597251 | 0.4700560 | 1.2279011 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %     97.5 %   \n",
       "(Intercept)            0.3803317 0.2282671 0.6336972\n",
       "binge1                 0.6350334 0.4298651 0.9381255\n",
       "age_sq                 1.0003983 1.0003014 1.0004951\n",
       "sex1                   1.0944176 0.8172653 1.4655583\n",
       "raceNon-Hispanic Black 1.5000435 0.7650871 2.9410125\n",
       "raceNon-Hispanic Other 0.7678409 0.3343785 1.7632105\n",
       "raceNon-Hispanic White 0.7597251 0.4700560 1.2279011"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_1 <- svyglm(\n",
    "  srh ~ binge + age_sq + sex + race,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_1)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_1), confint(model_1)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3f846273-1953-4c8f-ab16-3c72d4861b7a",
   "metadata": {},
   "source": [
    "## Model 2: + Socioeconomic Variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "afc14282-48e5-4973-b365-a500e97d7a88",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = srh ~ binge + age_sq + sex + race + inc + edu + \n",
       "    ins, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -2.434e+00  3.464e-01  -7.025 4.79e-12 ***\n",
       "binge1                 -5.019e-01  2.156e-01  -2.328 0.020201 *  \n",
       "age_sq                  4.058e-04  5.007e-05   8.104 2.15e-15 ***\n",
       "sex1                   -1.026e-02  1.538e-01  -0.067 0.946842    \n",
       "raceNon-Hispanic Black  3.990e-01  3.406e-01   1.172 0.241734    \n",
       "raceNon-Hispanic Other -1.369e-01  4.763e-01  -0.288 0.773775    \n",
       "raceNon-Hispanic White -1.591e-02  2.505e-01  -0.064 0.949375    \n",
       "inc$15k-$25k            9.483e-01  2.501e-01   3.791 0.000162 ***\n",
       "inc$25k-$35k            5.523e-01  3.111e-01   1.775 0.076222 .  \n",
       "inc$35k-$50k            6.499e-01  3.021e-01   2.151 0.031767 *  \n",
       "inc$50k-$75k            2.132e-01  2.719e-01   0.784 0.433209    \n",
       "inc<$15k                8.529e-01  2.754e-01   3.097 0.002026 ** \n",
       "eduAttended College     7.095e-01  2.056e-01   3.451 0.000589 ***\n",
       "eduHS Graduate          9.679e-01  2.105e-01   4.598 4.99e-06 ***\n",
       "eduLess than HS         9.786e-01  3.141e-01   3.115 0.001907 ** \n",
       "ins0                    3.018e-01  2.389e-01   1.263 0.206924    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.002786)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 16 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.08771427</td><td>0.04443503</td><td>0.1731470</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.60536862</td><td>0.39643167</td><td>0.9244245</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.00040583</td><td>1.00030750</td><td>1.0005042</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>0.98979391</td><td>0.73182798</td><td>1.3386916</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.49035933</td><td>0.76369964</td><td>2.9084352</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.87201419</td><td>0.34234593</td><td>2.2211707</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.98421484</td><td>0.60187103</td><td>1.6094459</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>2.58141692</td><td>1.57976196</td><td>4.2181756</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.73718536</td><td>0.94330617</td><td>3.1991871</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.91542035</td><td>1.05851137</td><td>3.4660328</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.23767206</td><td>0.72570850</td><td>2.1108091</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>2.34648971</td><td>1.36656972</td><td>4.0290765</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>2.03294391</td><td>1.35787981</td><td>3.0436132</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>2.63243232</td><td>1.74140937</td><td>3.9793630</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>2.66073495</td><td>1.43611545</td><td>4.9296249</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.35225590</td><td>0.84600909</td><td>2.1614378</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 16 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.08771427 & 0.04443503 & 0.1731470\\\\\n",
       "\tbinge1 & 0.60536862 & 0.39643167 & 0.9244245\\\\\n",
       "\tage\\_sq & 1.00040583 & 1.00030750 & 1.0005042\\\\\n",
       "\tsex1 & 0.98979391 & 0.73182798 & 1.3386916\\\\\n",
       "\traceNon-Hispanic Black & 1.49035933 & 0.76369964 & 2.9084352\\\\\n",
       "\traceNon-Hispanic Other & 0.87201419 & 0.34234593 & 2.2211707\\\\\n",
       "\traceNon-Hispanic White & 0.98421484 & 0.60187103 & 1.6094459\\\\\n",
       "\tinc\\$15k-\\$25k & 2.58141692 & 1.57976196 & 4.2181756\\\\\n",
       "\tinc\\$25k-\\$35k & 1.73718536 & 0.94330617 & 3.1991871\\\\\n",
       "\tinc\\$35k-\\$50k & 1.91542035 & 1.05851137 & 3.4660328\\\\\n",
       "\tinc\\$50k-\\$75k & 1.23767206 & 0.72570850 & 2.1108091\\\\\n",
       "\tinc<\\$15k & 2.34648971 & 1.36656972 & 4.0290765\\\\\n",
       "\teduAttended College & 2.03294391 & 1.35787981 & 3.0436132\\\\\n",
       "\teduHS Graduate & 2.63243232 & 1.74140937 & 3.9793630\\\\\n",
       "\teduLess than HS & 2.66073495 & 1.43611545 & 4.9296249\\\\\n",
       "\tins0 & 1.35225590 & 0.84600909 & 2.1614378\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 16 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.08771427 | 0.04443503 | 0.1731470 |\n",
       "| binge1 | 0.60536862 | 0.39643167 | 0.9244245 |\n",
       "| age_sq | 1.00040583 | 1.00030750 | 1.0005042 |\n",
       "| sex1 | 0.98979391 | 0.73182798 | 1.3386916 |\n",
       "| raceNon-Hispanic Black | 1.49035933 | 0.76369964 | 2.9084352 |\n",
       "| raceNon-Hispanic Other | 0.87201419 | 0.34234593 | 2.2211707 |\n",
       "| raceNon-Hispanic White | 0.98421484 | 0.60187103 | 1.6094459 |\n",
       "| inc$15k-$25k | 2.58141692 | 1.57976196 | 4.2181756 |\n",
       "| inc$25k-$35k | 1.73718536 | 0.94330617 | 3.1991871 |\n",
       "| inc$35k-$50k | 1.91542035 | 1.05851137 | 3.4660328 |\n",
       "| inc$50k-$75k | 1.23767206 | 0.72570850 | 2.1108091 |\n",
       "| inc&lt;$15k | 2.34648971 | 1.36656972 | 4.0290765 |\n",
       "| eduAttended College | 2.03294391 | 1.35787981 | 3.0436132 |\n",
       "| eduHS Graduate | 2.63243232 | 1.74140937 | 3.9793630 |\n",
       "| eduLess than HS | 2.66073495 | 1.43611545 | 4.9296249 |\n",
       "| ins0 | 1.35225590 | 0.84600909 | 2.1614378 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR         2.5 %      97.5 %   \n",
       "(Intercept)            0.08771427 0.04443503 0.1731470\n",
       "binge1                 0.60536862 0.39643167 0.9244245\n",
       "age_sq                 1.00040583 1.00030750 1.0005042\n",
       "sex1                   0.98979391 0.73182798 1.3386916\n",
       "raceNon-Hispanic Black 1.49035933 0.76369964 2.9084352\n",
       "raceNon-Hispanic Other 0.87201419 0.34234593 2.2211707\n",
       "raceNon-Hispanic White 0.98421484 0.60187103 1.6094459\n",
       "inc$15k-$25k           2.58141692 1.57976196 4.2181756\n",
       "inc$25k-$35k           1.73718536 0.94330617 3.1991871\n",
       "inc$35k-$50k           1.91542035 1.05851137 3.4660328\n",
       "inc$50k-$75k           1.23767206 0.72570850 2.1108091\n",
       "inc<$15k               2.34648971 1.36656972 4.0290765\n",
       "eduAttended College    2.03294391 1.35787981 3.0436132\n",
       "eduHS Graduate         2.63243232 1.74140937 3.9793630\n",
       "eduLess than HS        2.66073495 1.43611545 4.9296249\n",
       "ins0                   1.35225590 0.84600909 2.1614378"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_2 <- svyglm(\n",
    "  srh ~ binge + age_sq + sex + race + inc + edu + ins,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_2)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_2), confint(model_2)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da5a7d6d-51ef-4e8a-9969-2d62c6feda44",
   "metadata": {},
   "source": [
    "## Model 3: + Health Behaviors & Clinical Conditions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "a2ffc927-7e8b-4aa0-9270-e8adff574c6b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = srh ~ binge + age_sq + sex + race + inc + edu + \n",
       "    ins + emp + marital + home + smoke + heavy + active + bmi + \n",
       "    asthma + arth + copd + chd + diab + kidney + stroke + disab + \n",
       "    MCC + year, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -3.220e+00  4.662e-01  -6.906 1.09e-11 ***\n",
       "binge1                 -4.037e-01  2.745e-01  -1.471 0.141812    \n",
       "age_sq                  1.825e-04  6.432e-05   2.838 0.004665 ** \n",
       "sex1                   -1.856e-03  1.700e-01  -0.011 0.991293    \n",
       "raceNon-Hispanic Black  8.959e-02  3.547e-01   0.253 0.800648    \n",
       "raceNon-Hispanic Other -1.535e-01  4.299e-01  -0.357 0.721080    \n",
       "raceNon-Hispanic White -1.265e-01  2.622e-01  -0.483 0.629554    \n",
       "inc$15k-$25k            2.644e-01  2.721e-01   0.972 0.331563    \n",
       "inc$25k-$35k            1.969e-01  2.992e-01   0.658 0.510571    \n",
       "inc$35k-$50k            4.080e-01  2.752e-01   1.482 0.138726    \n",
       "inc$50k-$75k            1.097e-01  2.897e-01   0.379 0.704973    \n",
       "inc<$15k                1.497e-01  3.155e-01   0.474 0.635303    \n",
       "eduAttended College     2.793e-01  2.107e-01   1.325 0.185465    \n",
       "eduHS Graduate          5.156e-01  2.261e-01   2.280 0.022886 *  \n",
       "eduLess than HS         5.972e-01  3.199e-01   1.867 0.062353 .  \n",
       "ins0                    5.694e-01  2.813e-01   2.024 0.043329 *  \n",
       "empNot in Labor Force   2.778e-01  1.896e-01   1.465 0.143258    \n",
       "empUnemployed          -1.723e-01  5.305e-01  -0.325 0.745418    \n",
       "maritalCohabiting      -2.105e-01  3.793e-01  -0.555 0.579035    \n",
       "maritalDivorced        -2.200e-01  2.105e-01  -1.045 0.296378    \n",
       "maritalNever Married   -4.246e-01  2.482e-01  -1.711 0.087575 .  \n",
       "homeOther               1.579e-02  3.530e-01   0.045 0.964349    \n",
       "homeRent                3.879e-01  2.147e-01   1.807 0.071214 .  \n",
       "smokeSmoker             6.255e-02  1.730e-01   0.362 0.717815    \n",
       "heavyYes                8.009e-01  3.727e-01   2.149 0.031950 *  \n",
       "activeNo                7.942e-01  1.749e-01   4.540 6.59e-06 ***\n",
       "bmiObese                4.075e-01  2.018e-01   2.019 0.043811 *  \n",
       "bmiOverweight           4.685e-01  2.018e-01   2.321 0.020538 *  \n",
       "asthmaYes               8.508e-02  2.101e-01   0.405 0.685693    \n",
       "arthYes                 4.344e-01  2.274e-01   1.910 0.056545 .  \n",
       "copdYes                 1.914e-01  2.534e-01   0.755 0.450270    \n",
       "chdYes                  1.235e+00  3.506e-01   3.524 0.000452 ***\n",
       "diabYes                 2.457e-01  2.994e-01   0.820 0.412235    \n",
       "kidneyYes               3.269e-01  3.898e-01   0.839 0.401973    \n",
       "strokeYes               3.273e-01  3.114e-01   1.051 0.293552    \n",
       "disabYes                1.291e+00  1.792e-01   7.207 1.44e-12 ***\n",
       "MCCYes                 -1.679e-02  3.050e-01  -0.055 0.956128    \n",
       "year2014                2.829e-01  3.088e-01   0.916 0.359923    \n",
       "year2015                2.531e-01  3.266e-01   0.775 0.438520    \n",
       "year2016                1.454e-01  3.040e-01   0.478 0.632611    \n",
       "year2017                1.893e-01  3.103e-01   0.610 0.542033    \n",
       "year2018                1.886e-01  3.435e-01   0.549 0.582994    \n",
       "year2019               -4.522e-01  3.145e-01  -1.438 0.150978    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.040459)\n",
       "\n",
       "Number of Fisher Scoring iterations: 5\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.03997161</td><td>0.01600496</td><td>0.09982715</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.66783862</td><td>0.38960224</td><td>1.14477889</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.00018257</td><td>1.00005627</td><td>1.00030888</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>0.99814609</td><td>0.71492071</td><td>1.39357498</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.09372094</td><td>0.54515732</td><td>2.19427576</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.85766448</td><td>0.36878215</td><td>1.99464203</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.88116053</td><td>0.52664467</td><td>1.47432212</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.30261283</td><td>0.76352210</td><td>2.22233278</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.21767832</td><td>0.67676748</td><td>2.19091568</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.50375308</td><td>0.87598208</td><td>2.58141506</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.11597333</td><td>0.63190456</td><td>1.97086169</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.16148031</td><td>0.62519049</td><td>2.15780075</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.32221352</td><td>0.87421946</td><td>1.99978228</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.67472123</td><td>1.07430582</td><td>2.61070092</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.81696779</td><td>0.96957297</td><td>3.40497522</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.76720923</td><td>1.01725902</td><td>3.07004253</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.32022088</td><td>0.90992870</td><td>1.91551621</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>0.84171727</td><td>0.29706490</td><td>2.38496017</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>0.81015033</td><td>0.38472833</td><td>1.70599228</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>0.80254787</td><td>0.53088191</td><td>1.21323231</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>0.65404441</td><td>0.40177810</td><td>1.06470235</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.01591030</td><td>0.50797683</td><td>2.03173388</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.47390251</td><td>0.96696228</td><td>2.24661153</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.06454712</td><td>0.75795984</td><td>1.49514593</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>2.22761450</td><td>1.07175428</td><td>4.63004110</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>2.21258238</td><td>1.56944736</td><td>3.11926409</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>1.50302409</td><td>1.01139947</td><td>2.23361933</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.59761390</td><td>1.07497318</td><td>2.37435707</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>1.08880005</td><td>0.72074877</td><td>1.64479719</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>1.54396603</td><td>0.98793372</td><td>2.41294638</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.21099121</td><td>0.73629979</td><td>1.99171550</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>3.43993826</td><td>1.72825544</td><td>6.84689021</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.27848655</td><td>0.71020127</td><td>2.30149949</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>1.38669473</td><td>0.64504228</td><td>2.98107945</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.38728403</td><td>0.75272341</td><td>2.55679173</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>3.63809499</td><td>2.55910259</td><td>5.17202211</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.98335306</td><td>0.54028282</td><td>1.78977233</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>1.32693399</td><td>0.72372837</td><td>2.43289318</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.28805147</td><td>0.67841120</td><td>2.44553243</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>1.15646794</td><td>0.63675252</td><td>2.10037348</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>1.20841429</td><td>0.65708725</td><td>2.22233057</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>1.20761361</td><td>0.61530654</td><td>2.37008799</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.63623446</td><td>0.34310734</td><td>1.17978909</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.03997161 & 0.01600496 & 0.09982715\\\\\n",
       "\tbinge1 & 0.66783862 & 0.38960224 & 1.14477889\\\\\n",
       "\tage\\_sq & 1.00018257 & 1.00005627 & 1.00030888\\\\\n",
       "\tsex1 & 0.99814609 & 0.71492071 & 1.39357498\\\\\n",
       "\traceNon-Hispanic Black & 1.09372094 & 0.54515732 & 2.19427576\\\\\n",
       "\traceNon-Hispanic Other & 0.85766448 & 0.36878215 & 1.99464203\\\\\n",
       "\traceNon-Hispanic White & 0.88116053 & 0.52664467 & 1.47432212\\\\\n",
       "\tinc\\$15k-\\$25k & 1.30261283 & 0.76352210 & 2.22233278\\\\\n",
       "\tinc\\$25k-\\$35k & 1.21767832 & 0.67676748 & 2.19091568\\\\\n",
       "\tinc\\$35k-\\$50k & 1.50375308 & 0.87598208 & 2.58141506\\\\\n",
       "\tinc\\$50k-\\$75k & 1.11597333 & 0.63190456 & 1.97086169\\\\\n",
       "\tinc<\\$15k & 1.16148031 & 0.62519049 & 2.15780075\\\\\n",
       "\teduAttended College & 1.32221352 & 0.87421946 & 1.99978228\\\\\n",
       "\teduHS Graduate & 1.67472123 & 1.07430582 & 2.61070092\\\\\n",
       "\teduLess than HS & 1.81696779 & 0.96957297 & 3.40497522\\\\\n",
       "\tins0 & 1.76720923 & 1.01725902 & 3.07004253\\\\\n",
       "\tempNot in Labor Force & 1.32022088 & 0.90992870 & 1.91551621\\\\\n",
       "\tempUnemployed & 0.84171727 & 0.29706490 & 2.38496017\\\\\n",
       "\tmaritalCohabiting & 0.81015033 & 0.38472833 & 1.70599228\\\\\n",
       "\tmaritalDivorced & 0.80254787 & 0.53088191 & 1.21323231\\\\\n",
       "\tmaritalNever Married & 0.65404441 & 0.40177810 & 1.06470235\\\\\n",
       "\thomeOther & 1.01591030 & 0.50797683 & 2.03173388\\\\\n",
       "\thomeRent & 1.47390251 & 0.96696228 & 2.24661153\\\\\n",
       "\tsmokeSmoker & 1.06454712 & 0.75795984 & 1.49514593\\\\\n",
       "\theavyYes & 2.22761450 & 1.07175428 & 4.63004110\\\\\n",
       "\tactiveNo & 2.21258238 & 1.56944736 & 3.11926409\\\\\n",
       "\tbmiObese & 1.50302409 & 1.01139947 & 2.23361933\\\\\n",
       "\tbmiOverweight & 1.59761390 & 1.07497318 & 2.37435707\\\\\n",
       "\tasthmaYes & 1.08880005 & 0.72074877 & 1.64479719\\\\\n",
       "\tarthYes & 1.54396603 & 0.98793372 & 2.41294638\\\\\n",
       "\tcopdYes & 1.21099121 & 0.73629979 & 1.99171550\\\\\n",
       "\tchdYes & 3.43993826 & 1.72825544 & 6.84689021\\\\\n",
       "\tdiabYes & 1.27848655 & 0.71020127 & 2.30149949\\\\\n",
       "\tkidneyYes & 1.38669473 & 0.64504228 & 2.98107945\\\\\n",
       "\tstrokeYes & 1.38728403 & 0.75272341 & 2.55679173\\\\\n",
       "\tdisabYes & 3.63809499 & 2.55910259 & 5.17202211\\\\\n",
       "\tMCCYes & 0.98335306 & 0.54028282 & 1.78977233\\\\\n",
       "\tyear2014 & 1.32693399 & 0.72372837 & 2.43289318\\\\\n",
       "\tyear2015 & 1.28805147 & 0.67841120 & 2.44553243\\\\\n",
       "\tyear2016 & 1.15646794 & 0.63675252 & 2.10037348\\\\\n",
       "\tyear2017 & 1.20841429 & 0.65708725 & 2.22233057\\\\\n",
       "\tyear2018 & 1.20761361 & 0.61530654 & 2.37008799\\\\\n",
       "\tyear2019 & 0.63623446 & 0.34310734 & 1.17978909\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.03997161 | 0.01600496 | 0.09982715 |\n",
       "| binge1 | 0.66783862 | 0.38960224 | 1.14477889 |\n",
       "| age_sq | 1.00018257 | 1.00005627 | 1.00030888 |\n",
       "| sex1 | 0.99814609 | 0.71492071 | 1.39357498 |\n",
       "| raceNon-Hispanic Black | 1.09372094 | 0.54515732 | 2.19427576 |\n",
       "| raceNon-Hispanic Other | 0.85766448 | 0.36878215 | 1.99464203 |\n",
       "| raceNon-Hispanic White | 0.88116053 | 0.52664467 | 1.47432212 |\n",
       "| inc$15k-$25k | 1.30261283 | 0.76352210 | 2.22233278 |\n",
       "| inc$25k-$35k | 1.21767832 | 0.67676748 | 2.19091568 |\n",
       "| inc$35k-$50k | 1.50375308 | 0.87598208 | 2.58141506 |\n",
       "| inc$50k-$75k | 1.11597333 | 0.63190456 | 1.97086169 |\n",
       "| inc&lt;$15k | 1.16148031 | 0.62519049 | 2.15780075 |\n",
       "| eduAttended College | 1.32221352 | 0.87421946 | 1.99978228 |\n",
       "| eduHS Graduate | 1.67472123 | 1.07430582 | 2.61070092 |\n",
       "| eduLess than HS | 1.81696779 | 0.96957297 | 3.40497522 |\n",
       "| ins0 | 1.76720923 | 1.01725902 | 3.07004253 |\n",
       "| empNot in Labor Force | 1.32022088 | 0.90992870 | 1.91551621 |\n",
       "| empUnemployed | 0.84171727 | 0.29706490 | 2.38496017 |\n",
       "| maritalCohabiting | 0.81015033 | 0.38472833 | 1.70599228 |\n",
       "| maritalDivorced | 0.80254787 | 0.53088191 | 1.21323231 |\n",
       "| maritalNever Married | 0.65404441 | 0.40177810 | 1.06470235 |\n",
       "| homeOther | 1.01591030 | 0.50797683 | 2.03173388 |\n",
       "| homeRent | 1.47390251 | 0.96696228 | 2.24661153 |\n",
       "| smokeSmoker | 1.06454712 | 0.75795984 | 1.49514593 |\n",
       "| heavyYes | 2.22761450 | 1.07175428 | 4.63004110 |\n",
       "| activeNo | 2.21258238 | 1.56944736 | 3.11926409 |\n",
       "| bmiObese | 1.50302409 | 1.01139947 | 2.23361933 |\n",
       "| bmiOverweight | 1.59761390 | 1.07497318 | 2.37435707 |\n",
       "| asthmaYes | 1.08880005 | 0.72074877 | 1.64479719 |\n",
       "| arthYes | 1.54396603 | 0.98793372 | 2.41294638 |\n",
       "| copdYes | 1.21099121 | 0.73629979 | 1.99171550 |\n",
       "| chdYes | 3.43993826 | 1.72825544 | 6.84689021 |\n",
       "| diabYes | 1.27848655 | 0.71020127 | 2.30149949 |\n",
       "| kidneyYes | 1.38669473 | 0.64504228 | 2.98107945 |\n",
       "| strokeYes | 1.38728403 | 0.75272341 | 2.55679173 |\n",
       "| disabYes | 3.63809499 | 2.55910259 | 5.17202211 |\n",
       "| MCCYes | 0.98335306 | 0.54028282 | 1.78977233 |\n",
       "| year2014 | 1.32693399 | 0.72372837 | 2.43289318 |\n",
       "| year2015 | 1.28805147 | 0.67841120 | 2.44553243 |\n",
       "| year2016 | 1.15646794 | 0.63675252 | 2.10037348 |\n",
       "| year2017 | 1.20841429 | 0.65708725 | 2.22233057 |\n",
       "| year2018 | 1.20761361 | 0.61530654 | 2.37008799 |\n",
       "| year2019 | 0.63623446 | 0.34310734 | 1.17978909 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR         2.5 %      97.5 %    \n",
       "(Intercept)            0.03997161 0.01600496 0.09982715\n",
       "binge1                 0.66783862 0.38960224 1.14477889\n",
       "age_sq                 1.00018257 1.00005627 1.00030888\n",
       "sex1                   0.99814609 0.71492071 1.39357498\n",
       "raceNon-Hispanic Black 1.09372094 0.54515732 2.19427576\n",
       "raceNon-Hispanic Other 0.85766448 0.36878215 1.99464203\n",
       "raceNon-Hispanic White 0.88116053 0.52664467 1.47432212\n",
       "inc$15k-$25k           1.30261283 0.76352210 2.22233278\n",
       "inc$25k-$35k           1.21767832 0.67676748 2.19091568\n",
       "inc$35k-$50k           1.50375308 0.87598208 2.58141506\n",
       "inc$50k-$75k           1.11597333 0.63190456 1.97086169\n",
       "inc<$15k               1.16148031 0.62519049 2.15780075\n",
       "eduAttended College    1.32221352 0.87421946 1.99978228\n",
       "eduHS Graduate         1.67472123 1.07430582 2.61070092\n",
       "eduLess than HS        1.81696779 0.96957297 3.40497522\n",
       "ins0                   1.76720923 1.01725902 3.07004253\n",
       "empNot in Labor Force  1.32022088 0.90992870 1.91551621\n",
       "empUnemployed          0.84171727 0.29706490 2.38496017\n",
       "maritalCohabiting      0.81015033 0.38472833 1.70599228\n",
       "maritalDivorced        0.80254787 0.53088191 1.21323231\n",
       "maritalNever Married   0.65404441 0.40177810 1.06470235\n",
       "homeOther              1.01591030 0.50797683 2.03173388\n",
       "homeRent               1.47390251 0.96696228 2.24661153\n",
       "smokeSmoker            1.06454712 0.75795984 1.49514593\n",
       "heavyYes               2.22761450 1.07175428 4.63004110\n",
       "activeNo               2.21258238 1.56944736 3.11926409\n",
       "bmiObese               1.50302409 1.01139947 2.23361933\n",
       "bmiOverweight          1.59761390 1.07497318 2.37435707\n",
       "asthmaYes              1.08880005 0.72074877 1.64479719\n",
       "arthYes                1.54396603 0.98793372 2.41294638\n",
       "copdYes                1.21099121 0.73629979 1.99171550\n",
       "chdYes                 3.43993826 1.72825544 6.84689021\n",
       "diabYes                1.27848655 0.71020127 2.30149949\n",
       "kidneyYes              1.38669473 0.64504228 2.98107945\n",
       "strokeYes              1.38728403 0.75272341 2.55679173\n",
       "disabYes               3.63809499 2.55910259 5.17202211\n",
       "MCCYes                 0.98335306 0.54028282 1.78977233\n",
       "year2014               1.32693399 0.72372837 2.43289318\n",
       "year2015               1.28805147 0.67841120 2.44553243\n",
       "year2016               1.15646794 0.63675252 2.10037348\n",
       "year2017               1.20841429 0.65708725 2.22233057\n",
       "year2018               1.20761361 0.61530654 2.37008799\n",
       "year2019               0.63623446 0.34310734 1.17978909"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_3 <- svyglm(\n",
    "  srh ~ binge + age_sq + sex + race + inc + edu + ins +\n",
    "    emp + marital + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke +\n",
    "    disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_3)\n",
    "       \n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_3), confint(model_3)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "42184d1b-7a7a-42c6-a6ea-7917232a62cf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'gtsummary' was built under R version 4.5.1\"\n",
      "Warning message:\n",
      "\"package 'gt' was built under R version 4.5.1\"\n"
     ]
    }
   ],
   "source": [
    "library(gtsummary)\n",
    "library(gt)\n",
    "\n",
    "# Step 1: Create individual model tables for SRH\n",
    "\n",
    "tbl_model_base_srh <- tbl_regression(model_base, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_1_srh <- tbl_regression(model_1, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_2_srh <- tbl_regression(model_2, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_3_srh <- tbl_regression(model_3, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "# Step 2: Merge into one side-by-side table\n",
    "\n",
    "\n",
    "tbl_srh_combined <- tbl_merge(\n",
    "  tbls = list(tbl_model_base_srh, tbl_model_1_srh, tbl_model_2_srh, tbl_model_3_srh),\n",
    "  tab_spanner = c(\"**Model 0: Binge only**\", \"**Model 1: + Demographics**\",\n",
    "                  \"**Model 2: + SES**\", \"**Model 3: + Full Model**\")\n",
    ")\n",
    "\n",
    "# Optional: Save to HTML\n",
    "as_gt(tbl_srh_combined) %>%\n",
    "  gtsave(\"C:/Users/chava/Downloads/Recent_Research_Activity/Output/srh_models.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "51794718-ff84-4ba9-86b8-655b7706808f",
   "metadata": {},
   "source": [
    "# Step 11B: Nested Survey-Weighted Logistic Models for Bad Physical Health"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e412455f-0ae0-447f-8de2-8971f4526bcf",
   "metadata": {},
   "source": [
    "## Model 0: Binge Drinking Only"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "a647c8ae-a5b1-4b36-8497-5834b0a955e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = bad_phys ~ binge, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "            Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept) -0.12558    0.07574  -1.658   0.0977 .  \n",
       "binge1      -1.05852    0.17948  -5.898 5.53e-09 ***\n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.000362)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 2 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.9518775</td><td>0.8116048</td><td>1.1163940</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4713927</td><td>0.3243811</td><td>0.6850308</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 2 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.9518775 & 0.8116048 & 1.1163940\\\\\n",
       "\tbinge1 & 0.4713927 & 0.3243811 & 0.6850308\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 2 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.9518775 | 0.8116048 | 1.1163940 |\n",
       "| binge1 | 0.4713927 | 0.3243811 | 0.6850308 |\n",
       "\n"
      ],
      "text/plain": [
       "            OR        2.5 %     97.5 %   \n",
       "(Intercept) 0.9518775 0.8116048 1.1163940\n",
       "binge1      0.4713927 0.3243811 0.6850308"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_base_badphys <- svyglm(\n",
    "  bad_phys ~ binge,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_base_badphys)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_base), confint(model_base)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "229a295f-5eac-41d0-a30d-c7c301ab3f67",
   "metadata": {},
   "source": [
    "## Model 1: + Demographics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "7d570480-399f-4cdf-b86a-07ce01119bdb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = bad_phys ~ binge + age_sq + sex + race, design = brfss_svy, \n",
       "    family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -0.6041540  0.2485318  -2.431   0.0153 *  \n",
       "binge1                 -0.8537574  0.1891600  -4.513 7.39e-06 ***\n",
       "age_sq                  0.0002917  0.0000462   6.314 4.63e-10 ***\n",
       "sex1                    0.1579522  0.1452661   1.087   0.2772    \n",
       "raceNon-Hispanic Black -0.2022773  0.3293055  -0.614   0.5392    \n",
       "raceNon-Hispanic Other -0.7858179  0.3460512  -2.271   0.0234 *  \n",
       "raceNon-Hispanic White -0.4140519  0.2393982  -1.730   0.0841 .  \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 0.9953768)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 7 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.5465366</td><td>0.3355302</td><td>0.8902396</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4258120</td><td>0.2937298</td><td>0.6172878</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.0002917</td><td>1.0002010</td><td>1.0003825</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.1711102</td><td>0.8805421</td><td>1.5575624</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.8168684</td><td>0.4279571</td><td>1.5592077</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.4557468</td><td>0.2310442</td><td>0.8989844</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.6609666</td><td>0.4131225</td><td>1.0574998</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 7 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.5465366 & 0.3355302 & 0.8902396\\\\\n",
       "\tbinge1 & 0.4258120 & 0.2937298 & 0.6172878\\\\\n",
       "\tage\\_sq & 1.0002917 & 1.0002010 & 1.0003825\\\\\n",
       "\tsex1 & 1.1711102 & 0.8805421 & 1.5575624\\\\\n",
       "\traceNon-Hispanic Black & 0.8168684 & 0.4279571 & 1.5592077\\\\\n",
       "\traceNon-Hispanic Other & 0.4557468 & 0.2310442 & 0.8989844\\\\\n",
       "\traceNon-Hispanic White & 0.6609666 & 0.4131225 & 1.0574998\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 7 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.5465366 | 0.3355302 | 0.8902396 |\n",
       "| binge1 | 0.4258120 | 0.2937298 | 0.6172878 |\n",
       "| age_sq | 1.0002917 | 1.0002010 | 1.0003825 |\n",
       "| sex1 | 1.1711102 | 0.8805421 | 1.5575624 |\n",
       "| raceNon-Hispanic Black | 0.8168684 | 0.4279571 | 1.5592077 |\n",
       "| raceNon-Hispanic Other | 0.4557468 | 0.2310442 | 0.8989844 |\n",
       "| raceNon-Hispanic White | 0.6609666 | 0.4131225 | 1.0574998 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %     97.5 %   \n",
       "(Intercept)            0.5465366 0.3355302 0.8902396\n",
       "binge1                 0.4258120 0.2937298 0.6172878\n",
       "age_sq                 1.0002917 1.0002010 1.0003825\n",
       "sex1                   1.1711102 0.8805421 1.5575624\n",
       "raceNon-Hispanic Black 0.8168684 0.4279571 1.5592077\n",
       "raceNon-Hispanic Other 0.4557468 0.2310442 0.8989844\n",
       "raceNon-Hispanic White 0.6609666 0.4131225 1.0574998"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_1_badphys <- svyglm(\n",
    "  bad_phys ~ binge + age_sq + sex + race,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_1_badphys)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_1_badphys), confint(model_1_badphys)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e157a54a-386a-448b-84d6-0724d1c42a80",
   "metadata": {},
   "source": [
    "## Model 2: + Socioeconomic Factors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "2ce27c2e-f44f-4601-ba32-1a90698a4550",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = bad_phys ~ binge + age_sq + sex + race + inc + \n",
       "    edu + ins, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -1.955e+00  3.268e-01  -5.983 3.39e-09 ***\n",
       "binge1                 -8.684e-01  2.061e-01  -4.213 2.82e-05 ***\n",
       "age_sq                  2.868e-04  4.844e-05   5.920 4.90e-09 ***\n",
       "sex1                    1.001e-01  1.483e-01   0.675 0.500000    \n",
       "raceNon-Hispanic Black -2.381e-01  3.351e-01  -0.710 0.477618    \n",
       "raceNon-Hispanic Other -7.004e-01  3.706e-01  -1.890 0.059150 .  \n",
       "raceNon-Hispanic White -2.312e-01  2.371e-01  -0.975 0.329718    \n",
       "inc$15k-$25k            9.252e-01  2.499e-01   3.703 0.000229 ***\n",
       "inc$25k-$35k            4.073e-01  3.139e-01   1.298 0.194840    \n",
       "inc$35k-$50k            3.110e-01  2.947e-01   1.055 0.291636    \n",
       "inc$50k-$75k            5.890e-01  2.618e-01   2.250 0.024752 *  \n",
       "inc<$15k                1.001e+00  2.801e-01   3.575 0.000372 ***\n",
       "eduAttended College     8.775e-01  2.033e-01   4.316 1.80e-05 ***\n",
       "eduHS Graduate          8.228e-01  2.177e-01   3.780 0.000169 ***\n",
       "eduLess than HS         7.553e-01  2.938e-01   2.571 0.010332 *  \n",
       "ins0                   -7.009e-02  2.087e-01  -0.336 0.737110    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.011224)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 16 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.1415082</td><td>0.0744964</td><td>0.2687993</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4196390</td><td>0.2800004</td><td>0.6289167</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.0002868</td><td>1.0001917</td><td>1.0003819</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.1052475</td><td>0.8260959</td><td>1.4787292</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.7881623</td><td>0.4082821</td><td>1.5214966</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.4963896</td><td>0.2398098</td><td>1.0274918</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.7935516</td><td>0.4982405</td><td>1.2638961</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>2.5223968</td><td>1.5444468</td><td>4.1195889</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.5027645</td><td>0.8114546</td><td>2.7830283</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.3647551</td><td>0.7652693</td><td>2.4338573</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.8022674</td><td>1.0779385</td><td>3.0133146</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>2.7220669</td><td>1.5707617</td><td>4.7172325</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>2.4049967</td><td>1.6134489</td><td>3.5848730</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>2.2768702</td><td>1.4851632</td><td>3.4906184</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>2.1282468</td><td>1.1955157</td><td>3.7886869</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>0.9323113</td><td>0.6188911</td><td>1.4044543</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 16 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.1415082 & 0.0744964 & 0.2687993\\\\\n",
       "\tbinge1 & 0.4196390 & 0.2800004 & 0.6289167\\\\\n",
       "\tage\\_sq & 1.0002868 & 1.0001917 & 1.0003819\\\\\n",
       "\tsex1 & 1.1052475 & 0.8260959 & 1.4787292\\\\\n",
       "\traceNon-Hispanic Black & 0.7881623 & 0.4082821 & 1.5214966\\\\\n",
       "\traceNon-Hispanic Other & 0.4963896 & 0.2398098 & 1.0274918\\\\\n",
       "\traceNon-Hispanic White & 0.7935516 & 0.4982405 & 1.2638961\\\\\n",
       "\tinc\\$15k-\\$25k & 2.5223968 & 1.5444468 & 4.1195889\\\\\n",
       "\tinc\\$25k-\\$35k & 1.5027645 & 0.8114546 & 2.7830283\\\\\n",
       "\tinc\\$35k-\\$50k & 1.3647551 & 0.7652693 & 2.4338573\\\\\n",
       "\tinc\\$50k-\\$75k & 1.8022674 & 1.0779385 & 3.0133146\\\\\n",
       "\tinc<\\$15k & 2.7220669 & 1.5707617 & 4.7172325\\\\\n",
       "\teduAttended College & 2.4049967 & 1.6134489 & 3.5848730\\\\\n",
       "\teduHS Graduate & 2.2768702 & 1.4851632 & 3.4906184\\\\\n",
       "\teduLess than HS & 2.1282468 & 1.1955157 & 3.7886869\\\\\n",
       "\tins0 & 0.9323113 & 0.6188911 & 1.4044543\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 16 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.1415082 | 0.0744964 | 0.2687993 |\n",
       "| binge1 | 0.4196390 | 0.2800004 | 0.6289167 |\n",
       "| age_sq | 1.0002868 | 1.0001917 | 1.0003819 |\n",
       "| sex1 | 1.1052475 | 0.8260959 | 1.4787292 |\n",
       "| raceNon-Hispanic Black | 0.7881623 | 0.4082821 | 1.5214966 |\n",
       "| raceNon-Hispanic Other | 0.4963896 | 0.2398098 | 1.0274918 |\n",
       "| raceNon-Hispanic White | 0.7935516 | 0.4982405 | 1.2638961 |\n",
       "| inc$15k-$25k | 2.5223968 | 1.5444468 | 4.1195889 |\n",
       "| inc$25k-$35k | 1.5027645 | 0.8114546 | 2.7830283 |\n",
       "| inc$35k-$50k | 1.3647551 | 0.7652693 | 2.4338573 |\n",
       "| inc$50k-$75k | 1.8022674 | 1.0779385 | 3.0133146 |\n",
       "| inc&lt;$15k | 2.7220669 | 1.5707617 | 4.7172325 |\n",
       "| eduAttended College | 2.4049967 | 1.6134489 | 3.5848730 |\n",
       "| eduHS Graduate | 2.2768702 | 1.4851632 | 3.4906184 |\n",
       "| eduLess than HS | 2.1282468 | 1.1955157 | 3.7886869 |\n",
       "| ins0 | 0.9323113 | 0.6188911 | 1.4044543 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %     97.5 %   \n",
       "(Intercept)            0.1415082 0.0744964 0.2687993\n",
       "binge1                 0.4196390 0.2800004 0.6289167\n",
       "age_sq                 1.0002868 1.0001917 1.0003819\n",
       "sex1                   1.1052475 0.8260959 1.4787292\n",
       "raceNon-Hispanic Black 0.7881623 0.4082821 1.5214966\n",
       "raceNon-Hispanic Other 0.4963896 0.2398098 1.0274918\n",
       "raceNon-Hispanic White 0.7935516 0.4982405 1.2638961\n",
       "inc$15k-$25k           2.5223968 1.5444468 4.1195889\n",
       "inc$25k-$35k           1.5027645 0.8114546 2.7830283\n",
       "inc$35k-$50k           1.3647551 0.7652693 2.4338573\n",
       "inc$50k-$75k           1.8022674 1.0779385 3.0133146\n",
       "inc<$15k               2.7220669 1.5707617 4.7172325\n",
       "eduAttended College    2.4049967 1.6134489 3.5848730\n",
       "eduHS Graduate         2.2768702 1.4851632 3.4906184\n",
       "eduLess than HS        2.1282468 1.1955157 3.7886869\n",
       "ins0                   0.9323113 0.6188911 1.4044543"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_2_badphys <- svyglm(\n",
    "  bad_phys ~ binge + age_sq + sex + race + inc + edu + ins,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_2_badphys)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_2_badphys), confint(model_2_badphys)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a0080079-010d-4394-970d-eeed1d5a3c67",
   "metadata": {},
   "source": [
    "## Model 3: + Health Behaviors & Clinical Conditions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "af70a0d7-87d9-44bb-ab42-34f7dd54d366",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = bad_phys ~ binge + age_sq + sex + race + inc + \n",
       "    edu + ins + emp + marital + home + smoke + heavy + active + \n",
       "    bmi + asthma + arth + copd + chd + diab + kidney + stroke + \n",
       "    disab + MCC + year, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -2.608e+00  4.242e-01  -6.147  1.3e-09 ***\n",
       "binge1                 -5.072e-01  2.396e-01  -2.117 0.034611 *  \n",
       "age_sq                  7.814e-05  6.073e-05   1.287 0.198578    \n",
       "sex1                    1.910e-01  1.661e-01   1.150 0.250661    \n",
       "raceNon-Hispanic Black -5.001e-01  3.398e-01  -1.472 0.141498    \n",
       "raceNon-Hispanic Other -7.541e-01  3.504e-01  -2.152 0.031729 *  \n",
       "raceNon-Hispanic White -4.336e-01  2.350e-01  -1.845 0.065386 .  \n",
       "inc$15k-$25k            2.662e-01  3.013e-01   0.883 0.377361    \n",
       "inc$25k-$35k           -2.390e-02  3.511e-01  -0.068 0.945742    \n",
       "inc$35k-$50k            5.827e-03  3.441e-01   0.017 0.986493    \n",
       "inc$50k-$75k            5.667e-01  2.833e-01   2.001 0.045817 *  \n",
       "inc<$15k                2.347e-01  3.457e-01   0.679 0.497403    \n",
       "eduAttended College     5.510e-01  2.128e-01   2.589 0.009807 ** \n",
       "eduHS Graduate          4.236e-01  2.437e-01   1.738 0.082584 .  \n",
       "eduLess than HS         3.577e-01  3.101e-01   1.153 0.249148    \n",
       "ins0                    9.771e-02  2.298e-01   0.425 0.670885    \n",
       "empNot in Labor Force   6.591e-01  1.884e-01   3.499 0.000496 ***\n",
       "empUnemployed          -6.032e-01  4.765e-01  -1.266 0.205973    \n",
       "maritalCohabiting       5.296e-02  3.844e-01   0.138 0.890462    \n",
       "maritalDivorced        -2.235e-01  2.018e-01  -1.108 0.268317    \n",
       "maritalNever Married   -4.014e-02  2.450e-01  -0.164 0.869882    \n",
       "homeOther               5.138e-01  3.145e-01   1.634 0.102741    \n",
       "homeRent                4.075e-02  1.953e-01   0.209 0.834766    \n",
       "smokeSmoker             2.874e-01  1.645e-01   1.747 0.081005 .  \n",
       "heavyYes               -1.545e-01  3.851e-01  -0.401 0.688414    \n",
       "activeNo                5.200e-01  1.677e-01   3.101 0.002006 ** \n",
       "bmiObese                3.493e-01  1.992e-01   1.754 0.079884 .  \n",
       "bmiOverweight           3.495e-01  2.062e-01   1.695 0.090487 .  \n",
       "asthmaYes               1.639e-01  2.094e-01   0.783 0.434172    \n",
       "arthYes                 7.714e-01  2.065e-01   3.736 0.000202 ***\n",
       "copdYes                 6.346e-01  2.326e-01   2.728 0.006519 ** \n",
       "chdYes                  2.550e-01  3.067e-01   0.831 0.406027    \n",
       "diabYes                 2.385e-01  2.454e-01   0.972 0.331512    \n",
       "kidneyYes               7.430e-01  3.582e-01   2.074 0.038423 *  \n",
       "strokeYes               1.953e-01  3.109e-01   0.628 0.530137    \n",
       "disabYes                9.558e-01  1.907e-01   5.011  6.8e-07 ***\n",
       "MCCYes                 -5.180e-01  3.067e-01  -1.689 0.091634 .  \n",
       "year2014                2.769e-01  2.775e-01   0.998 0.318646    \n",
       "year2015                2.438e-01  2.758e-01   0.884 0.377081    \n",
       "year2016               -1.133e-01  3.082e-01  -0.368 0.713218    \n",
       "year2017               -2.668e-01  2.810e-01  -0.949 0.342781    \n",
       "year2018               -1.508e-01  2.796e-01  -0.539 0.589852    \n",
       "year2019               -3.373e-01  2.695e-01  -1.252 0.211136    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.034207)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.07370505</td><td>0.03204846</td><td>0.1695069</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.60217414</td><td>0.37621016</td><td>0.9638594</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.00007814</td><td>0.99995892</td><td>1.0001974</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.21043929</td><td>0.87358299</td><td>1.6771884</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.60645035</td><td>0.31122391</td><td>1.1817281</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.47045725</td><td>0.23646161</td><td>0.9360083</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.64816006</td><td>0.40863892</td><td>1.0280750</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.30497238</td><td>0.72221473</td><td>2.3579593</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>0.97638202</td><td>0.49008659</td><td>1.9452111</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.00584407</td><td>0.51185932</td><td>1.9765632</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.76244142</td><td>1.01061482</td><td>3.0735743</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.26454853</td><td>0.64145930</td><td>2.4928830</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.73498009</td><td>1.14252214</td><td>2.6346587</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.52746461</td><td>0.94665650</td><td>2.4646196</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.42998964</td><td>0.77789945</td><td>2.6287078</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.10264207</td><td>0.70220230</td><td>1.7314377</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.93297355</td><td>1.33540841</td><td>2.7979356</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>0.54708460</td><td>0.21468215</td><td>1.3941614</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>1.05438710</td><td>0.49572433</td><td>2.2426419</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>0.79967547</td><td>0.53809291</td><td>1.1884209</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>0.96065403</td><td>0.59389203</td><td>1.5539123</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.67157511</td><td>0.90157915</td><td>3.0991881</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.04158790</td><td>0.70991162</td><td>1.5282260</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.33292495</td><td>0.96511160</td><td>1.8409155</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>0.85686906</td><td>0.40235617</td><td>1.8248125</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>1.68199764</td><td>1.21013891</td><td>2.3378441</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>1.41810553</td><td>0.95914530</td><td>2.0966826</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.41837105</td><td>0.94621149</td><td>2.1261382</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>1.17808367</td><td>0.78091072</td><td>1.7772597</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>2.16269730</td><td>1.44192736</td><td>3.2437553</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.88621133</td><td>1.19477401</td><td>2.9777959</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>1.29042582</td><td>0.70672211</td><td>2.3562285</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.26933458</td><td>0.78399640</td><td>2.0551246</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>2.10220858</td><td>1.04051080</td><td>4.2472225</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.21562055</td><td>0.66030676</td><td>2.2379497</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>2.60072219</td><td>1.78843823</td><td>3.7819343</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.59573306</td><td>0.32628042</td><td>1.0877082</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>1.31902897</td><td>0.76502641</td><td>2.2742188</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.27602569</td><td>0.74253168</td><td>2.1928243</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>0.89285470</td><td>0.48749911</td><td>1.6352635</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>0.76583402</td><td>0.44107868</td><td>1.3296987</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>0.86005169</td><td>0.49678295</td><td>1.4889579</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.71368253</td><td>0.42044278</td><td>1.2114437</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.07370505 & 0.03204846 & 0.1695069\\\\\n",
       "\tbinge1 & 0.60217414 & 0.37621016 & 0.9638594\\\\\n",
       "\tage\\_sq & 1.00007814 & 0.99995892 & 1.0001974\\\\\n",
       "\tsex1 & 1.21043929 & 0.87358299 & 1.6771884\\\\\n",
       "\traceNon-Hispanic Black & 0.60645035 & 0.31122391 & 1.1817281\\\\\n",
       "\traceNon-Hispanic Other & 0.47045725 & 0.23646161 & 0.9360083\\\\\n",
       "\traceNon-Hispanic White & 0.64816006 & 0.40863892 & 1.0280750\\\\\n",
       "\tinc\\$15k-\\$25k & 1.30497238 & 0.72221473 & 2.3579593\\\\\n",
       "\tinc\\$25k-\\$35k & 0.97638202 & 0.49008659 & 1.9452111\\\\\n",
       "\tinc\\$35k-\\$50k & 1.00584407 & 0.51185932 & 1.9765632\\\\\n",
       "\tinc\\$50k-\\$75k & 1.76244142 & 1.01061482 & 3.0735743\\\\\n",
       "\tinc<\\$15k & 1.26454853 & 0.64145930 & 2.4928830\\\\\n",
       "\teduAttended College & 1.73498009 & 1.14252214 & 2.6346587\\\\\n",
       "\teduHS Graduate & 1.52746461 & 0.94665650 & 2.4646196\\\\\n",
       "\teduLess than HS & 1.42998964 & 0.77789945 & 2.6287078\\\\\n",
       "\tins0 & 1.10264207 & 0.70220230 & 1.7314377\\\\\n",
       "\tempNot in Labor Force & 1.93297355 & 1.33540841 & 2.7979356\\\\\n",
       "\tempUnemployed & 0.54708460 & 0.21468215 & 1.3941614\\\\\n",
       "\tmaritalCohabiting & 1.05438710 & 0.49572433 & 2.2426419\\\\\n",
       "\tmaritalDivorced & 0.79967547 & 0.53809291 & 1.1884209\\\\\n",
       "\tmaritalNever Married & 0.96065403 & 0.59389203 & 1.5539123\\\\\n",
       "\thomeOther & 1.67157511 & 0.90157915 & 3.0991881\\\\\n",
       "\thomeRent & 1.04158790 & 0.70991162 & 1.5282260\\\\\n",
       "\tsmokeSmoker & 1.33292495 & 0.96511160 & 1.8409155\\\\\n",
       "\theavyYes & 0.85686906 & 0.40235617 & 1.8248125\\\\\n",
       "\tactiveNo & 1.68199764 & 1.21013891 & 2.3378441\\\\\n",
       "\tbmiObese & 1.41810553 & 0.95914530 & 2.0966826\\\\\n",
       "\tbmiOverweight & 1.41837105 & 0.94621149 & 2.1261382\\\\\n",
       "\tasthmaYes & 1.17808367 & 0.78091072 & 1.7772597\\\\\n",
       "\tarthYes & 2.16269730 & 1.44192736 & 3.2437553\\\\\n",
       "\tcopdYes & 1.88621133 & 1.19477401 & 2.9777959\\\\\n",
       "\tchdYes & 1.29042582 & 0.70672211 & 2.3562285\\\\\n",
       "\tdiabYes & 1.26933458 & 0.78399640 & 2.0551246\\\\\n",
       "\tkidneyYes & 2.10220858 & 1.04051080 & 4.2472225\\\\\n",
       "\tstrokeYes & 1.21562055 & 0.66030676 & 2.2379497\\\\\n",
       "\tdisabYes & 2.60072219 & 1.78843823 & 3.7819343\\\\\n",
       "\tMCCYes & 0.59573306 & 0.32628042 & 1.0877082\\\\\n",
       "\tyear2014 & 1.31902897 & 0.76502641 & 2.2742188\\\\\n",
       "\tyear2015 & 1.27602569 & 0.74253168 & 2.1928243\\\\\n",
       "\tyear2016 & 0.89285470 & 0.48749911 & 1.6352635\\\\\n",
       "\tyear2017 & 0.76583402 & 0.44107868 & 1.3296987\\\\\n",
       "\tyear2018 & 0.86005169 & 0.49678295 & 1.4889579\\\\\n",
       "\tyear2019 & 0.71368253 & 0.42044278 & 1.2114437\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.07370505 | 0.03204846 | 0.1695069 |\n",
       "| binge1 | 0.60217414 | 0.37621016 | 0.9638594 |\n",
       "| age_sq | 1.00007814 | 0.99995892 | 1.0001974 |\n",
       "| sex1 | 1.21043929 | 0.87358299 | 1.6771884 |\n",
       "| raceNon-Hispanic Black | 0.60645035 | 0.31122391 | 1.1817281 |\n",
       "| raceNon-Hispanic Other | 0.47045725 | 0.23646161 | 0.9360083 |\n",
       "| raceNon-Hispanic White | 0.64816006 | 0.40863892 | 1.0280750 |\n",
       "| inc$15k-$25k | 1.30497238 | 0.72221473 | 2.3579593 |\n",
       "| inc$25k-$35k | 0.97638202 | 0.49008659 | 1.9452111 |\n",
       "| inc$35k-$50k | 1.00584407 | 0.51185932 | 1.9765632 |\n",
       "| inc$50k-$75k | 1.76244142 | 1.01061482 | 3.0735743 |\n",
       "| inc&lt;$15k | 1.26454853 | 0.64145930 | 2.4928830 |\n",
       "| eduAttended College | 1.73498009 | 1.14252214 | 2.6346587 |\n",
       "| eduHS Graduate | 1.52746461 | 0.94665650 | 2.4646196 |\n",
       "| eduLess than HS | 1.42998964 | 0.77789945 | 2.6287078 |\n",
       "| ins0 | 1.10264207 | 0.70220230 | 1.7314377 |\n",
       "| empNot in Labor Force | 1.93297355 | 1.33540841 | 2.7979356 |\n",
       "| empUnemployed | 0.54708460 | 0.21468215 | 1.3941614 |\n",
       "| maritalCohabiting | 1.05438710 | 0.49572433 | 2.2426419 |\n",
       "| maritalDivorced | 0.79967547 | 0.53809291 | 1.1884209 |\n",
       "| maritalNever Married | 0.96065403 | 0.59389203 | 1.5539123 |\n",
       "| homeOther | 1.67157511 | 0.90157915 | 3.0991881 |\n",
       "| homeRent | 1.04158790 | 0.70991162 | 1.5282260 |\n",
       "| smokeSmoker | 1.33292495 | 0.96511160 | 1.8409155 |\n",
       "| heavyYes | 0.85686906 | 0.40235617 | 1.8248125 |\n",
       "| activeNo | 1.68199764 | 1.21013891 | 2.3378441 |\n",
       "| bmiObese | 1.41810553 | 0.95914530 | 2.0966826 |\n",
       "| bmiOverweight | 1.41837105 | 0.94621149 | 2.1261382 |\n",
       "| asthmaYes | 1.17808367 | 0.78091072 | 1.7772597 |\n",
       "| arthYes | 2.16269730 | 1.44192736 | 3.2437553 |\n",
       "| copdYes | 1.88621133 | 1.19477401 | 2.9777959 |\n",
       "| chdYes | 1.29042582 | 0.70672211 | 2.3562285 |\n",
       "| diabYes | 1.26933458 | 0.78399640 | 2.0551246 |\n",
       "| kidneyYes | 2.10220858 | 1.04051080 | 4.2472225 |\n",
       "| strokeYes | 1.21562055 | 0.66030676 | 2.2379497 |\n",
       "| disabYes | 2.60072219 | 1.78843823 | 3.7819343 |\n",
       "| MCCYes | 0.59573306 | 0.32628042 | 1.0877082 |\n",
       "| year2014 | 1.31902897 | 0.76502641 | 2.2742188 |\n",
       "| year2015 | 1.27602569 | 0.74253168 | 2.1928243 |\n",
       "| year2016 | 0.89285470 | 0.48749911 | 1.6352635 |\n",
       "| year2017 | 0.76583402 | 0.44107868 | 1.3296987 |\n",
       "| year2018 | 0.86005169 | 0.49678295 | 1.4889579 |\n",
       "| year2019 | 0.71368253 | 0.42044278 | 1.2114437 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR         2.5 %      97.5 %   \n",
       "(Intercept)            0.07370505 0.03204846 0.1695069\n",
       "binge1                 0.60217414 0.37621016 0.9638594\n",
       "age_sq                 1.00007814 0.99995892 1.0001974\n",
       "sex1                   1.21043929 0.87358299 1.6771884\n",
       "raceNon-Hispanic Black 0.60645035 0.31122391 1.1817281\n",
       "raceNon-Hispanic Other 0.47045725 0.23646161 0.9360083\n",
       "raceNon-Hispanic White 0.64816006 0.40863892 1.0280750\n",
       "inc$15k-$25k           1.30497238 0.72221473 2.3579593\n",
       "inc$25k-$35k           0.97638202 0.49008659 1.9452111\n",
       "inc$35k-$50k           1.00584407 0.51185932 1.9765632\n",
       "inc$50k-$75k           1.76244142 1.01061482 3.0735743\n",
       "inc<$15k               1.26454853 0.64145930 2.4928830\n",
       "eduAttended College    1.73498009 1.14252214 2.6346587\n",
       "eduHS Graduate         1.52746461 0.94665650 2.4646196\n",
       "eduLess than HS        1.42998964 0.77789945 2.6287078\n",
       "ins0                   1.10264207 0.70220230 1.7314377\n",
       "empNot in Labor Force  1.93297355 1.33540841 2.7979356\n",
       "empUnemployed          0.54708460 0.21468215 1.3941614\n",
       "maritalCohabiting      1.05438710 0.49572433 2.2426419\n",
       "maritalDivorced        0.79967547 0.53809291 1.1884209\n",
       "maritalNever Married   0.96065403 0.59389203 1.5539123\n",
       "homeOther              1.67157511 0.90157915 3.0991881\n",
       "homeRent               1.04158790 0.70991162 1.5282260\n",
       "smokeSmoker            1.33292495 0.96511160 1.8409155\n",
       "heavyYes               0.85686906 0.40235617 1.8248125\n",
       "activeNo               1.68199764 1.21013891 2.3378441\n",
       "bmiObese               1.41810553 0.95914530 2.0966826\n",
       "bmiOverweight          1.41837105 0.94621149 2.1261382\n",
       "asthmaYes              1.17808367 0.78091072 1.7772597\n",
       "arthYes                2.16269730 1.44192736 3.2437553\n",
       "copdYes                1.88621133 1.19477401 2.9777959\n",
       "chdYes                 1.29042582 0.70672211 2.3562285\n",
       "diabYes                1.26933458 0.78399640 2.0551246\n",
       "kidneyYes              2.10220858 1.04051080 4.2472225\n",
       "strokeYes              1.21562055 0.66030676 2.2379497\n",
       "disabYes               2.60072219 1.78843823 3.7819343\n",
       "MCCYes                 0.59573306 0.32628042 1.0877082\n",
       "year2014               1.31902897 0.76502641 2.2742188\n",
       "year2015               1.27602569 0.74253168 2.1928243\n",
       "year2016               0.89285470 0.48749911 1.6352635\n",
       "year2017               0.76583402 0.44107868 1.3296987\n",
       "year2018               0.86005169 0.49678295 1.4889579\n",
       "year2019               0.71368253 0.42044278 1.2114437"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_3_badphys <- svyglm(\n",
    "  bad_phys ~ binge + age_sq + sex + race + inc + edu + ins +\n",
    "    emp + marital + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke +\n",
    "    disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_3_badphys)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_3_badphys), confint(model_3_badphys)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7667ff8a-3c82-452c-bd23-77dfe68aaf9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "library(gtsummary)\n",
    "library(gt)\n",
    "\n",
    "# Step 1: Individual model tables for Bad Physical Health\n",
    "tbl_model_base_bph <- tbl_regression(model_base_badphys, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_1_bph <- tbl_regression(model_1_badphys, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_2_bph <- tbl_regression(model_2_badphys, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_3_bph <- tbl_regression(model_3_badphys, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "# Step 2: Merge into a single table\n",
    "tbl_bph_combined <- tbl_merge(\n",
    "  tbls = list(tbl_model_base_bph, tbl_model_1_bph, tbl_model_2_bph, tbl_model_3_bph),\n",
    "  tab_spanner = c(\"**Model 0: Binge only**\", \"**Model 1: + Demographics**\",\n",
    "                  \"**Model 2: + SES**\", \"**Model 3: + Full Model**\")\n",
    ")\n",
    "\n",
    "# Save to HTML\n",
    "as_gt(tbl_bph_combined) %>%\n",
    "  gtsave(\"C:/Users/chava/Downloads/Recent_Research_Activity/Output/bph_models.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f0ed4d73-3bb3-40c2-8072-1fbbf9540d5b",
   "metadata": {},
   "source": [
    "# Step 11C: Nested Survey-Weighted Logistic Models for Activity Limitation\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d514184b-8a83-480b-927c-d04ef851c55a",
   "metadata": {},
   "source": [
    "## Model 0: Binge Drinking Only"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "ae027590-da4d-4e6b-89c3-eddaeb371f55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge, design = brfss_svy, \n",
       "    family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "            Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept) -0.14359    0.07832  -1.833   0.0671 .  \n",
       "binge1      -0.95213    0.19414  -4.904 1.14e-06 ***\n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.000362)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 2 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.8662414</td><td>0.7427893</td><td>1.010211</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.3859201</td><td>0.2636253</td><td>0.564947</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 2 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.8662414 & 0.7427893 & 1.010211\\\\\n",
       "\tbinge1 & 0.3859201 & 0.2636253 & 0.564947\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 2 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.8662414 | 0.7427893 | 1.010211 |\n",
       "| binge1 | 0.3859201 | 0.2636253 | 0.564947 |\n",
       "\n"
      ],
      "text/plain": [
       "            OR        2.5 %     97.5 %  \n",
       "(Intercept) 0.8662414 0.7427893 1.010211\n",
       "binge1      0.3859201 0.2636253 0.564947"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_base_activity <- svyglm(\n",
    "  activity_limit ~ binge,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_base_activity)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_base_activity), confint(model_base_activity)))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7322a99e-1a32-4260-83eb-018187c10685",
   "metadata": {},
   "source": [
    "## Model 1: + Demographics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "c8758daf-bbc6-4cea-b9a7-f64407292adc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge + age_sq + sex + race, \n",
       "    design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -4.972e-01  2.541e-01  -1.957  0.05075 .  \n",
       "binge1                 -8.437e-01  1.956e-01  -4.314 1.82e-05 ***\n",
       "age_sq                  1.983e-04  4.473e-05   4.434 1.06e-05 ***\n",
       "sex1                    4.244e-01  1.492e-01   2.844  0.00458 ** \n",
       "raceNon-Hispanic Black  1.114e-01  3.325e-01   0.335  0.73781    \n",
       "raceNon-Hispanic Other -6.327e-01  3.595e-01  -1.760  0.07878 .  \n",
       "raceNon-Hispanic White -4.600e-01  2.422e-01  -1.899  0.05791 .  \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 0.9975501)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 7 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.6082244</td><td>0.3693386</td><td>1.0016201</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4301186</td><td>0.2929796</td><td>0.6314502</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.0001984</td><td>1.0001105</td><td>1.0002862</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.5286253</td><td>1.1404442</td><td>2.0489344</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.1178026</td><td>0.5818985</td><td>2.1472520</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.5311491</td><td>0.2622724</td><td>1.0756732</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.6313130</td><td>0.3924444</td><td>1.0155735</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 7 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.6082244 & 0.3693386 & 1.0016201\\\\\n",
       "\tbinge1 & 0.4301186 & 0.2929796 & 0.6314502\\\\\n",
       "\tage\\_sq & 1.0001984 & 1.0001105 & 1.0002862\\\\\n",
       "\tsex1 & 1.5286253 & 1.1404442 & 2.0489344\\\\\n",
       "\traceNon-Hispanic Black & 1.1178026 & 0.5818985 & 2.1472520\\\\\n",
       "\traceNon-Hispanic Other & 0.5311491 & 0.2622724 & 1.0756732\\\\\n",
       "\traceNon-Hispanic White & 0.6313130 & 0.3924444 & 1.0155735\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 7 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.6082244 | 0.3693386 | 1.0016201 |\n",
       "| binge1 | 0.4301186 | 0.2929796 | 0.6314502 |\n",
       "| age_sq | 1.0001984 | 1.0001105 | 1.0002862 |\n",
       "| sex1 | 1.5286253 | 1.1404442 | 2.0489344 |\n",
       "| raceNon-Hispanic Black | 1.1178026 | 0.5818985 | 2.1472520 |\n",
       "| raceNon-Hispanic Other | 0.5311491 | 0.2622724 | 1.0756732 |\n",
       "| raceNon-Hispanic White | 0.6313130 | 0.3924444 | 1.0155735 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %     97.5 %   \n",
       "(Intercept)            0.6082244 0.3693386 1.0016201\n",
       "binge1                 0.4301186 0.2929796 0.6314502\n",
       "age_sq                 1.0001984 1.0001105 1.0002862\n",
       "sex1                   1.5286253 1.1404442 2.0489344\n",
       "raceNon-Hispanic Black 1.1178026 0.5818985 2.1472520\n",
       "raceNon-Hispanic Other 0.5311491 0.2622724 1.0756732\n",
       "raceNon-Hispanic White 0.6313130 0.3924444 1.0155735"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_1_activity <- svyglm(\n",
    "  activity_limit ~ binge + age_sq + sex + race,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_1_activity)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_1_activity), confint(model_1_activity)))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "839125db-d3e0-41be-9a1e-74f612b852d4",
   "metadata": {},
   "source": [
    "## Model 2: + Socioeconomic Factors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "id": "6998c654-5846-4bb8-8e1f-fd4b3be94090",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge + age_sq + sex + race + \n",
       "    inc + edu + ins, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -1.967e+00  3.299e-01  -5.963 3.80e-09 ***\n",
       "binge1                 -8.851e-01  2.041e-01  -4.336 1.65e-05 ***\n",
       "age_sq                  1.910e-04  4.798e-05   3.982 7.51e-05 ***\n",
       "sex1                    4.077e-01  1.501e-01   2.716  0.00675 ** \n",
       "raceNon-Hispanic Black  5.628e-02  3.418e-01   0.165  0.86927    \n",
       "raceNon-Hispanic Other -5.603e-01  3.989e-01  -1.405  0.16050    \n",
       "raceNon-Hispanic White -2.423e-01  2.464e-01  -0.983  0.32583    \n",
       "inc$15k-$25k            1.171e+00  2.573e-01   4.553 6.17e-06 ***\n",
       "inc$25k-$35k            8.084e-01  3.154e-01   2.563  0.01056 *  \n",
       "inc$35k-$50k            6.049e-01  2.837e-01   2.132  0.03331 *  \n",
       "inc$50k-$75k            6.524e-01  2.601e-01   2.508  0.01235 *  \n",
       "inc<$15k                1.472e+00  2.731e-01   5.391 9.36e-08 ***\n",
       "eduAttended College     5.837e-01  1.984e-01   2.942  0.00336 ** \n",
       "eduHS Graduate          6.568e-01  2.118e-01   3.101  0.00200 ** \n",
       "eduLess than HS         5.805e-01  2.772e-01   2.094  0.03657 *  \n",
       "ins0                    1.843e-02  2.366e-01   0.078  0.93793    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.006985)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 16 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.1398607</td><td>0.07319027</td><td>0.2672623</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4126885</td><td>0.27643453</td><td>0.6161017</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.0001911</td><td>1.00009685</td><td>1.0002853</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.5033762</td><td>1.11968512</td><td>2.0185498</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.0578956</td><td>0.54075216</td><td>2.0696045</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.5710202</td><td>0.26096228</td><td>1.2494681</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.7848493</td><td>0.48384548</td><td>1.2731097</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>3.2267853</td><td>1.94717851</td><td>5.3472979</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>2.2442819</td><td>1.20839463</td><td>4.1681757</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.8310162</td><td>1.04913264</td><td>3.1956115</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.9201314</td><td>1.15226912</td><td>3.1996906</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>4.3593490</td><td>2.55034431</td><td>7.4515130</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.7926904</td><td>1.21443433</td><td>2.6462847</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.9285914</td><td>1.27250937</td><td>2.9229370</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.7869554</td><td>1.03702173</td><td>3.0792119</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.0186028</td><td>0.64012566</td><td>1.6208563</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 16 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.1398607 & 0.07319027 & 0.2672623\\\\\n",
       "\tbinge1 & 0.4126885 & 0.27643453 & 0.6161017\\\\\n",
       "\tage\\_sq & 1.0001911 & 1.00009685 & 1.0002853\\\\\n",
       "\tsex1 & 1.5033762 & 1.11968512 & 2.0185498\\\\\n",
       "\traceNon-Hispanic Black & 1.0578956 & 0.54075216 & 2.0696045\\\\\n",
       "\traceNon-Hispanic Other & 0.5710202 & 0.26096228 & 1.2494681\\\\\n",
       "\traceNon-Hispanic White & 0.7848493 & 0.48384548 & 1.2731097\\\\\n",
       "\tinc\\$15k-\\$25k & 3.2267853 & 1.94717851 & 5.3472979\\\\\n",
       "\tinc\\$25k-\\$35k & 2.2442819 & 1.20839463 & 4.1681757\\\\\n",
       "\tinc\\$35k-\\$50k & 1.8310162 & 1.04913264 & 3.1956115\\\\\n",
       "\tinc\\$50k-\\$75k & 1.9201314 & 1.15226912 & 3.1996906\\\\\n",
       "\tinc<\\$15k & 4.3593490 & 2.55034431 & 7.4515130\\\\\n",
       "\teduAttended College & 1.7926904 & 1.21443433 & 2.6462847\\\\\n",
       "\teduHS Graduate & 1.9285914 & 1.27250937 & 2.9229370\\\\\n",
       "\teduLess than HS & 1.7869554 & 1.03702173 & 3.0792119\\\\\n",
       "\tins0 & 1.0186028 & 0.64012566 & 1.6208563\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 16 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.1398607 | 0.07319027 | 0.2672623 |\n",
       "| binge1 | 0.4126885 | 0.27643453 | 0.6161017 |\n",
       "| age_sq | 1.0001911 | 1.00009685 | 1.0002853 |\n",
       "| sex1 | 1.5033762 | 1.11968512 | 2.0185498 |\n",
       "| raceNon-Hispanic Black | 1.0578956 | 0.54075216 | 2.0696045 |\n",
       "| raceNon-Hispanic Other | 0.5710202 | 0.26096228 | 1.2494681 |\n",
       "| raceNon-Hispanic White | 0.7848493 | 0.48384548 | 1.2731097 |\n",
       "| inc$15k-$25k | 3.2267853 | 1.94717851 | 5.3472979 |\n",
       "| inc$25k-$35k | 2.2442819 | 1.20839463 | 4.1681757 |\n",
       "| inc$35k-$50k | 1.8310162 | 1.04913264 | 3.1956115 |\n",
       "| inc$50k-$75k | 1.9201314 | 1.15226912 | 3.1996906 |\n",
       "| inc&lt;$15k | 4.3593490 | 2.55034431 | 7.4515130 |\n",
       "| eduAttended College | 1.7926904 | 1.21443433 | 2.6462847 |\n",
       "| eduHS Graduate | 1.9285914 | 1.27250937 | 2.9229370 |\n",
       "| eduLess than HS | 1.7869554 | 1.03702173 | 3.0792119 |\n",
       "| ins0 | 1.0186028 | 0.64012566 | 1.6208563 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %      97.5 %   \n",
       "(Intercept)            0.1398607 0.07319027 0.2672623\n",
       "binge1                 0.4126885 0.27643453 0.6161017\n",
       "age_sq                 1.0001911 1.00009685 1.0002853\n",
       "sex1                   1.5033762 1.11968512 2.0185498\n",
       "raceNon-Hispanic Black 1.0578956 0.54075216 2.0696045\n",
       "raceNon-Hispanic Other 0.5710202 0.26096228 1.2494681\n",
       "raceNon-Hispanic White 0.7848493 0.48384548 1.2731097\n",
       "inc$15k-$25k           3.2267853 1.94717851 5.3472979\n",
       "inc$25k-$35k           2.2442819 1.20839463 4.1681757\n",
       "inc$35k-$50k           1.8310162 1.04913264 3.1956115\n",
       "inc$50k-$75k           1.9201314 1.15226912 3.1996906\n",
       "inc<$15k               4.3593490 2.55034431 7.4515130\n",
       "eduAttended College    1.7926904 1.21443433 2.6462847\n",
       "eduHS Graduate         1.9285914 1.27250937 2.9229370\n",
       "eduLess than HS        1.7869554 1.03702173 3.0792119\n",
       "ins0                   1.0186028 0.64012566 1.6208563"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_2_activity <- svyglm(\n",
    "  activity_limit ~ binge + age_sq + sex + race + inc + edu + ins,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_2_activity)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_2_activity), confint(model_2_activity)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cf36de87-ca6b-46b5-bc24-9303ee2f8698",
   "metadata": {},
   "source": [
    "## Model 3: + Health Behaviors & Chronic Conditions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "a73e0c21-1cee-469f-9eeb-3c4406672812",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge + age_sq + sex + race + \n",
       "    inc + edu + ins + emp + marital + home + smoke + heavy + \n",
       "    active + bmi + asthma + arth + copd + chd + diab + kidney + \n",
       "    stroke + disab + MCC + year, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -2.293e+00  4.448e-01  -5.155 3.28e-07 ***\n",
       "binge1                 -7.560e-01  2.497e-01  -3.028 0.002551 ** \n",
       "age_sq                 -2.252e-05  6.315e-05  -0.357 0.721531    \n",
       "sex1                    4.662e-01  1.661e-01   2.806 0.005145 ** \n",
       "raceNon-Hispanic Black -4.304e-01  3.727e-01  -1.155 0.248603    \n",
       "raceNon-Hispanic Other -5.885e-01  3.691e-01  -1.595 0.111217    \n",
       "raceNon-Hispanic White -5.463e-01  2.567e-01  -2.128 0.033655 *  \n",
       "inc$15k-$25k            3.612e-01  3.036e-01   1.190 0.234525    \n",
       "inc$25k-$35k            2.641e-01  3.304e-01   0.800 0.424237    \n",
       "inc$35k-$50k            2.444e-01  3.378e-01   0.724 0.469569    \n",
       "inc$50k-$75k            5.180e-01  2.929e-01   1.768 0.077424 .  \n",
       "inc<$15k                5.457e-01  3.395e-01   1.607 0.108390    \n",
       "eduAttended College     2.189e-01  2.137e-01   1.024 0.306149    \n",
       "eduHS Graduate          2.060e-01  2.326e-01   0.886 0.376028    \n",
       "eduLess than HS         1.216e-01  2.949e-01   0.412 0.680242    \n",
       "ins0                    1.510e-01  2.384e-01   0.633 0.526835    \n",
       "empNot in Labor Force   5.852e-01  1.869e-01   3.132 0.001807 ** \n",
       "empUnemployed           9.877e-01  4.126e-01   2.394 0.016916 *  \n",
       "maritalCohabiting      -2.381e-01  3.696e-01  -0.644 0.519671    \n",
       "maritalDivorced         7.086e-02  1.976e-01   0.359 0.719965    \n",
       "maritalNever Married    1.070e-01  2.460e-01   0.435 0.663788    \n",
       "homeOther               5.129e-01  3.306e-01   1.552 0.121211    \n",
       "homeRent                6.585e-03  1.847e-01   0.036 0.971562    \n",
       "smokeSmoker             4.524e-01  1.655e-01   2.733 0.006421 ** \n",
       "heavyYes                3.955e-01  3.530e-01   1.120 0.262891    \n",
       "activeNo                5.903e-01  1.698e-01   3.476 0.000539 ***\n",
       "bmiObese               -8.797e-02  2.024e-01  -0.435 0.663948    \n",
       "bmiOverweight           6.249e-02  2.029e-01   0.308 0.758216    \n",
       "asthmaYes              -1.399e-01  2.166e-01  -0.646 0.518524    \n",
       "arthYes                 6.976e-01  2.181e-01   3.198 0.001442 ** \n",
       "copdYes                 1.669e-01  2.464e-01   0.677 0.498353    \n",
       "chdYes                  6.008e-02  3.049e-01   0.197 0.843840    \n",
       "diabYes                 5.482e-01  2.498e-01   2.195 0.028501 *  \n",
       "kidneyYes               2.402e-01  4.244e-01   0.566 0.571627    \n",
       "strokeYes               3.683e-01  2.736e-01   1.346 0.178650    \n",
       "disabYes                1.363e+00  1.936e-01   7.044 4.35e-12 ***\n",
       "MCCYes                 -4.335e-01  3.187e-01  -1.360 0.174149    \n",
       "year2014               -5.884e-02  2.811e-01  -0.209 0.834243    \n",
       "year2015                1.175e-01  2.657e-01   0.442 0.658379    \n",
       "year2016               -4.687e-01  2.942e-01  -1.593 0.111590    \n",
       "year2017               -2.484e-01  2.825e-01  -0.879 0.379525    \n",
       "year2018               -3.755e-01  2.834e-01  -1.325 0.185625    \n",
       "year2019               -4.033e-01  2.858e-01  -1.411 0.158587    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 0.9853925)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.1009712</td><td>0.04216294</td><td>0.2418042</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4695612</td><td>0.28761775</td><td>0.7666000</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>0.9999775</td><td>0.99985352</td><td>1.0001015</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.5939752</td><td>1.15035766</td><td>2.2086669</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.6502540</td><td>0.31280751</td><td>1.3517265</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.5551343</td><td>0.26898230</td><td>1.1457041</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.5790755</td><td>0.34983564</td><td>0.9585314</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.4350388</td><td>0.79072109</td><td>2.6043776</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.3023127</td><td>0.68082821</td><td>2.4911108</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.2769025</td><td>0.65783812</td><td>2.4785427</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.6786056</td><td>0.94451160</td><td>2.9832527</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.7258773</td><td>0.88622025</td><td>3.3610745</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.2446707</td><td>0.81813319</td><td>1.8935856</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.2288130</td><td>0.77830628</td><td>1.9400865</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.1292872</td><td>0.63294526</td><td>2.0148495</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.1629481</td><td>0.72823977</td><td>1.8571469</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.7953730</td><td>1.24403107</td><td>2.5910641</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>2.6850689</td><td>1.19451842</td><td>6.0355660</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>0.7881241</td><td>0.38145536</td><td>1.6283413</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>1.0734269</td><td>0.72832031</td><td>1.5820584</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>1.1129220</td><td>0.68658858</td><td>1.8039847</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.6701422</td><td>0.87275168</td><td>3.1960696</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.0066072</td><td>0.70050410</td><td>1.4464698</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.5720393</td><td>1.13594092</td><td>2.1755601</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>1.4850775</td><td>0.74270014</td><td>2.9695097</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>1.8045226</td><td>1.29290392</td><td>2.5185954</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>0.9157858</td><td>0.61549144</td><td>1.3625918</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.0644837</td><td>0.71468908</td><td>1.5854803</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>0.8694207</td><td>0.56823448</td><td>1.3302473</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>2.0089009</td><td>1.30915906</td><td>3.0826527</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.1816853</td><td>0.72842444</td><td>1.9169869</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>1.0619203</td><td>0.58363344</td><td>1.9321627</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.7300586</td><td>1.05951584</td><td>2.8249722</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>1.2714831</td><td>0.55263968</td><td>2.9253586</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.4452423</td><td>0.84468496</td><td>2.4727862</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>3.9098029</td><td>2.67369400</td><td>5.7173929</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.6482142</td><td>0.34672769</td><td>1.2118490</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>0.9428615</td><td>0.54301521</td><td>1.6371324</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.1247221</td><td>0.66755625</td><td>1.8949712</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>0.6258374</td><td>0.35125423</td><td>1.1150682</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>0.7800636</td><td>0.44801014</td><td>1.3582265</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>0.6869541</td><td>0.39380805</td><td>1.1983145</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.6680906</td><td>0.38121068</td><td>1.1708618</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.1009712 & 0.04216294 & 0.2418042\\\\\n",
       "\tbinge1 & 0.4695612 & 0.28761775 & 0.7666000\\\\\n",
       "\tage\\_sq & 0.9999775 & 0.99985352 & 1.0001015\\\\\n",
       "\tsex1 & 1.5939752 & 1.15035766 & 2.2086669\\\\\n",
       "\traceNon-Hispanic Black & 0.6502540 & 0.31280751 & 1.3517265\\\\\n",
       "\traceNon-Hispanic Other & 0.5551343 & 0.26898230 & 1.1457041\\\\\n",
       "\traceNon-Hispanic White & 0.5790755 & 0.34983564 & 0.9585314\\\\\n",
       "\tinc\\$15k-\\$25k & 1.4350388 & 0.79072109 & 2.6043776\\\\\n",
       "\tinc\\$25k-\\$35k & 1.3023127 & 0.68082821 & 2.4911108\\\\\n",
       "\tinc\\$35k-\\$50k & 1.2769025 & 0.65783812 & 2.4785427\\\\\n",
       "\tinc\\$50k-\\$75k & 1.6786056 & 0.94451160 & 2.9832527\\\\\n",
       "\tinc<\\$15k & 1.7258773 & 0.88622025 & 3.3610745\\\\\n",
       "\teduAttended College & 1.2446707 & 0.81813319 & 1.8935856\\\\\n",
       "\teduHS Graduate & 1.2288130 & 0.77830628 & 1.9400865\\\\\n",
       "\teduLess than HS & 1.1292872 & 0.63294526 & 2.0148495\\\\\n",
       "\tins0 & 1.1629481 & 0.72823977 & 1.8571469\\\\\n",
       "\tempNot in Labor Force & 1.7953730 & 1.24403107 & 2.5910641\\\\\n",
       "\tempUnemployed & 2.6850689 & 1.19451842 & 6.0355660\\\\\n",
       "\tmaritalCohabiting & 0.7881241 & 0.38145536 & 1.6283413\\\\\n",
       "\tmaritalDivorced & 1.0734269 & 0.72832031 & 1.5820584\\\\\n",
       "\tmaritalNever Married & 1.1129220 & 0.68658858 & 1.8039847\\\\\n",
       "\thomeOther & 1.6701422 & 0.87275168 & 3.1960696\\\\\n",
       "\thomeRent & 1.0066072 & 0.70050410 & 1.4464698\\\\\n",
       "\tsmokeSmoker & 1.5720393 & 1.13594092 & 2.1755601\\\\\n",
       "\theavyYes & 1.4850775 & 0.74270014 & 2.9695097\\\\\n",
       "\tactiveNo & 1.8045226 & 1.29290392 & 2.5185954\\\\\n",
       "\tbmiObese & 0.9157858 & 0.61549144 & 1.3625918\\\\\n",
       "\tbmiOverweight & 1.0644837 & 0.71468908 & 1.5854803\\\\\n",
       "\tasthmaYes & 0.8694207 & 0.56823448 & 1.3302473\\\\\n",
       "\tarthYes & 2.0089009 & 1.30915906 & 3.0826527\\\\\n",
       "\tcopdYes & 1.1816853 & 0.72842444 & 1.9169869\\\\\n",
       "\tchdYes & 1.0619203 & 0.58363344 & 1.9321627\\\\\n",
       "\tdiabYes & 1.7300586 & 1.05951584 & 2.8249722\\\\\n",
       "\tkidneyYes & 1.2714831 & 0.55263968 & 2.9253586\\\\\n",
       "\tstrokeYes & 1.4452423 & 0.84468496 & 2.4727862\\\\\n",
       "\tdisabYes & 3.9098029 & 2.67369400 & 5.7173929\\\\\n",
       "\tMCCYes & 0.6482142 & 0.34672769 & 1.2118490\\\\\n",
       "\tyear2014 & 0.9428615 & 0.54301521 & 1.6371324\\\\\n",
       "\tyear2015 & 1.1247221 & 0.66755625 & 1.8949712\\\\\n",
       "\tyear2016 & 0.6258374 & 0.35125423 & 1.1150682\\\\\n",
       "\tyear2017 & 0.7800636 & 0.44801014 & 1.3582265\\\\\n",
       "\tyear2018 & 0.6869541 & 0.39380805 & 1.1983145\\\\\n",
       "\tyear2019 & 0.6680906 & 0.38121068 & 1.1708618\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.1009712 | 0.04216294 | 0.2418042 |\n",
       "| binge1 | 0.4695612 | 0.28761775 | 0.7666000 |\n",
       "| age_sq | 0.9999775 | 0.99985352 | 1.0001015 |\n",
       "| sex1 | 1.5939752 | 1.15035766 | 2.2086669 |\n",
       "| raceNon-Hispanic Black | 0.6502540 | 0.31280751 | 1.3517265 |\n",
       "| raceNon-Hispanic Other | 0.5551343 | 0.26898230 | 1.1457041 |\n",
       "| raceNon-Hispanic White | 0.5790755 | 0.34983564 | 0.9585314 |\n",
       "| inc$15k-$25k | 1.4350388 | 0.79072109 | 2.6043776 |\n",
       "| inc$25k-$35k | 1.3023127 | 0.68082821 | 2.4911108 |\n",
       "| inc$35k-$50k | 1.2769025 | 0.65783812 | 2.4785427 |\n",
       "| inc$50k-$75k | 1.6786056 | 0.94451160 | 2.9832527 |\n",
       "| inc&lt;$15k | 1.7258773 | 0.88622025 | 3.3610745 |\n",
       "| eduAttended College | 1.2446707 | 0.81813319 | 1.8935856 |\n",
       "| eduHS Graduate | 1.2288130 | 0.77830628 | 1.9400865 |\n",
       "| eduLess than HS | 1.1292872 | 0.63294526 | 2.0148495 |\n",
       "| ins0 | 1.1629481 | 0.72823977 | 1.8571469 |\n",
       "| empNot in Labor Force | 1.7953730 | 1.24403107 | 2.5910641 |\n",
       "| empUnemployed | 2.6850689 | 1.19451842 | 6.0355660 |\n",
       "| maritalCohabiting | 0.7881241 | 0.38145536 | 1.6283413 |\n",
       "| maritalDivorced | 1.0734269 | 0.72832031 | 1.5820584 |\n",
       "| maritalNever Married | 1.1129220 | 0.68658858 | 1.8039847 |\n",
       "| homeOther | 1.6701422 | 0.87275168 | 3.1960696 |\n",
       "| homeRent | 1.0066072 | 0.70050410 | 1.4464698 |\n",
       "| smokeSmoker | 1.5720393 | 1.13594092 | 2.1755601 |\n",
       "| heavyYes | 1.4850775 | 0.74270014 | 2.9695097 |\n",
       "| activeNo | 1.8045226 | 1.29290392 | 2.5185954 |\n",
       "| bmiObese | 0.9157858 | 0.61549144 | 1.3625918 |\n",
       "| bmiOverweight | 1.0644837 | 0.71468908 | 1.5854803 |\n",
       "| asthmaYes | 0.8694207 | 0.56823448 | 1.3302473 |\n",
       "| arthYes | 2.0089009 | 1.30915906 | 3.0826527 |\n",
       "| copdYes | 1.1816853 | 0.72842444 | 1.9169869 |\n",
       "| chdYes | 1.0619203 | 0.58363344 | 1.9321627 |\n",
       "| diabYes | 1.7300586 | 1.05951584 | 2.8249722 |\n",
       "| kidneyYes | 1.2714831 | 0.55263968 | 2.9253586 |\n",
       "| strokeYes | 1.4452423 | 0.84468496 | 2.4727862 |\n",
       "| disabYes | 3.9098029 | 2.67369400 | 5.7173929 |\n",
       "| MCCYes | 0.6482142 | 0.34672769 | 1.2118490 |\n",
       "| year2014 | 0.9428615 | 0.54301521 | 1.6371324 |\n",
       "| year2015 | 1.1247221 | 0.66755625 | 1.8949712 |\n",
       "| year2016 | 0.6258374 | 0.35125423 | 1.1150682 |\n",
       "| year2017 | 0.7800636 | 0.44801014 | 1.3582265 |\n",
       "| year2018 | 0.6869541 | 0.39380805 | 1.1983145 |\n",
       "| year2019 | 0.6680906 | 0.38121068 | 1.1708618 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %      97.5 %   \n",
       "(Intercept)            0.1009712 0.04216294 0.2418042\n",
       "binge1                 0.4695612 0.28761775 0.7666000\n",
       "age_sq                 0.9999775 0.99985352 1.0001015\n",
       "sex1                   1.5939752 1.15035766 2.2086669\n",
       "raceNon-Hispanic Black 0.6502540 0.31280751 1.3517265\n",
       "raceNon-Hispanic Other 0.5551343 0.26898230 1.1457041\n",
       "raceNon-Hispanic White 0.5790755 0.34983564 0.9585314\n",
       "inc$15k-$25k           1.4350388 0.79072109 2.6043776\n",
       "inc$25k-$35k           1.3023127 0.68082821 2.4911108\n",
       "inc$35k-$50k           1.2769025 0.65783812 2.4785427\n",
       "inc$50k-$75k           1.6786056 0.94451160 2.9832527\n",
       "inc<$15k               1.7258773 0.88622025 3.3610745\n",
       "eduAttended College    1.2446707 0.81813319 1.8935856\n",
       "eduHS Graduate         1.2288130 0.77830628 1.9400865\n",
       "eduLess than HS        1.1292872 0.63294526 2.0148495\n",
       "ins0                   1.1629481 0.72823977 1.8571469\n",
       "empNot in Labor Force  1.7953730 1.24403107 2.5910641\n",
       "empUnemployed          2.6850689 1.19451842 6.0355660\n",
       "maritalCohabiting      0.7881241 0.38145536 1.6283413\n",
       "maritalDivorced        1.0734269 0.72832031 1.5820584\n",
       "maritalNever Married   1.1129220 0.68658858 1.8039847\n",
       "homeOther              1.6701422 0.87275168 3.1960696\n",
       "homeRent               1.0066072 0.70050410 1.4464698\n",
       "smokeSmoker            1.5720393 1.13594092 2.1755601\n",
       "heavyYes               1.4850775 0.74270014 2.9695097\n",
       "activeNo               1.8045226 1.29290392 2.5185954\n",
       "bmiObese               0.9157858 0.61549144 1.3625918\n",
       "bmiOverweight          1.0644837 0.71468908 1.5854803\n",
       "asthmaYes              0.8694207 0.56823448 1.3302473\n",
       "arthYes                2.0089009 1.30915906 3.0826527\n",
       "copdYes                1.1816853 0.72842444 1.9169869\n",
       "chdYes                 1.0619203 0.58363344 1.9321627\n",
       "diabYes                1.7300586 1.05951584 2.8249722\n",
       "kidneyYes              1.2714831 0.55263968 2.9253586\n",
       "strokeYes              1.4452423 0.84468496 2.4727862\n",
       "disabYes               3.9098029 2.67369400 5.7173929\n",
       "MCCYes                 0.6482142 0.34672769 1.2118490\n",
       "year2014               0.9428615 0.54301521 1.6371324\n",
       "year2015               1.1247221 0.66755625 1.8949712\n",
       "year2016               0.6258374 0.35125423 1.1150682\n",
       "year2017               0.7800636 0.44801014 1.3582265\n",
       "year2018               0.6869541 0.39380805 1.1983145\n",
       "year2019               0.6680906 0.38121068 1.1708618"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model_3_activity <- svyglm(\n",
    "  activity_limit ~ binge + age_sq + sex + race + inc + edu + ins +\n",
    "    emp + marital + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke +\n",
    "    disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "summary(model_3_activity)\n",
    "\n",
    "# Exponentiate coefficients for odds ratios\n",
    "exp(cbind(OR = coef(model_3_activity), confint(model_3_activity)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "67aba566-2940-47e4-b290-8e1637e2a597",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Step 1: Individual model tables for Activity Limitation\n",
    "tbl_model_base_al <- tbl_regression(model_base_activity, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_1_al <- tbl_regression(model_1_activity, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_2_al <- tbl_regression(model_2_activity, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "tbl_model_3_al <- tbl_regression(model_3_activity, exponentiate = TRUE, label = list(binge ~ \"Binge\")) %>%\n",
    "  modify_header(label = \"**Variable**\", estimate = \"**OR**\") %>%\n",
    "  bold_labels()\n",
    "\n",
    "# Step 2: Merge into a single table\n",
    "tbl_al_combined <- tbl_merge(\n",
    "  tbls = list(tbl_model_base_al, tbl_model_1_al, tbl_model_2_al, tbl_model_3_al),\n",
    "  tab_spanner = c(\"**Model 0: Binge only**\", \"**Model 1: + Demographics**\",\n",
    "                  \"**Model 2: + SES**\", \"**Model 3: + Full Model**\")\n",
    ")\n",
    "\n",
    "# Save to HTML\n",
    "as_gt(tbl_al_combined) %>%\n",
    "  gtsave(\"C:/Users/chava/Downloads/Recent_Research_Activity/Output/al_models.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7dc7ea2d-fd5f-4cbf-86e3-275a6fee1a58",
   "metadata": {},
   "source": [
    "# STEP: 12 Implementing the Baseline model(Survey-Weighted Logistic Regression)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89935f1b-6c60-48bb-b5be-20805f46c9e0",
   "metadata": {},
   "source": [
    " # Step 12A: Survey-Weighted Logistic Regression for Self-Rated Health (SRH)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "d8de99cf-5834-4cd9-a43c-15be30b9e36d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'gtsummary' was built under R version 4.5.1\"\n",
      "Warning message:\n",
      "\"package 'gt' was built under R version 4.5.1\"\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = srh ~ binge + race + age_sq + sex + inc + edu + \n",
       "    emp + marital + ins + home + smoke + heavy + active + bmi + \n",
       "    asthma + arth + copd + chd + diab + kidney + stroke + disab + \n",
       "    MCC + year, design = brfss_svy, family = quasibinomial(link = \"logit\"))\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -3.220e+00  4.662e-01  -6.906 1.09e-11 ***\n",
       "binge1                 -4.037e-01  2.745e-01  -1.471 0.141812    \n",
       "raceNon-Hispanic Black  8.959e-02  3.547e-01   0.253 0.800648    \n",
       "raceNon-Hispanic Other -1.535e-01  4.299e-01  -0.357 0.721080    \n",
       "raceNon-Hispanic White -1.265e-01  2.622e-01  -0.483 0.629554    \n",
       "age_sq                  1.825e-04  6.432e-05   2.838 0.004665 ** \n",
       "sex1                   -1.856e-03  1.700e-01  -0.011 0.991293    \n",
       "inc$15k-$25k            2.644e-01  2.721e-01   0.972 0.331563    \n",
       "inc$25k-$35k            1.969e-01  2.992e-01   0.658 0.510571    \n",
       "inc$35k-$50k            4.080e-01  2.752e-01   1.482 0.138726    \n",
       "inc$50k-$75k            1.097e-01  2.897e-01   0.379 0.704973    \n",
       "inc<$15k                1.497e-01  3.155e-01   0.474 0.635303    \n",
       "eduAttended College     2.793e-01  2.107e-01   1.325 0.185465    \n",
       "eduHS Graduate          5.156e-01  2.261e-01   2.280 0.022886 *  \n",
       "eduLess than HS         5.972e-01  3.199e-01   1.867 0.062353 .  \n",
       "empNot in Labor Force   2.778e-01  1.896e-01   1.465 0.143258    \n",
       "empUnemployed          -1.723e-01  5.305e-01  -0.325 0.745418    \n",
       "maritalCohabiting      -2.105e-01  3.793e-01  -0.555 0.579035    \n",
       "maritalDivorced        -2.200e-01  2.105e-01  -1.045 0.296378    \n",
       "maritalNever Married   -4.246e-01  2.482e-01  -1.711 0.087575 .  \n",
       "ins0                    5.694e-01  2.813e-01   2.024 0.043329 *  \n",
       "homeOther               1.579e-02  3.530e-01   0.045 0.964349    \n",
       "homeRent                3.879e-01  2.147e-01   1.807 0.071214 .  \n",
       "smokeSmoker             6.255e-02  1.730e-01   0.362 0.717815    \n",
       "heavyYes                8.009e-01  3.727e-01   2.149 0.031950 *  \n",
       "activeNo                7.942e-01  1.749e-01   4.540 6.59e-06 ***\n",
       "bmiObese                4.075e-01  2.018e-01   2.019 0.043811 *  \n",
       "bmiOverweight           4.685e-01  2.018e-01   2.321 0.020538 *  \n",
       "asthmaYes               8.508e-02  2.101e-01   0.405 0.685693    \n",
       "arthYes                 4.344e-01  2.274e-01   1.910 0.056545 .  \n",
       "copdYes                 1.914e-01  2.534e-01   0.755 0.450270    \n",
       "chdYes                  1.235e+00  3.506e-01   3.524 0.000452 ***\n",
       "diabYes                 2.457e-01  2.994e-01   0.820 0.412235    \n",
       "kidneyYes               3.269e-01  3.898e-01   0.839 0.401973    \n",
       "strokeYes               3.273e-01  3.114e-01   1.051 0.293552    \n",
       "disabYes                1.291e+00  1.792e-01   7.207 1.44e-12 ***\n",
       "MCCYes                 -1.679e-02  3.050e-01  -0.055 0.956128    \n",
       "year2014                2.829e-01  3.088e-01   0.916 0.359923    \n",
       "year2015                2.531e-01  3.266e-01   0.775 0.438520    \n",
       "year2016                1.454e-01  3.040e-01   0.478 0.632611    \n",
       "year2017                1.893e-01  3.103e-01   0.610 0.542033    \n",
       "year2018                1.886e-01  3.435e-01   0.549 0.582994    \n",
       "year2019               -4.522e-01  3.145e-01  -1.438 0.150978    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.040459)\n",
       "\n",
       "Number of Fisher Scoring iterations: 5\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.03997161</td><td>0.01600496</td><td>0.09982715</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.66783862</td><td>0.38960224</td><td>1.14477889</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>1.09372094</td><td>0.54515732</td><td>2.19427576</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.85766448</td><td>0.36878215</td><td>1.99464203</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.88116053</td><td>0.52664467</td><td>1.47432212</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.00018257</td><td>1.00005627</td><td>1.00030888</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>0.99814609</td><td>0.71492071</td><td>1.39357498</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.30261283</td><td>0.76352210</td><td>2.22233278</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.21767832</td><td>0.67676748</td><td>2.19091568</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.50375308</td><td>0.87598208</td><td>2.58141506</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.11597333</td><td>0.63190456</td><td>1.97086169</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.16148031</td><td>0.62519049</td><td>2.15780075</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.32221352</td><td>0.87421946</td><td>1.99978228</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.67472123</td><td>1.07430582</td><td>2.61070092</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.81696779</td><td>0.96957297</td><td>3.40497522</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.32022088</td><td>0.90992870</td><td>1.91551621</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>0.84171727</td><td>0.29706490</td><td>2.38496017</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>0.81015033</td><td>0.38472833</td><td>1.70599228</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>0.80254787</td><td>0.53088191</td><td>1.21323231</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>0.65404441</td><td>0.40177810</td><td>1.06470235</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.76720923</td><td>1.01725902</td><td>3.07004253</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.01591030</td><td>0.50797683</td><td>2.03173388</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.47390251</td><td>0.96696228</td><td>2.24661153</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.06454712</td><td>0.75795984</td><td>1.49514593</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>2.22761450</td><td>1.07175428</td><td>4.63004110</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>2.21258238</td><td>1.56944736</td><td>3.11926409</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>1.50302409</td><td>1.01139947</td><td>2.23361933</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.59761390</td><td>1.07497318</td><td>2.37435707</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>1.08880005</td><td>0.72074877</td><td>1.64479719</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>1.54396603</td><td>0.98793372</td><td>2.41294638</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.21099121</td><td>0.73629979</td><td>1.99171550</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>3.43993826</td><td>1.72825544</td><td>6.84689021</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.27848655</td><td>0.71020127</td><td>2.30149949</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>1.38669473</td><td>0.64504228</td><td>2.98107945</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.38728403</td><td>0.75272341</td><td>2.55679173</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>3.63809499</td><td>2.55910259</td><td>5.17202211</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.98335306</td><td>0.54028282</td><td>1.78977233</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>1.32693399</td><td>0.72372837</td><td>2.43289318</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.28805147</td><td>0.67841120</td><td>2.44553243</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>1.15646794</td><td>0.63675252</td><td>2.10037348</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>1.20841429</td><td>0.65708725</td><td>2.22233057</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>1.20761361</td><td>0.61530654</td><td>2.37008799</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.63623446</td><td>0.34310734</td><td>1.17978909</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.03997161 & 0.01600496 & 0.09982715\\\\\n",
       "\tbinge1 & 0.66783862 & 0.38960224 & 1.14477889\\\\\n",
       "\traceNon-Hispanic Black & 1.09372094 & 0.54515732 & 2.19427576\\\\\n",
       "\traceNon-Hispanic Other & 0.85766448 & 0.36878215 & 1.99464203\\\\\n",
       "\traceNon-Hispanic White & 0.88116053 & 0.52664467 & 1.47432212\\\\\n",
       "\tage\\_sq & 1.00018257 & 1.00005627 & 1.00030888\\\\\n",
       "\tsex1 & 0.99814609 & 0.71492071 & 1.39357498\\\\\n",
       "\tinc\\$15k-\\$25k & 1.30261283 & 0.76352210 & 2.22233278\\\\\n",
       "\tinc\\$25k-\\$35k & 1.21767832 & 0.67676748 & 2.19091568\\\\\n",
       "\tinc\\$35k-\\$50k & 1.50375308 & 0.87598208 & 2.58141506\\\\\n",
       "\tinc\\$50k-\\$75k & 1.11597333 & 0.63190456 & 1.97086169\\\\\n",
       "\tinc<\\$15k & 1.16148031 & 0.62519049 & 2.15780075\\\\\n",
       "\teduAttended College & 1.32221352 & 0.87421946 & 1.99978228\\\\\n",
       "\teduHS Graduate & 1.67472123 & 1.07430582 & 2.61070092\\\\\n",
       "\teduLess than HS & 1.81696779 & 0.96957297 & 3.40497522\\\\\n",
       "\tempNot in Labor Force & 1.32022088 & 0.90992870 & 1.91551621\\\\\n",
       "\tempUnemployed & 0.84171727 & 0.29706490 & 2.38496017\\\\\n",
       "\tmaritalCohabiting & 0.81015033 & 0.38472833 & 1.70599228\\\\\n",
       "\tmaritalDivorced & 0.80254787 & 0.53088191 & 1.21323231\\\\\n",
       "\tmaritalNever Married & 0.65404441 & 0.40177810 & 1.06470235\\\\\n",
       "\tins0 & 1.76720923 & 1.01725902 & 3.07004253\\\\\n",
       "\thomeOther & 1.01591030 & 0.50797683 & 2.03173388\\\\\n",
       "\thomeRent & 1.47390251 & 0.96696228 & 2.24661153\\\\\n",
       "\tsmokeSmoker & 1.06454712 & 0.75795984 & 1.49514593\\\\\n",
       "\theavyYes & 2.22761450 & 1.07175428 & 4.63004110\\\\\n",
       "\tactiveNo & 2.21258238 & 1.56944736 & 3.11926409\\\\\n",
       "\tbmiObese & 1.50302409 & 1.01139947 & 2.23361933\\\\\n",
       "\tbmiOverweight & 1.59761390 & 1.07497318 & 2.37435707\\\\\n",
       "\tasthmaYes & 1.08880005 & 0.72074877 & 1.64479719\\\\\n",
       "\tarthYes & 1.54396603 & 0.98793372 & 2.41294638\\\\\n",
       "\tcopdYes & 1.21099121 & 0.73629979 & 1.99171550\\\\\n",
       "\tchdYes & 3.43993826 & 1.72825544 & 6.84689021\\\\\n",
       "\tdiabYes & 1.27848655 & 0.71020127 & 2.30149949\\\\\n",
       "\tkidneyYes & 1.38669473 & 0.64504228 & 2.98107945\\\\\n",
       "\tstrokeYes & 1.38728403 & 0.75272341 & 2.55679173\\\\\n",
       "\tdisabYes & 3.63809499 & 2.55910259 & 5.17202211\\\\\n",
       "\tMCCYes & 0.98335306 & 0.54028282 & 1.78977233\\\\\n",
       "\tyear2014 & 1.32693399 & 0.72372837 & 2.43289318\\\\\n",
       "\tyear2015 & 1.28805147 & 0.67841120 & 2.44553243\\\\\n",
       "\tyear2016 & 1.15646794 & 0.63675252 & 2.10037348\\\\\n",
       "\tyear2017 & 1.20841429 & 0.65708725 & 2.22233057\\\\\n",
       "\tyear2018 & 1.20761361 & 0.61530654 & 2.37008799\\\\\n",
       "\tyear2019 & 0.63623446 & 0.34310734 & 1.17978909\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.03997161 | 0.01600496 | 0.09982715 |\n",
       "| binge1 | 0.66783862 | 0.38960224 | 1.14477889 |\n",
       "| raceNon-Hispanic Black | 1.09372094 | 0.54515732 | 2.19427576 |\n",
       "| raceNon-Hispanic Other | 0.85766448 | 0.36878215 | 1.99464203 |\n",
       "| raceNon-Hispanic White | 0.88116053 | 0.52664467 | 1.47432212 |\n",
       "| age_sq | 1.00018257 | 1.00005627 | 1.00030888 |\n",
       "| sex1 | 0.99814609 | 0.71492071 | 1.39357498 |\n",
       "| inc$15k-$25k | 1.30261283 | 0.76352210 | 2.22233278 |\n",
       "| inc$25k-$35k | 1.21767832 | 0.67676748 | 2.19091568 |\n",
       "| inc$35k-$50k | 1.50375308 | 0.87598208 | 2.58141506 |\n",
       "| inc$50k-$75k | 1.11597333 | 0.63190456 | 1.97086169 |\n",
       "| inc&lt;$15k | 1.16148031 | 0.62519049 | 2.15780075 |\n",
       "| eduAttended College | 1.32221352 | 0.87421946 | 1.99978228 |\n",
       "| eduHS Graduate | 1.67472123 | 1.07430582 | 2.61070092 |\n",
       "| eduLess than HS | 1.81696779 | 0.96957297 | 3.40497522 |\n",
       "| empNot in Labor Force | 1.32022088 | 0.90992870 | 1.91551621 |\n",
       "| empUnemployed | 0.84171727 | 0.29706490 | 2.38496017 |\n",
       "| maritalCohabiting | 0.81015033 | 0.38472833 | 1.70599228 |\n",
       "| maritalDivorced | 0.80254787 | 0.53088191 | 1.21323231 |\n",
       "| maritalNever Married | 0.65404441 | 0.40177810 | 1.06470235 |\n",
       "| ins0 | 1.76720923 | 1.01725902 | 3.07004253 |\n",
       "| homeOther | 1.01591030 | 0.50797683 | 2.03173388 |\n",
       "| homeRent | 1.47390251 | 0.96696228 | 2.24661153 |\n",
       "| smokeSmoker | 1.06454712 | 0.75795984 | 1.49514593 |\n",
       "| heavyYes | 2.22761450 | 1.07175428 | 4.63004110 |\n",
       "| activeNo | 2.21258238 | 1.56944736 | 3.11926409 |\n",
       "| bmiObese | 1.50302409 | 1.01139947 | 2.23361933 |\n",
       "| bmiOverweight | 1.59761390 | 1.07497318 | 2.37435707 |\n",
       "| asthmaYes | 1.08880005 | 0.72074877 | 1.64479719 |\n",
       "| arthYes | 1.54396603 | 0.98793372 | 2.41294638 |\n",
       "| copdYes | 1.21099121 | 0.73629979 | 1.99171550 |\n",
       "| chdYes | 3.43993826 | 1.72825544 | 6.84689021 |\n",
       "| diabYes | 1.27848655 | 0.71020127 | 2.30149949 |\n",
       "| kidneyYes | 1.38669473 | 0.64504228 | 2.98107945 |\n",
       "| strokeYes | 1.38728403 | 0.75272341 | 2.55679173 |\n",
       "| disabYes | 3.63809499 | 2.55910259 | 5.17202211 |\n",
       "| MCCYes | 0.98335306 | 0.54028282 | 1.78977233 |\n",
       "| year2014 | 1.32693399 | 0.72372837 | 2.43289318 |\n",
       "| year2015 | 1.28805147 | 0.67841120 | 2.44553243 |\n",
       "| year2016 | 1.15646794 | 0.63675252 | 2.10037348 |\n",
       "| year2017 | 1.20841429 | 0.65708725 | 2.22233057 |\n",
       "| year2018 | 1.20761361 | 0.61530654 | 2.37008799 |\n",
       "| year2019 | 0.63623446 | 0.34310734 | 1.17978909 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR         2.5 %      97.5 %    \n",
       "(Intercept)            0.03997161 0.01600496 0.09982715\n",
       "binge1                 0.66783862 0.38960224 1.14477889\n",
       "raceNon-Hispanic Black 1.09372094 0.54515732 2.19427576\n",
       "raceNon-Hispanic Other 0.85766448 0.36878215 1.99464203\n",
       "raceNon-Hispanic White 0.88116053 0.52664467 1.47432212\n",
       "age_sq                 1.00018257 1.00005627 1.00030888\n",
       "sex1                   0.99814609 0.71492071 1.39357498\n",
       "inc$15k-$25k           1.30261283 0.76352210 2.22233278\n",
       "inc$25k-$35k           1.21767832 0.67676748 2.19091568\n",
       "inc$35k-$50k           1.50375308 0.87598208 2.58141506\n",
       "inc$50k-$75k           1.11597333 0.63190456 1.97086169\n",
       "inc<$15k               1.16148031 0.62519049 2.15780075\n",
       "eduAttended College    1.32221352 0.87421946 1.99978228\n",
       "eduHS Graduate         1.67472123 1.07430582 2.61070092\n",
       "eduLess than HS        1.81696779 0.96957297 3.40497522\n",
       "empNot in Labor Force  1.32022088 0.90992870 1.91551621\n",
       "empUnemployed          0.84171727 0.29706490 2.38496017\n",
       "maritalCohabiting      0.81015033 0.38472833 1.70599228\n",
       "maritalDivorced        0.80254787 0.53088191 1.21323231\n",
       "maritalNever Married   0.65404441 0.40177810 1.06470235\n",
       "ins0                   1.76720923 1.01725902 3.07004253\n",
       "homeOther              1.01591030 0.50797683 2.03173388\n",
       "homeRent               1.47390251 0.96696228 2.24661153\n",
       "smokeSmoker            1.06454712 0.75795984 1.49514593\n",
       "heavyYes               2.22761450 1.07175428 4.63004110\n",
       "activeNo               2.21258238 1.56944736 3.11926409\n",
       "bmiObese               1.50302409 1.01139947 2.23361933\n",
       "bmiOverweight          1.59761390 1.07497318 2.37435707\n",
       "asthmaYes              1.08880005 0.72074877 1.64479719\n",
       "arthYes                1.54396603 0.98793372 2.41294638\n",
       "copdYes                1.21099121 0.73629979 1.99171550\n",
       "chdYes                 3.43993826 1.72825544 6.84689021\n",
       "diabYes                1.27848655 0.71020127 2.30149949\n",
       "kidneyYes              1.38669473 0.64504228 2.98107945\n",
       "strokeYes              1.38728403 0.75272341 2.55679173\n",
       "disabYes               3.63809499 2.55910259 5.17202211\n",
       "MCCYes                 0.98335306 0.54028282 1.78977233\n",
       "year2014               1.32693399 0.72372837 2.43289318\n",
       "year2015               1.28805147 0.67841120 2.44553243\n",
       "year2016               1.15646794 0.63675252 2.10037348\n",
       "year2017               1.20841429 0.65708725 2.22233057\n",
       "year2018               1.20761361 0.61530654 2.37008799\n",
       "year2019               0.63623446 0.34310734 1.17978909"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(survey)\n",
    "library(gtsummary)\n",
    "library(gt)\n",
    "\n",
    "\n",
    "# Fit Survey-Weighted Logistic Model for SRH\n",
    "\n",
    "\n",
    "model_main_SRH <- svyglm(\n",
    "  srh ~ binge + race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial(link = \"logit\")  # Logistic regression with overdispersion\n",
    ")\n",
    "\n",
    "\n",
    "# View Model Summary (log-odds output)\n",
    "\n",
    "summary(model_main_SRH)\n",
    "\n",
    "\n",
    "# Display Odds Ratios and 95% Confidence Intervals\n",
    "\n",
    "exp(cbind(OR = coef(model_main_SRH), confint(model_main_SRH)))\n",
    "\n",
    "\n",
    "# Styled Odds Ratio Table Using gtsummary\n",
    "\n",
    "tbl_main_SRH <- tbl_regression(model_main_SRH, exponentiate = TRUE) %>%\n",
    "  bold_labels() %>%\n",
    "  bold_p(t = 0.05) %>%\n",
    "  italicize_levels()\n",
    "\n",
    "\n",
    "# Export to HTML using gt\n",
    "\n",
    "gt_tbl_SRH <- as_gt(tbl_main_SRH)\n",
    "\n",
    "gtsave(gt_tbl_SRH,\n",
    "       filename = \"C:/Users/chava/Downloads/Recent_Research_Activity/Output/model_main_SRH.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26fd40dd-eb55-4cd6-b4c9-13aa4018d3f4",
   "metadata": {},
   "source": [
    "# STEP 12B: Survey-Weighted Logistic Regression for Bad Physical Health"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "5a3c30a4-fcc7-4efb-a0d5-ddaa0b4d7e25",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = bad_phys ~ binge + race + age_sq + sex + inc + \n",
       "    edu + emp + marital + ins + home + smoke + heavy + active + \n",
       "    bmi + asthma + arth + copd + chd + diab + kidney + stroke + \n",
       "    disab + MCC + year, design = brfss_svy, family = quasibinomial(link = \"logit\"))\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -2.608e+00  4.242e-01  -6.147  1.3e-09 ***\n",
       "binge1                 -5.072e-01  2.396e-01  -2.117 0.034611 *  \n",
       "raceNon-Hispanic Black -5.001e-01  3.398e-01  -1.472 0.141498    \n",
       "raceNon-Hispanic Other -7.541e-01  3.504e-01  -2.152 0.031729 *  \n",
       "raceNon-Hispanic White -4.336e-01  2.350e-01  -1.845 0.065386 .  \n",
       "age_sq                  7.814e-05  6.073e-05   1.287 0.198578    \n",
       "sex1                    1.910e-01  1.661e-01   1.150 0.250661    \n",
       "inc$15k-$25k            2.662e-01  3.013e-01   0.883 0.377361    \n",
       "inc$25k-$35k           -2.390e-02  3.511e-01  -0.068 0.945742    \n",
       "inc$35k-$50k            5.827e-03  3.441e-01   0.017 0.986493    \n",
       "inc$50k-$75k            5.667e-01  2.833e-01   2.001 0.045817 *  \n",
       "inc<$15k                2.347e-01  3.457e-01   0.679 0.497403    \n",
       "eduAttended College     5.510e-01  2.128e-01   2.589 0.009807 ** \n",
       "eduHS Graduate          4.236e-01  2.437e-01   1.738 0.082584 .  \n",
       "eduLess than HS         3.577e-01  3.101e-01   1.153 0.249148    \n",
       "empNot in Labor Force   6.591e-01  1.884e-01   3.499 0.000496 ***\n",
       "empUnemployed          -6.032e-01  4.765e-01  -1.266 0.205973    \n",
       "maritalCohabiting       5.296e-02  3.844e-01   0.138 0.890462    \n",
       "maritalDivorced        -2.235e-01  2.018e-01  -1.108 0.268317    \n",
       "maritalNever Married   -4.014e-02  2.450e-01  -0.164 0.869882    \n",
       "ins0                    9.771e-02  2.298e-01   0.425 0.670885    \n",
       "homeOther               5.138e-01  3.145e-01   1.634 0.102741    \n",
       "homeRent                4.075e-02  1.953e-01   0.209 0.834766    \n",
       "smokeSmoker             2.874e-01  1.645e-01   1.747 0.081005 .  \n",
       "heavyYes               -1.545e-01  3.851e-01  -0.401 0.688414    \n",
       "activeNo                5.200e-01  1.677e-01   3.101 0.002006 ** \n",
       "bmiObese                3.493e-01  1.992e-01   1.754 0.079884 .  \n",
       "bmiOverweight           3.495e-01  2.062e-01   1.695 0.090487 .  \n",
       "asthmaYes               1.639e-01  2.094e-01   0.783 0.434172    \n",
       "arthYes                 7.714e-01  2.065e-01   3.736 0.000202 ***\n",
       "copdYes                 6.346e-01  2.326e-01   2.728 0.006519 ** \n",
       "chdYes                  2.550e-01  3.067e-01   0.831 0.406027    \n",
       "diabYes                 2.385e-01  2.454e-01   0.972 0.331512    \n",
       "kidneyYes               7.430e-01  3.582e-01   2.074 0.038423 *  \n",
       "strokeYes               1.953e-01  3.109e-01   0.628 0.530137    \n",
       "disabYes                9.558e-01  1.907e-01   5.011  6.8e-07 ***\n",
       "MCCYes                 -5.180e-01  3.067e-01  -1.689 0.091634 .  \n",
       "year2014                2.769e-01  2.775e-01   0.998 0.318646    \n",
       "year2015                2.438e-01  2.758e-01   0.884 0.377081    \n",
       "year2016               -1.133e-01  3.082e-01  -0.368 0.713218    \n",
       "year2017               -2.668e-01  2.810e-01  -0.949 0.342781    \n",
       "year2018               -1.508e-01  2.796e-01  -0.539 0.589852    \n",
       "year2019               -3.373e-01  2.695e-01  -1.252 0.211136    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 1.034207)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.07370505</td><td>0.03204846</td><td>0.1695069</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.60217414</td><td>0.37621016</td><td>0.9638594</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.60645035</td><td>0.31122391</td><td>1.1817281</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.47045725</td><td>0.23646161</td><td>0.9360083</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.64816006</td><td>0.40863892</td><td>1.0280750</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>1.00007814</td><td>0.99995892</td><td>1.0001974</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.21043929</td><td>0.87358299</td><td>1.6771884</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.30497238</td><td>0.72221473</td><td>2.3579593</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>0.97638202</td><td>0.49008659</td><td>1.9452111</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.00584407</td><td>0.51185932</td><td>1.9765632</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.76244142</td><td>1.01061482</td><td>3.0735743</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.26454853</td><td>0.64145930</td><td>2.4928830</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.73498009</td><td>1.14252214</td><td>2.6346587</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.52746461</td><td>0.94665650</td><td>2.4646196</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.42998964</td><td>0.77789945</td><td>2.6287078</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.93297355</td><td>1.33540841</td><td>2.7979356</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>0.54708460</td><td>0.21468215</td><td>1.3941614</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>1.05438710</td><td>0.49572433</td><td>2.2426419</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>0.79967547</td><td>0.53809291</td><td>1.1884209</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>0.96065403</td><td>0.59389203</td><td>1.5539123</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.10264207</td><td>0.70220230</td><td>1.7314377</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.67157511</td><td>0.90157915</td><td>3.0991881</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.04158790</td><td>0.70991162</td><td>1.5282260</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.33292495</td><td>0.96511160</td><td>1.8409155</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>0.85686906</td><td>0.40235617</td><td>1.8248125</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>1.68199764</td><td>1.21013891</td><td>2.3378441</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>1.41810553</td><td>0.95914530</td><td>2.0966826</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.41837105</td><td>0.94621149</td><td>2.1261382</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>1.17808367</td><td>0.78091072</td><td>1.7772597</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>2.16269730</td><td>1.44192736</td><td>3.2437553</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.88621133</td><td>1.19477401</td><td>2.9777959</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>1.29042582</td><td>0.70672211</td><td>2.3562285</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.26933458</td><td>0.78399640</td><td>2.0551246</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>2.10220858</td><td>1.04051080</td><td>4.2472225</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.21562055</td><td>0.66030676</td><td>2.2379497</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>2.60072219</td><td>1.78843823</td><td>3.7819343</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.59573306</td><td>0.32628042</td><td>1.0877082</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>1.31902897</td><td>0.76502641</td><td>2.2742188</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.27602569</td><td>0.74253168</td><td>2.1928243</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>0.89285470</td><td>0.48749911</td><td>1.6352635</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>0.76583402</td><td>0.44107868</td><td>1.3296987</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>0.86005169</td><td>0.49678295</td><td>1.4889579</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.71368253</td><td>0.42044278</td><td>1.2114437</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.07370505 & 0.03204846 & 0.1695069\\\\\n",
       "\tbinge1 & 0.60217414 & 0.37621016 & 0.9638594\\\\\n",
       "\traceNon-Hispanic Black & 0.60645035 & 0.31122391 & 1.1817281\\\\\n",
       "\traceNon-Hispanic Other & 0.47045725 & 0.23646161 & 0.9360083\\\\\n",
       "\traceNon-Hispanic White & 0.64816006 & 0.40863892 & 1.0280750\\\\\n",
       "\tage\\_sq & 1.00007814 & 0.99995892 & 1.0001974\\\\\n",
       "\tsex1 & 1.21043929 & 0.87358299 & 1.6771884\\\\\n",
       "\tinc\\$15k-\\$25k & 1.30497238 & 0.72221473 & 2.3579593\\\\\n",
       "\tinc\\$25k-\\$35k & 0.97638202 & 0.49008659 & 1.9452111\\\\\n",
       "\tinc\\$35k-\\$50k & 1.00584407 & 0.51185932 & 1.9765632\\\\\n",
       "\tinc\\$50k-\\$75k & 1.76244142 & 1.01061482 & 3.0735743\\\\\n",
       "\tinc<\\$15k & 1.26454853 & 0.64145930 & 2.4928830\\\\\n",
       "\teduAttended College & 1.73498009 & 1.14252214 & 2.6346587\\\\\n",
       "\teduHS Graduate & 1.52746461 & 0.94665650 & 2.4646196\\\\\n",
       "\teduLess than HS & 1.42998964 & 0.77789945 & 2.6287078\\\\\n",
       "\tempNot in Labor Force & 1.93297355 & 1.33540841 & 2.7979356\\\\\n",
       "\tempUnemployed & 0.54708460 & 0.21468215 & 1.3941614\\\\\n",
       "\tmaritalCohabiting & 1.05438710 & 0.49572433 & 2.2426419\\\\\n",
       "\tmaritalDivorced & 0.79967547 & 0.53809291 & 1.1884209\\\\\n",
       "\tmaritalNever Married & 0.96065403 & 0.59389203 & 1.5539123\\\\\n",
       "\tins0 & 1.10264207 & 0.70220230 & 1.7314377\\\\\n",
       "\thomeOther & 1.67157511 & 0.90157915 & 3.0991881\\\\\n",
       "\thomeRent & 1.04158790 & 0.70991162 & 1.5282260\\\\\n",
       "\tsmokeSmoker & 1.33292495 & 0.96511160 & 1.8409155\\\\\n",
       "\theavyYes & 0.85686906 & 0.40235617 & 1.8248125\\\\\n",
       "\tactiveNo & 1.68199764 & 1.21013891 & 2.3378441\\\\\n",
       "\tbmiObese & 1.41810553 & 0.95914530 & 2.0966826\\\\\n",
       "\tbmiOverweight & 1.41837105 & 0.94621149 & 2.1261382\\\\\n",
       "\tasthmaYes & 1.17808367 & 0.78091072 & 1.7772597\\\\\n",
       "\tarthYes & 2.16269730 & 1.44192736 & 3.2437553\\\\\n",
       "\tcopdYes & 1.88621133 & 1.19477401 & 2.9777959\\\\\n",
       "\tchdYes & 1.29042582 & 0.70672211 & 2.3562285\\\\\n",
       "\tdiabYes & 1.26933458 & 0.78399640 & 2.0551246\\\\\n",
       "\tkidneyYes & 2.10220858 & 1.04051080 & 4.2472225\\\\\n",
       "\tstrokeYes & 1.21562055 & 0.66030676 & 2.2379497\\\\\n",
       "\tdisabYes & 2.60072219 & 1.78843823 & 3.7819343\\\\\n",
       "\tMCCYes & 0.59573306 & 0.32628042 & 1.0877082\\\\\n",
       "\tyear2014 & 1.31902897 & 0.76502641 & 2.2742188\\\\\n",
       "\tyear2015 & 1.27602569 & 0.74253168 & 2.1928243\\\\\n",
       "\tyear2016 & 0.89285470 & 0.48749911 & 1.6352635\\\\\n",
       "\tyear2017 & 0.76583402 & 0.44107868 & 1.3296987\\\\\n",
       "\tyear2018 & 0.86005169 & 0.49678295 & 1.4889579\\\\\n",
       "\tyear2019 & 0.71368253 & 0.42044278 & 1.2114437\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.07370505 | 0.03204846 | 0.1695069 |\n",
       "| binge1 | 0.60217414 | 0.37621016 | 0.9638594 |\n",
       "| raceNon-Hispanic Black | 0.60645035 | 0.31122391 | 1.1817281 |\n",
       "| raceNon-Hispanic Other | 0.47045725 | 0.23646161 | 0.9360083 |\n",
       "| raceNon-Hispanic White | 0.64816006 | 0.40863892 | 1.0280750 |\n",
       "| age_sq | 1.00007814 | 0.99995892 | 1.0001974 |\n",
       "| sex1 | 1.21043929 | 0.87358299 | 1.6771884 |\n",
       "| inc$15k-$25k | 1.30497238 | 0.72221473 | 2.3579593 |\n",
       "| inc$25k-$35k | 0.97638202 | 0.49008659 | 1.9452111 |\n",
       "| inc$35k-$50k | 1.00584407 | 0.51185932 | 1.9765632 |\n",
       "| inc$50k-$75k | 1.76244142 | 1.01061482 | 3.0735743 |\n",
       "| inc&lt;$15k | 1.26454853 | 0.64145930 | 2.4928830 |\n",
       "| eduAttended College | 1.73498009 | 1.14252214 | 2.6346587 |\n",
       "| eduHS Graduate | 1.52746461 | 0.94665650 | 2.4646196 |\n",
       "| eduLess than HS | 1.42998964 | 0.77789945 | 2.6287078 |\n",
       "| empNot in Labor Force | 1.93297355 | 1.33540841 | 2.7979356 |\n",
       "| empUnemployed | 0.54708460 | 0.21468215 | 1.3941614 |\n",
       "| maritalCohabiting | 1.05438710 | 0.49572433 | 2.2426419 |\n",
       "| maritalDivorced | 0.79967547 | 0.53809291 | 1.1884209 |\n",
       "| maritalNever Married | 0.96065403 | 0.59389203 | 1.5539123 |\n",
       "| ins0 | 1.10264207 | 0.70220230 | 1.7314377 |\n",
       "| homeOther | 1.67157511 | 0.90157915 | 3.0991881 |\n",
       "| homeRent | 1.04158790 | 0.70991162 | 1.5282260 |\n",
       "| smokeSmoker | 1.33292495 | 0.96511160 | 1.8409155 |\n",
       "| heavyYes | 0.85686906 | 0.40235617 | 1.8248125 |\n",
       "| activeNo | 1.68199764 | 1.21013891 | 2.3378441 |\n",
       "| bmiObese | 1.41810553 | 0.95914530 | 2.0966826 |\n",
       "| bmiOverweight | 1.41837105 | 0.94621149 | 2.1261382 |\n",
       "| asthmaYes | 1.17808367 | 0.78091072 | 1.7772597 |\n",
       "| arthYes | 2.16269730 | 1.44192736 | 3.2437553 |\n",
       "| copdYes | 1.88621133 | 1.19477401 | 2.9777959 |\n",
       "| chdYes | 1.29042582 | 0.70672211 | 2.3562285 |\n",
       "| diabYes | 1.26933458 | 0.78399640 | 2.0551246 |\n",
       "| kidneyYes | 2.10220858 | 1.04051080 | 4.2472225 |\n",
       "| strokeYes | 1.21562055 | 0.66030676 | 2.2379497 |\n",
       "| disabYes | 2.60072219 | 1.78843823 | 3.7819343 |\n",
       "| MCCYes | 0.59573306 | 0.32628042 | 1.0877082 |\n",
       "| year2014 | 1.31902897 | 0.76502641 | 2.2742188 |\n",
       "| year2015 | 1.27602569 | 0.74253168 | 2.1928243 |\n",
       "| year2016 | 0.89285470 | 0.48749911 | 1.6352635 |\n",
       "| year2017 | 0.76583402 | 0.44107868 | 1.3296987 |\n",
       "| year2018 | 0.86005169 | 0.49678295 | 1.4889579 |\n",
       "| year2019 | 0.71368253 | 0.42044278 | 1.2114437 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR         2.5 %      97.5 %   \n",
       "(Intercept)            0.07370505 0.03204846 0.1695069\n",
       "binge1                 0.60217414 0.37621016 0.9638594\n",
       "raceNon-Hispanic Black 0.60645035 0.31122391 1.1817281\n",
       "raceNon-Hispanic Other 0.47045725 0.23646161 0.9360083\n",
       "raceNon-Hispanic White 0.64816006 0.40863892 1.0280750\n",
       "age_sq                 1.00007814 0.99995892 1.0001974\n",
       "sex1                   1.21043929 0.87358299 1.6771884\n",
       "inc$15k-$25k           1.30497238 0.72221473 2.3579593\n",
       "inc$25k-$35k           0.97638202 0.49008659 1.9452111\n",
       "inc$35k-$50k           1.00584407 0.51185932 1.9765632\n",
       "inc$50k-$75k           1.76244142 1.01061482 3.0735743\n",
       "inc<$15k               1.26454853 0.64145930 2.4928830\n",
       "eduAttended College    1.73498009 1.14252214 2.6346587\n",
       "eduHS Graduate         1.52746461 0.94665650 2.4646196\n",
       "eduLess than HS        1.42998964 0.77789945 2.6287078\n",
       "empNot in Labor Force  1.93297355 1.33540841 2.7979356\n",
       "empUnemployed          0.54708460 0.21468215 1.3941614\n",
       "maritalCohabiting      1.05438710 0.49572433 2.2426419\n",
       "maritalDivorced        0.79967547 0.53809291 1.1884209\n",
       "maritalNever Married   0.96065403 0.59389203 1.5539123\n",
       "ins0                   1.10264207 0.70220230 1.7314377\n",
       "homeOther              1.67157511 0.90157915 3.0991881\n",
       "homeRent               1.04158790 0.70991162 1.5282260\n",
       "smokeSmoker            1.33292495 0.96511160 1.8409155\n",
       "heavyYes               0.85686906 0.40235617 1.8248125\n",
       "activeNo               1.68199764 1.21013891 2.3378441\n",
       "bmiObese               1.41810553 0.95914530 2.0966826\n",
       "bmiOverweight          1.41837105 0.94621149 2.1261382\n",
       "asthmaYes              1.17808367 0.78091072 1.7772597\n",
       "arthYes                2.16269730 1.44192736 3.2437553\n",
       "copdYes                1.88621133 1.19477401 2.9777959\n",
       "chdYes                 1.29042582 0.70672211 2.3562285\n",
       "diabYes                1.26933458 0.78399640 2.0551246\n",
       "kidneyYes              2.10220858 1.04051080 4.2472225\n",
       "strokeYes              1.21562055 0.66030676 2.2379497\n",
       "disabYes               2.60072219 1.78843823 3.7819343\n",
       "MCCYes                 0.59573306 0.32628042 1.0877082\n",
       "year2014               1.31902897 0.76502641 2.2742188\n",
       "year2015               1.27602569 0.74253168 2.1928243\n",
       "year2016               0.89285470 0.48749911 1.6352635\n",
       "year2017               0.76583402 0.44107868 1.3296987\n",
       "year2018               0.86005169 0.49678295 1.4889579\n",
       "year2019               0.71368253 0.42044278 1.2114437"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(survey)\n",
    "library(gtsummary)\n",
    "library(gt)\n",
    "\n",
    "\n",
    "# Fit Survey-Weighted Logistic Model for Bad Physical Health\n",
    "\n",
    "\n",
    "model_bad_phys <- svyglm(\n",
    "  bad_phys ~ binge + race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial(link = \"logit\")\n",
    ")\n",
    "\n",
    "\n",
    "# View Model Summary (log-odds output)\n",
    "\n",
    "summary(model_bad_phys)\n",
    "\n",
    "\n",
    "# Display Odds Ratios and 95% Confidence Intervals\n",
    "\n",
    "exp(cbind(OR = coef(model_bad_phys), confint(model_bad_phys)))\n",
    "\n",
    "\n",
    "# Styled Odds Ratio Table Using gtsummary\n",
    "\n",
    "tbl_bad_phys <- tbl_regression(model_bad_phys, exponentiate = TRUE) %>%\n",
    "  bold_labels() %>%\n",
    "  bold_p(t = 0.05)\n",
    "\n",
    "\n",
    "# Export to HTML using gt\n",
    "\n",
    "gt_tbl_bad_phys <- as_gt(tbl_bad_phys)\n",
    "\n",
    "gtsave(gt_tbl_bad_phys,\n",
    "       filename = \"C:/Users/chava/Downloads/Recent_Research_Activity/Output/model_bad_phys_table.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3470ab1b-61f6-4dee-9a5d-3b088273068d",
   "metadata": {},
   "source": [
    "# STEP 12C: Survey-Weighted Logistic Regression for Activity Limitation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "ca5d2167-fb39-4d0d-9233-96ed5f563062",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge + race + age_sq + sex + \n",
       "    inc + edu + emp + marital + ins + home + smoke + heavy + \n",
       "    active + bmi + asthma + arth + copd + chd + diab + kidney + \n",
       "    stroke + disab + MCC + year, design = brfss_svy, family = quasibinomial(link = \"logit\"))\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                         Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)            -2.293e+00  4.448e-01  -5.155 3.28e-07 ***\n",
       "binge1                 -7.560e-01  2.497e-01  -3.028 0.002551 ** \n",
       "raceNon-Hispanic Black -4.304e-01  3.727e-01  -1.155 0.248603    \n",
       "raceNon-Hispanic Other -5.885e-01  3.691e-01  -1.595 0.111217    \n",
       "raceNon-Hispanic White -5.463e-01  2.567e-01  -2.128 0.033655 *  \n",
       "age_sq                 -2.252e-05  6.315e-05  -0.357 0.721531    \n",
       "sex1                    4.662e-01  1.661e-01   2.806 0.005145 ** \n",
       "inc$15k-$25k            3.612e-01  3.036e-01   1.190 0.234525    \n",
       "inc$25k-$35k            2.641e-01  3.304e-01   0.800 0.424237    \n",
       "inc$35k-$50k            2.444e-01  3.378e-01   0.724 0.469569    \n",
       "inc$50k-$75k            5.180e-01  2.929e-01   1.768 0.077424 .  \n",
       "inc<$15k                5.457e-01  3.395e-01   1.607 0.108390    \n",
       "eduAttended College     2.189e-01  2.137e-01   1.024 0.306149    \n",
       "eduHS Graduate          2.060e-01  2.326e-01   0.886 0.376028    \n",
       "eduLess than HS         1.216e-01  2.949e-01   0.412 0.680242    \n",
       "empNot in Labor Force   5.852e-01  1.869e-01   3.132 0.001807 ** \n",
       "empUnemployed           9.877e-01  4.126e-01   2.394 0.016916 *  \n",
       "maritalCohabiting      -2.381e-01  3.696e-01  -0.644 0.519671    \n",
       "maritalDivorced         7.086e-02  1.976e-01   0.359 0.719965    \n",
       "maritalNever Married    1.070e-01  2.460e-01   0.435 0.663788    \n",
       "ins0                    1.510e-01  2.384e-01   0.633 0.526835    \n",
       "homeOther               5.129e-01  3.306e-01   1.552 0.121211    \n",
       "homeRent                6.585e-03  1.847e-01   0.036 0.971562    \n",
       "smokeSmoker             4.524e-01  1.655e-01   2.733 0.006421 ** \n",
       "heavyYes                3.955e-01  3.530e-01   1.120 0.262891    \n",
       "activeNo                5.903e-01  1.698e-01   3.476 0.000539 ***\n",
       "bmiObese               -8.797e-02  2.024e-01  -0.435 0.663948    \n",
       "bmiOverweight           6.249e-02  2.029e-01   0.308 0.758216    \n",
       "asthmaYes              -1.399e-01  2.166e-01  -0.646 0.518524    \n",
       "arthYes                 6.976e-01  2.181e-01   3.198 0.001442 ** \n",
       "copdYes                 1.669e-01  2.464e-01   0.677 0.498353    \n",
       "chdYes                  6.008e-02  3.049e-01   0.197 0.843840    \n",
       "diabYes                 5.482e-01  2.498e-01   2.195 0.028501 *  \n",
       "kidneyYes               2.402e-01  4.244e-01   0.566 0.571627    \n",
       "strokeYes               3.683e-01  2.736e-01   1.346 0.178650    \n",
       "disabYes                1.363e+00  1.936e-01   7.044 4.35e-12 ***\n",
       "MCCYes                 -4.335e-01  3.187e-01  -1.360 0.174149    \n",
       "year2014               -5.884e-02  2.811e-01  -0.209 0.834243    \n",
       "year2015                1.175e-01  2.657e-01   0.442 0.658379    \n",
       "year2016               -4.687e-01  2.942e-01  -1.593 0.111590    \n",
       "year2017               -2.484e-01  2.825e-01  -0.879 0.379525    \n",
       "year2018               -3.755e-01  2.834e-01  -1.325 0.185625    \n",
       "year2019               -4.033e-01  2.858e-01  -1.411 0.158587    \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 0.9853925)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 43 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.1009712</td><td>0.04216294</td><td>0.2418042</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.4695612</td><td>0.28761775</td><td>0.7666000</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Black</th><td>0.6502540</td><td>0.31280751</td><td>1.3517265</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic Other</th><td>0.5551343</td><td>0.26898230</td><td>1.1457041</td></tr>\n",
       "\t<tr><th scope=row>raceNon-Hispanic White</th><td>0.5790755</td><td>0.34983564</td><td>0.9585314</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>0.9999775</td><td>0.99985352</td><td>1.0001015</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.5939752</td><td>1.15035766</td><td>2.2086669</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.4350388</td><td>0.79072109</td><td>2.6043776</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.3023127</td><td>0.68082821</td><td>2.4911108</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.2769025</td><td>0.65783812</td><td>2.4785427</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.6786056</td><td>0.94451160</td><td>2.9832527</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.7258773</td><td>0.88622025</td><td>3.3610745</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.2446707</td><td>0.81813319</td><td>1.8935856</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.2288130</td><td>0.77830628</td><td>1.9400865</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.1292872</td><td>0.63294526</td><td>2.0148495</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.7953730</td><td>1.24403107</td><td>2.5910641</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>2.6850689</td><td>1.19451842</td><td>6.0355660</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>0.7881241</td><td>0.38145536</td><td>1.6283413</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>1.0734269</td><td>0.72832031</td><td>1.5820584</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>1.1129220</td><td>0.68658858</td><td>1.8039847</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.1629481</td><td>0.72823977</td><td>1.8571469</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.6701422</td><td>0.87275168</td><td>3.1960696</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.0066072</td><td>0.70050410</td><td>1.4464698</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.5720393</td><td>1.13594092</td><td>2.1755601</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>1.4850775</td><td>0.74270014</td><td>2.9695097</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>1.8045226</td><td>1.29290392</td><td>2.5185954</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>0.9157858</td><td>0.61549144</td><td>1.3625918</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.0644837</td><td>0.71468908</td><td>1.5854803</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>0.8694207</td><td>0.56823448</td><td>1.3302473</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>2.0089009</td><td>1.30915906</td><td>3.0826527</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.1816853</td><td>0.72842444</td><td>1.9169869</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>1.0619203</td><td>0.58363344</td><td>1.9321627</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.7300586</td><td>1.05951584</td><td>2.8249722</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>1.2714831</td><td>0.55263968</td><td>2.9253586</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.4452423</td><td>0.84468496</td><td>2.4727862</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>3.9098029</td><td>2.67369400</td><td>5.7173929</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.6482142</td><td>0.34672769</td><td>1.2118490</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>0.9428615</td><td>0.54301521</td><td>1.6371324</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.1247221</td><td>0.66755625</td><td>1.8949712</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>0.6258374</td><td>0.35125423</td><td>1.1150682</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>0.7800636</td><td>0.44801014</td><td>1.3582265</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>0.6869541</td><td>0.39380805</td><td>1.1983145</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.6680906</td><td>0.38121068</td><td>1.1708618</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 43 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.1009712 & 0.04216294 & 0.2418042\\\\\n",
       "\tbinge1 & 0.4695612 & 0.28761775 & 0.7666000\\\\\n",
       "\traceNon-Hispanic Black & 0.6502540 & 0.31280751 & 1.3517265\\\\\n",
       "\traceNon-Hispanic Other & 0.5551343 & 0.26898230 & 1.1457041\\\\\n",
       "\traceNon-Hispanic White & 0.5790755 & 0.34983564 & 0.9585314\\\\\n",
       "\tage\\_sq & 0.9999775 & 0.99985352 & 1.0001015\\\\\n",
       "\tsex1 & 1.5939752 & 1.15035766 & 2.2086669\\\\\n",
       "\tinc\\$15k-\\$25k & 1.4350388 & 0.79072109 & 2.6043776\\\\\n",
       "\tinc\\$25k-\\$35k & 1.3023127 & 0.68082821 & 2.4911108\\\\\n",
       "\tinc\\$35k-\\$50k & 1.2769025 & 0.65783812 & 2.4785427\\\\\n",
       "\tinc\\$50k-\\$75k & 1.6786056 & 0.94451160 & 2.9832527\\\\\n",
       "\tinc<\\$15k & 1.7258773 & 0.88622025 & 3.3610745\\\\\n",
       "\teduAttended College & 1.2446707 & 0.81813319 & 1.8935856\\\\\n",
       "\teduHS Graduate & 1.2288130 & 0.77830628 & 1.9400865\\\\\n",
       "\teduLess than HS & 1.1292872 & 0.63294526 & 2.0148495\\\\\n",
       "\tempNot in Labor Force & 1.7953730 & 1.24403107 & 2.5910641\\\\\n",
       "\tempUnemployed & 2.6850689 & 1.19451842 & 6.0355660\\\\\n",
       "\tmaritalCohabiting & 0.7881241 & 0.38145536 & 1.6283413\\\\\n",
       "\tmaritalDivorced & 1.0734269 & 0.72832031 & 1.5820584\\\\\n",
       "\tmaritalNever Married & 1.1129220 & 0.68658858 & 1.8039847\\\\\n",
       "\tins0 & 1.1629481 & 0.72823977 & 1.8571469\\\\\n",
       "\thomeOther & 1.6701422 & 0.87275168 & 3.1960696\\\\\n",
       "\thomeRent & 1.0066072 & 0.70050410 & 1.4464698\\\\\n",
       "\tsmokeSmoker & 1.5720393 & 1.13594092 & 2.1755601\\\\\n",
       "\theavyYes & 1.4850775 & 0.74270014 & 2.9695097\\\\\n",
       "\tactiveNo & 1.8045226 & 1.29290392 & 2.5185954\\\\\n",
       "\tbmiObese & 0.9157858 & 0.61549144 & 1.3625918\\\\\n",
       "\tbmiOverweight & 1.0644837 & 0.71468908 & 1.5854803\\\\\n",
       "\tasthmaYes & 0.8694207 & 0.56823448 & 1.3302473\\\\\n",
       "\tarthYes & 2.0089009 & 1.30915906 & 3.0826527\\\\\n",
       "\tcopdYes & 1.1816853 & 0.72842444 & 1.9169869\\\\\n",
       "\tchdYes & 1.0619203 & 0.58363344 & 1.9321627\\\\\n",
       "\tdiabYes & 1.7300586 & 1.05951584 & 2.8249722\\\\\n",
       "\tkidneyYes & 1.2714831 & 0.55263968 & 2.9253586\\\\\n",
       "\tstrokeYes & 1.4452423 & 0.84468496 & 2.4727862\\\\\n",
       "\tdisabYes & 3.9098029 & 2.67369400 & 5.7173929\\\\\n",
       "\tMCCYes & 0.6482142 & 0.34672769 & 1.2118490\\\\\n",
       "\tyear2014 & 0.9428615 & 0.54301521 & 1.6371324\\\\\n",
       "\tyear2015 & 1.1247221 & 0.66755625 & 1.8949712\\\\\n",
       "\tyear2016 & 0.6258374 & 0.35125423 & 1.1150682\\\\\n",
       "\tyear2017 & 0.7800636 & 0.44801014 & 1.3582265\\\\\n",
       "\tyear2018 & 0.6869541 & 0.39380805 & 1.1983145\\\\\n",
       "\tyear2019 & 0.6680906 & 0.38121068 & 1.1708618\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 43 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.1009712 | 0.04216294 | 0.2418042 |\n",
       "| binge1 | 0.4695612 | 0.28761775 | 0.7666000 |\n",
       "| raceNon-Hispanic Black | 0.6502540 | 0.31280751 | 1.3517265 |\n",
       "| raceNon-Hispanic Other | 0.5551343 | 0.26898230 | 1.1457041 |\n",
       "| raceNon-Hispanic White | 0.5790755 | 0.34983564 | 0.9585314 |\n",
       "| age_sq | 0.9999775 | 0.99985352 | 1.0001015 |\n",
       "| sex1 | 1.5939752 | 1.15035766 | 2.2086669 |\n",
       "| inc$15k-$25k | 1.4350388 | 0.79072109 | 2.6043776 |\n",
       "| inc$25k-$35k | 1.3023127 | 0.68082821 | 2.4911108 |\n",
       "| inc$35k-$50k | 1.2769025 | 0.65783812 | 2.4785427 |\n",
       "| inc$50k-$75k | 1.6786056 | 0.94451160 | 2.9832527 |\n",
       "| inc&lt;$15k | 1.7258773 | 0.88622025 | 3.3610745 |\n",
       "| eduAttended College | 1.2446707 | 0.81813319 | 1.8935856 |\n",
       "| eduHS Graduate | 1.2288130 | 0.77830628 | 1.9400865 |\n",
       "| eduLess than HS | 1.1292872 | 0.63294526 | 2.0148495 |\n",
       "| empNot in Labor Force | 1.7953730 | 1.24403107 | 2.5910641 |\n",
       "| empUnemployed | 2.6850689 | 1.19451842 | 6.0355660 |\n",
       "| maritalCohabiting | 0.7881241 | 0.38145536 | 1.6283413 |\n",
       "| maritalDivorced | 1.0734269 | 0.72832031 | 1.5820584 |\n",
       "| maritalNever Married | 1.1129220 | 0.68658858 | 1.8039847 |\n",
       "| ins0 | 1.1629481 | 0.72823977 | 1.8571469 |\n",
       "| homeOther | 1.6701422 | 0.87275168 | 3.1960696 |\n",
       "| homeRent | 1.0066072 | 0.70050410 | 1.4464698 |\n",
       "| smokeSmoker | 1.5720393 | 1.13594092 | 2.1755601 |\n",
       "| heavyYes | 1.4850775 | 0.74270014 | 2.9695097 |\n",
       "| activeNo | 1.8045226 | 1.29290392 | 2.5185954 |\n",
       "| bmiObese | 0.9157858 | 0.61549144 | 1.3625918 |\n",
       "| bmiOverweight | 1.0644837 | 0.71468908 | 1.5854803 |\n",
       "| asthmaYes | 0.8694207 | 0.56823448 | 1.3302473 |\n",
       "| arthYes | 2.0089009 | 1.30915906 | 3.0826527 |\n",
       "| copdYes | 1.1816853 | 0.72842444 | 1.9169869 |\n",
       "| chdYes | 1.0619203 | 0.58363344 | 1.9321627 |\n",
       "| diabYes | 1.7300586 | 1.05951584 | 2.8249722 |\n",
       "| kidneyYes | 1.2714831 | 0.55263968 | 2.9253586 |\n",
       "| strokeYes | 1.4452423 | 0.84468496 | 2.4727862 |\n",
       "| disabYes | 3.9098029 | 2.67369400 | 5.7173929 |\n",
       "| MCCYes | 0.6482142 | 0.34672769 | 1.2118490 |\n",
       "| year2014 | 0.9428615 | 0.54301521 | 1.6371324 |\n",
       "| year2015 | 1.1247221 | 0.66755625 | 1.8949712 |\n",
       "| year2016 | 0.6258374 | 0.35125423 | 1.1150682 |\n",
       "| year2017 | 0.7800636 | 0.44801014 | 1.3582265 |\n",
       "| year2018 | 0.6869541 | 0.39380805 | 1.1983145 |\n",
       "| year2019 | 0.6680906 | 0.38121068 | 1.1708618 |\n",
       "\n"
      ],
      "text/plain": [
       "                       OR        2.5 %      97.5 %   \n",
       "(Intercept)            0.1009712 0.04216294 0.2418042\n",
       "binge1                 0.4695612 0.28761775 0.7666000\n",
       "raceNon-Hispanic Black 0.6502540 0.31280751 1.3517265\n",
       "raceNon-Hispanic Other 0.5551343 0.26898230 1.1457041\n",
       "raceNon-Hispanic White 0.5790755 0.34983564 0.9585314\n",
       "age_sq                 0.9999775 0.99985352 1.0001015\n",
       "sex1                   1.5939752 1.15035766 2.2086669\n",
       "inc$15k-$25k           1.4350388 0.79072109 2.6043776\n",
       "inc$25k-$35k           1.3023127 0.68082821 2.4911108\n",
       "inc$35k-$50k           1.2769025 0.65783812 2.4785427\n",
       "inc$50k-$75k           1.6786056 0.94451160 2.9832527\n",
       "inc<$15k               1.7258773 0.88622025 3.3610745\n",
       "eduAttended College    1.2446707 0.81813319 1.8935856\n",
       "eduHS Graduate         1.2288130 0.77830628 1.9400865\n",
       "eduLess than HS        1.1292872 0.63294526 2.0148495\n",
       "empNot in Labor Force  1.7953730 1.24403107 2.5910641\n",
       "empUnemployed          2.6850689 1.19451842 6.0355660\n",
       "maritalCohabiting      0.7881241 0.38145536 1.6283413\n",
       "maritalDivorced        1.0734269 0.72832031 1.5820584\n",
       "maritalNever Married   1.1129220 0.68658858 1.8039847\n",
       "ins0                   1.1629481 0.72823977 1.8571469\n",
       "homeOther              1.6701422 0.87275168 3.1960696\n",
       "homeRent               1.0066072 0.70050410 1.4464698\n",
       "smokeSmoker            1.5720393 1.13594092 2.1755601\n",
       "heavyYes               1.4850775 0.74270014 2.9695097\n",
       "activeNo               1.8045226 1.29290392 2.5185954\n",
       "bmiObese               0.9157858 0.61549144 1.3625918\n",
       "bmiOverweight          1.0644837 0.71468908 1.5854803\n",
       "asthmaYes              0.8694207 0.56823448 1.3302473\n",
       "arthYes                2.0089009 1.30915906 3.0826527\n",
       "copdYes                1.1816853 0.72842444 1.9169869\n",
       "chdYes                 1.0619203 0.58363344 1.9321627\n",
       "diabYes                1.7300586 1.05951584 2.8249722\n",
       "kidneyYes              1.2714831 0.55263968 2.9253586\n",
       "strokeYes              1.4452423 0.84468496 2.4727862\n",
       "disabYes               3.9098029 2.67369400 5.7173929\n",
       "MCCYes                 0.6482142 0.34672769 1.2118490\n",
       "year2014               0.9428615 0.54301521 1.6371324\n",
       "year2015               1.1247221 0.66755625 1.8949712\n",
       "year2016               0.6258374 0.35125423 1.1150682\n",
       "year2017               0.7800636 0.44801014 1.3582265\n",
       "year2018               0.6869541 0.39380805 1.1983145\n",
       "year2019               0.6680906 0.38121068 1.1708618"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "library(survey)\n",
    "library(gtsummary)\n",
    "library(gt)\n",
    "\n",
    "\n",
    "# Fit Survey-Weighted Logistic Model for Activity Limitation\n",
    "\n",
    "model_activity_lim <- svyglm(\n",
    "  activity_limit ~ binge + race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial(link = \"logit\")\n",
    ")\n",
    "\n",
    "\n",
    "# View Model Summary (log-odds output)\n",
    "\n",
    "summary(model_activity_lim)\n",
    "\n",
    "\n",
    "# Display Odds Ratios and 95% Confidence Intervals\n",
    "\n",
    "exp(cbind(OR = coef(model_activity_lim), confint(model_activity_lim)))\n",
    "\n",
    "\n",
    "#Styled Odds Ratio Table Using gtsummary\n",
    "\n",
    "tbl_activity_lim <- tbl_regression(model_activity_lim, exponentiate = TRUE) %>%\n",
    "  bold_labels() %>%\n",
    "  bold_p(t = 0.05)\n",
    "\n",
    "\n",
    "# Export to HTML using gt\n",
    "\n",
    "gt_tbl_activity_lim <- as_gt(tbl_activity_lim)\n",
    "\n",
    "gtsave(gt_tbl_activity_lim,\n",
    "       filename = \"C:/Users/chava/Downloads/Recent_Research_Activity/Output/model_activity_lim_table.html\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae549213-56ed-4b84-af3f-76193973d719",
   "metadata": {},
   "source": [
    "# STEP 13 :Implementing Interaction Models"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6dedc0e0-1a07-4eea-b7ef-e758ef0a5c57",
   "metadata": {},
   "source": [
    "# Step 13A: First-Order Interaction Models for Self-Rated Health (SRH)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "9a9f04cb-5806-442c-90a4-a2472379fb4d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Model     BIC\n",
      "1      Main 3063.72\n",
      "2      Race 3072.79\n",
      "3       Age 3071.54\n",
      "4    Income 3079.39\n",
      "5 Education 3076.76\n",
      "6    Gender 3071.64\n"
     ]
    }
   ],
   "source": [
    "\n",
    "#  Fit Interaction Models (binge * X) for SRH\n",
    "\n",
    "# Interaction: Binge * Race\n",
    "model_interaction_race <- svyglm(\n",
    "  srh ~ binge * race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Age (squared)\n",
    "model_interaction_age <- svyglm(\n",
    "  srh ~ binge * age_sq + race + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Income\n",
    "model_interaction_income <- svyglm(\n",
    "  srh ~ binge * inc + age_sq + race + sex + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Education\n",
    "model_interaction_education <- svyglm(\n",
    "  srh ~ binge * edu + age_sq + race + sex + inc +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Gender\n",
    "model_interaction_gender <- svyglm(\n",
    "  srh ~ binge * sex + age_sq + race + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Compute BIC for Model Comparison\n",
    "\n",
    "\n",
    "# Define function to calculate BIC from svyglm\n",
    "approx_bic <- function(model, n) {\n",
    "  k <- length(coef(model))            # Number of parameters\n",
    "  ll <- logLik(model)                 # Log-likelihood (approximate)\n",
    "  bic <- -2 * as.numeric(ll) + k * log(n)\n",
    "  return(round(bic, 2))\n",
    "}\n",
    "\n",
    "# Sample size used in the model\n",
    "n_obs <- nrow(model.frame(model_main_SRH))\n",
    "\n",
    "# Compute BIC for each model\n",
    "bic_main      <- approx_bic(model_main_SRH, n_obs)\n",
    "bic_race      <- approx_bic(model_interaction_race, n_obs)\n",
    "bic_age       <- approx_bic(model_interaction_age, n_obs)\n",
    "bic_income    <- approx_bic(model_interaction_income, n_obs)\n",
    "bic_education <- approx_bic(model_interaction_education, n_obs)\n",
    "bic_gender    <- approx_bic(model_interaction_gender, n_obs)\n",
    "\n",
    "\n",
    "# Summarize BIC Comparison Table\n",
    "\n",
    "\n",
    "bic_df <- data.frame(\n",
    "  Model = c(\"Main\", \"Race\", \"Age\", \"Income\", \"Education\", \"Gender\"),\n",
    "  BIC   = c(bic_main, bic_race, bic_age, bic_income, bic_education, bic_gender)\n",
    ")\n",
    "\n",
    "print(bic_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "eff09b49-4caf-4434-97a0-02bcb0649d78",
   "metadata": {},
   "outputs": [],
   "source": [
    "#binge * education gave the best fit, suggesting that the effect of binge drinking depends on education level.\n",
    "\n",
    "#binge * age also showed strong effect modification.\n",
    "\n",
    "#The Main model has the lowest BIC (3063.72) → it currently fits the data best.\n",
    "\n",
    "#The interaction models (Race, Age, Income, etc.) all have higher BICs.\n",
    "\n",
    "#The next best is Age (3071.54), but it's still worse than the Main model.\n",
    "\n",
    "#The worst is Income (3079.39) — meaning adding binge * income made the model more complex without improving fit."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "90f1b3dd-0f89-410b-9240-9c59a77b5a1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#results suggest that binge drinking has a similar effect across groups, at least within this dataset (2013–2019)."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e9fdfbb-3ceb-4b36-93a5-0c44dddecc5e",
   "metadata": {},
   "source": [
    "# Visualize BIC Values — Bar Plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "55474ed5-80e6-4bd9-ad84-f361731268e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\nkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkC\nJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIA\nCUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBA\nAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQ\ngAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIk\nIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJ\nSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEAC\nEpAEARKQgCQIkIAEJEGABCQgPZ3vSfaEZNfdE5Jdd09Idt1dIdmF94Rk190T0nS13hrSNHtC\nsuvuCcmuuycku+6ukOzCe0Ky6+4J6e4aDiQgAQlIQAISkIAEJCA9FyABCUiCAAlIQBIESEAC\nkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCA\nJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQg\nCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlI\nggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKS\nIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAk\nCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJ\nAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiC\nAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIg\n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\nQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJ\nECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSO5N\nGWcAAAgNSURBVEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSE/ne5I9\nIdl194Rk190Tkl13V0h24T0h2XX3hDRdrbeGNM2ekOy6e0Ky6+4Jya67KyS78J6Q7Lp7Qrq7\nhgMJSEACEpCABCQgAQlIzwVIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiC\nAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIg\nQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQI\nkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkC\nJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIA\nCUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBA\nAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQ\ngAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIk\nIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJ\nSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEAC\nEpAEARKQgPQ4URTdfwGQgASkh4naf/MBEpCA9CiR9f9MgAQkID3KBNL3JHtCsuvuCcmuuyck\nu+6ukOzCe0Ky6+4Jabpa7w+JkA/M1pBEcSZ0x4RWN7gOb1EXSNQNrsNA2ieh1Q2uw0DaJ6HV\nDa7DQNonodUNrsPvCmnBG7Kr8knz+Z3rBtfht4X0+BahVfmk+fzOdYPr8PtC2iafNJ/fuW5w\nHQYSdT+q8CfVBRJ1g+swkKj7UYU/qS6QqBtch4FE3Y8q/El1gUTd4DoMJOp+VOFPqgsk6gbX\nYSBR96MKf1JdIFE3uA4DibofVfiT6gKJusF1GEjU/ajCn1QXSNQNrsNAou5HFf6kukCibnAd\nBhJ1P6rwJ9UFEnWD6zCQqPtRhT+pLpCoG1yHgUTdjyr8SXWBRN3gOgwk6n5U4U+qCyTqBtfh\n0CAR8msCJEIEARIhggCJEEGARIggQCJEECARIgiQCBEESIQIAiRCBAESIYIAiRBB3glS5Hnk\nPt6p/PalHn0N/KbTEjXZssRQZajzuMfqSdpxib4XpGj8YNfqO5O9W21bSDvU8DS//6YDSJ8N\nacGKvAekjfsLpB9Ltyq3P9vDgubf5sci1qFFVaqbgo0qWc+idv/U93BcPlJPhwPJKes+0FTp\n24yKfvmOykXt/86ECJb5aNUZ97CdsZPBq/K+kLrjn/rx44Oh14vby9kivEmlSdmhh5Pycs02\nJLes81tRlb5NB5JTrl/MztDXl7lnxk4quLN6fa33gtT1xp7n7hq+ZXH73CXaruh4DZt21/dA\nPwHOjNX32rrWsLSX/te+MAkLakfj367M20KqfxFFo7mxZe1CvyTnS7Xr2M9AGl1Ni+wiOkjj\nh7N9chbzxpAmv/lcSMOO132+MSTP5nOjq8T2Eu1reNY1d5B6AkbbKpuVptcLIY0X849BerHf\nbwap6M+PnO5uDikafm63JxjVurN0PYPkExA5D/XVlkGaLOaf3SOtD5Ccpr37ho2K+Vebe1tv\naX0fJGWvF0DyLeaNIU0eROPfrsy7QXI7ttc5UmQ/itrCVuUtyg19iqbPoskgdXmrbbezqpLR\n6HF/lDrtnLOYp3PkpUnwzObJE8WsfltI/TsLu0Pa+n2korDfIYnsy7x91WgySFnd+hlNO6t6\nH8m+RairMi3XL+bp+0j2tK6bhGIyYycVoungVXknSO+U7dCSjwyQxtlmL0A+PECaZIc7o8nH\nBUiECAIkQgQBEiGCAIkQQYBEiCBAIkQQIP2iRIevW/vw9nWYvUZvzP3nZIMwj39RjDFp+zA1\n8zyA9ANhHv+iGBP398nFQHqrMI9/UYw5mUv96FI+AtI7hXn8i2LMrT22S8215XE9RiY6XpsX\nZImJTi2cS2JMkjWj/cTEBhbm8S9KKSLu/tSg5ZGZJrWYtH54rIecm9+nBZB2CfP4F6UUkdbH\ndpcSSM2j3C+d8iIvBd3qJ+eSVlQNuZqkfOE1qYQBaYcwj39RShGXeh9Tcap5pO2h3rH6mZqv\n6nEemepxXj82ByDtEubxL0olovlDbdPyiE3zxtLNxNWTGk9xMNXjLkDaJczjXxRjmp3RxRxb\nHr0RG0xSPwbSrmEe/6JUIjJzKjFl9yCN8QBphzCPf1EaO3F9ZOc5tGvB5PURoLm6o5Ftwzz+\nRalFHE1mku5JWh3kFe3FhkOD56sacmwGXKuXAmmHMI9/UWoR1TtH5+7JzZi0ufx9rQRF5+YN\npPpSeEnrGnH5e6cwj39RahHlkVt9dc7zhmxSPzz13nhDdr8wj39RGhFJfWTX8XBuETpbtwjd\n0sjEX9YryZZhHhMiCJAIEQRIhAgCJEIEARIhggCJEEGARIggQCJEECARIgiQCBEESIQIAiRC\nBAESIYIAiRBBgESIIP8PBZBIUB19WEwAAAAASUVORK5CYII=",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Load ggplot2 if not already\n",
    "library(ggplot2)\n",
    "\n",
    "# BIC bar plot\n",
    "ggplot(bic_df, aes(x = reorder(Model, BIC), y = BIC, fill = Model)) +\n",
    "  geom_col(show.legend = FALSE) +\n",
    "  geom_text(aes(label = BIC), vjust = -0.5, size = 4) +\n",
    "  labs(\n",
    "    title = \"BIC Comparison Across Interaction Models (Self-Rated Health)\",\n",
    "    x = \"Model\",\n",
    "    y = \"BIC (lower = better)\"\n",
    "  ) +\n",
    "  theme_minimal(base_size = 13)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a3632304-9f8f-4130-9468-4f809129302f",
   "metadata": {},
   "source": [
    "# Step 13B: First-Order Interaction Models for BadPhysicalHealth"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "5ebc8660-7720-4602-9291-1be06b009a49",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n",
      "Warning message in logLik.svyglm(model):\n",
      "\"svyglm not fitted by maximum likelihood.\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Model     BIC\n",
      "1      Main 3214.02\n",
      "2      Race 3228.19\n",
      "3       Age 3218.15\n",
      "4    Income 3216.82\n",
      "5 Education 3234.48\n",
      "6    Gender 3221.78\n"
     ]
    }
   ],
   "source": [
    "# Add interaction term between BingeDrinker and RaceEthnicity (BadPhysicalHealth)\n",
    "model_interaction_race <- svyglm(\n",
    "  bad_phys ~ binge * race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Add interaction term between BingeDrinker and AgeGroup\n",
    "model_interaction_age <- svyglm(\n",
    "  bad_phys ~ binge * age_sq + race + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Add interaction term between BingeDrinker and Income\n",
    "model_interaction_income <- svyglm(\n",
    "  bad_phys ~ binge * inc + age_sq + race + sex + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Add interaction term between BingeDrinker and Education\n",
    "model_interaction_education <- svyglm(\n",
    "  bad_phys ~ binge * edu + age_sq + race + sex + inc +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Add interaction term between BingeDrinker and Gender\n",
    "model_interaction_gender <- svyglm(\n",
    "  bad_phys ~ binge * sex + age_sq + race + inc + edu +\n",
    "    emp + marital + ins + home + smoke +\n",
    "    heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# View summary of interaction model\n",
    "#summary(model_interaction_race)\n",
    "#summary(model_interaction_age)\n",
    "#summary(model_interaction_income)\n",
    "#summary(model_interaction_education)\n",
    "#summary(model_interaction_gender)\n",
    "\n",
    "# Exponentiate to get Odds Ratios and Confidence Intervals\n",
    "#exp(cbind(OR = coef(model_interaction), confint(model_interaction)))\n",
    "\n",
    "# Function to calculate approximate BIC\n",
    "approx_bic <- function(model, n) {\n",
    "  k <- length(coef(model))            # number of parameters\n",
    "  ll <- logLik(model)                 # log-likelihood (approximated)\n",
    "  bic <- -2 * as.numeric(ll) + k * log(n)\n",
    "  return(round(bic, 2))\n",
    "}\n",
    "\n",
    "# Sample size: number of complete cases used in the model\n",
    "n_obs <- nrow(model.frame(model_bad_phys))\n",
    "\n",
    "# Calculate approximate BIC for each model\n",
    "bic_main <- approx_bic(model_bad_phys, n_obs)\n",
    "bic_race <- approx_bic(model_interaction_race, n_obs)\n",
    "bic_age <- approx_bic(model_interaction_age, n_obs)\n",
    "bic_income <- approx_bic(model_interaction_income, n_obs)\n",
    "bic_education <- approx_bic(model_interaction_education, n_obs)\n",
    "bic_gender <- approx_bic(model_interaction_gender, n_obs)\n",
    "\n",
    "# Combine into table\n",
    "bic_df <- data.frame(\n",
    "  Model = c(\"Main\", \"Race\", \"Age\", \"Income\", \"Education\", \"Gender\"),\n",
    "  BIC = c(bic_main, bic_race, bic_age, bic_income, bic_education, bic_gender)\n",
    ")\n",
    "\n",
    "print(bic_df)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9afbb450-99e5-49e4-864b-d3f7668fe2b3",
   "metadata": {},
   "source": [
    "#  Visualize BIC Values for Bad Physical Health"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "a2fcea77-c12d-46ca-8672-a79c9ba542c7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAZlBMVEUAAAAAujgAv8RHR0dN\nTU1hnP9oaGhycnJ8fHyBgYGMjIyampqkpKSnp6eurq6ysrK3nwC3t7e9vb3AwMDHx8fIyMjP\nz8/Q0NDW1tbZ2dnd3d3h4eHp6enr6+vw8PD1ZOP4dm3////XZFWrAAAACXBIWXMAABJ0AAAS\ndAHeZh94AAAgAElEQVR4nO3di7aqQHaF4eo0oYmGNm1MG6OHhPd/yci9bijihO2Wf45xjiDC\norA+RGSrKQkhb8f89AoQ8g0BEiGCAIkQQYBEiCBAIkQQIBEiCJAIEQRIhAgCJEIEARIhggCJ\nEEEWgmTaJPtrd0c36Zyn9wm7UzjT+JS312b2rMkb80YTXd5l7tIu48uMJdkdb/3I7bhLHjw2\nttCHhS5mX0ae+SmL72YyaX59Xmji+kSqvDJr94jIJt6b8AlbGNI9ubMi17Tf0md3lvEpgrWZ\nO+f5vjratYmty37u+rUzTm5f/3Q0Mz+c72VISVKUkWd+yuKtmczxaaGJ6xOp8sqs7SNim7hI\nwj3QYpDakqek0dvece+Yu3O1vS+510PHp/xkdiY3mXSJL/fPVxf2+PHp0AVMKoV0dAn0z/yU\nxfcjxdGY65NCr+R9SCa2r2rb6jx61vo9jXUk13TE5o6LMf2BW5GZ4TDjwZSfTGGS+8GddGV+\nGNKh793n+7ASUruXDp75KYu3Ro7tAeKDWV/IQpDK8CVpcUjO+qTGegPUHFO3GZ/ykzmYQ/1P\nmB+GdOs37f4+LIR0anfSwTM/ZfHWSFEPfzqko/Hfya8KydtHWacV4lOOmTHZsV/MpRq9v/Cf\n77f7q3Nv90p73ifVO9ZbNzGvj9SbVSiqcxndu9lg4dXo3n/tSUxRvyq1Kaq3Fbv+3Wfevg2w\nl+QU8Sq6m6Mv2L43iKxTW8BplLUS/Yzd1n7apPudaffMmDQ6Xzt2HlvoSLPuyy2sh9iD7ur7\ni/dnKjtIp7Rb+7Q7Jrivslu8nc9+XoIuEK8Sb3swr72JhxWquKelmxUO7fb9HfvAcZfYlFt7\n9iG7NQs4N6PXvL117k3rB+26d6ztxL0ZIN2SdtohtvBmoYkr6VLzzrq3bN0Szs7CnSU5RdyK\nzpaxCw6QsnZJpVPAbZS1Eh6kCU26P/DQtuZ+ZBedr1uJvH0KvXUaa9at2xMGz7y7+v7i/Zna\n/Zaz9oe2c5zuFd3ibQPs58XvAvEq/YjTvHBeaxO7mzN497H0yYajfbIhHX27EZuSmew+6/0F\np32TZfZF9fYpMYeivGWdz/ocX/ugo0mrYsMs92lF2Su+z1+/m40u/L7Qa+odUu7r5+Zsdt1K\nVq+H9wXc7IU7S3KKuBWdLeMW7J/UaknXrKnXFfAa5a2EtcwJTbo/sDu2q07hxuZrx1JjTxzW\naaxZp46V/8x7q+8tvnRnuievX4Tbtc/qke5Iv+q8bvHuDcOwSYIuEK/ibrO2edF5+01srVA5\n4B6WVy4SM+Q8rPf4cWlkyrl79UzrRZhma966V5TmgKvfRdQPStu9XtFtA/vJdUoEC6+3z8U4\n7yHbxdQHeOVw+Hlsn+pDZEnPD8P7VySrYHNfv6TMXKwCbqP8lRiWOaVJ1QPbY7vq/sh8/Vji\nTuzWaaxZ/Ucr/jPvr76z+GBLXfemPYnern398Oatff2i5xYPN0nQBZxHOwmaF52338T2CkXe\nxi8PaVf06/MSpH13RNW8InSHBsbYR7+mOw959ve81ixdcWsfEiw8ckjddtZqJ3m05+kOPq6R\nJTlFTOxItls1txXNktq+eGmRXCNz+isRTnnUpGrk0L7M5tH5rDETW6exZvWHOsEzH139dvHD\ntD7JOdw++3pT1C8CbvHIJnEmPYPkNS82b7+J3c15809JLv0e6bKzdrovQWpfB7w+49127Ru2\nYnE57hJvK9YDefVp+6mYtPAmabuZr+1+0dgdo3uouySniDPizue3oinXPyb11mVoVHQl3CkP\nmlSNNPvSugtF5kuHMTOyTg+aVUaeeWf1vcUPc3f2Du4pi+61+titqFs8sknKeBeIj3jNi83r\nHD3H2tmNl4vEKrMf9mXjnw9FpgyLcBDGumA/VOTJsLvxG928lUwPRThftNddrb3XxZ8YmaUe\nsou4I858sVZ4e8t+wU6joivhTRlvUtvxHGzufMFSIus03iy3XvPMj6z+eBcPt09RvVZemrdp\nTvHIJhnpAvERr3mxeT8HkvWc5e5BwWH45DsyZQak4r4dkt3x6k9sB671tXztmbKHC2/XaUj4\nIeEIJLuINxJb7wmQ3EYJIOX3Q6GTfaRmT50CabxZbr36mR9b/Vcg3fezzWr7xcNNMtYF4iNu\n86Lzfg4kq7UX98DSGotMmXho1z8orXaBu8KZGKxNcc7NhIWXzrKtPXnYQm9JdpFwJFg1e8xd\nfv8Qt1HRlWinTDu0q4/tdsNr7MihXaxcZEMGU/xn3l19b/Hhcr072tvqfZ0ttCseruNYF4iP\nuM2Lzvs5kOznNbWvojvaI+GU4M2zu+Sumf2D8mHaZRRSWZ/3e7rwKifr/Wf9grlr3zK5HdVb\nkl0kOjIOaedem+avU9Oo6ErUNxOa1Iu1z0s9PNkwsk5hszITXObfrKO7+qMnG0o33trf39q7\nZ5Pa4uEmGesC8RG3edF5RyBd1z7ZMHww0K5i7+XkfDgcTglO57pL7prZP+g6TMtikLpr5urt\n/WThzUKGs2b16YZT7MyztySniDPibpkYpP7qjriEplHRlahvJjSpHcnNzvr8yp3v2q1r2k4M\n1ynaLOv0d39fbu/cmtX3Fu+uV+SO4XW/7fNu8XCTjHWB+IjbvOi8I5DWO/3dDtz2zkeHeXuN\n9+2UepcRhFP8DxjdJXfN7D7gq9q1M1lRz9EclbmQ8ubM6n3q4enCS//8Zq0qNbv6Iz934c6S\nnCJuRWfL+K24DEvyL4D2GuWthHVp/dMmWbuz7uqMcL6dSc9tuZF1ijYr+EC2e+a91fcWX3oz\n+Xd0t9XJunbALt4d5wybZKwLjGwKp3nReZ1NPNz+wAey9nNWbfAumXeeLpzSXrGR3mIt6ZrZ\nnhKoD6tuXcXUPc3WbbR28c8XXg7vbZvUR47eJULdNGdJThG3orve9ti+ebPbXavjFvAa5axE\nO2P70GdNsnavzm7Wma9b6fbS8Ng6xZp1617X/GfeW31v8e56hXcMr/vdgbZTvF3HZLTcM0hO\n86Lzupu4vw0uxVkakv/BQFmcqvP0yT78k6NwynnvXy8ZOSg6VZdmdlfD3WdI8lt7qtSDVJ6q\nHrM7T1h4GVwoX4/WF0zur/5D7SW5RdyK7nrbS9m3O9zqCsrEL+A2ylmJdsa+uz1uklVu70xz\nGlBfE5xd+omRdYo0q+9ZwTPvrb6/+HAlo2tv+nczdvF2sr1JRrrA2KZwmhed193E7e1trYtW\n10rwDJAfykn71yZebu7FWz+e4MgOSESUyJ9f67Is09ez2h/2rRUgfUwif34tSzH+dwM/kvX+\n1HytAOlz0nz5yRIx5lP+ZLrJil9+slaA9DlZ7gsC/L8T++ms+HVchGwrQCJEECARIgiQCBEE\nSIQIAiRCBAESIYIAiRBBgESIIEAiRBAgESLIJ0P684e6X134m+oCibqbazCQqPtVhb+pLpCo\nu7kGA4m6X1X4m+oCibqbazCQqPtVhb+pLpCou7kGA4m6X1X4m+oCibqbazCQqPtVhb+pLpCo\nu7kGA4m6X1X4m+oCibrf1uBi3/xqVtn8vHKyv3n3VnXPXs8/m2GGfMZXxgKJuit36GHwf/ZB\nrz10HfL+qDT86Z9JSfpfPCqawfqH64Z7q/bevO/ovTk/tZS8/k3jQPr+uk879L3wweoI/U8c\nlW/socuRDm0N3v4a9Nr+p2WbR+XR5T5JXn3B8bH+AaP7YFEWWfVzR9a9VXtTD1La/axY3i3h\nxWwQUrxflcPe8M9/Vb9dNjy9VmdyZxDXfbCDHnr2jDzr0PcN7fw2cucoeWcP/aBDd4PN753Z\nvfbUtTGvf2A8t37G95Xm9j9c2fxqef3T09a99/ZWP2lnz9ONe78Y+0J+ENLzDu0dyhZ7SYeO\nv/Jbe8P/bO7tevQt3vvkdR/soK/vQHraocs//4gs+1x9U/z8PfR4h+4Hjan3lPaPiObtSDNv\nMf/L8w/2q1lfob33z9+N+6vqx248aSG9/ltPPwjpaYf2D2XTbj/5VoeO9ytrb1iYv17LYtc/\nE1ZncmZQ132wg77OqtjmaYcu/63vwENu9XrM30O3iXfoZjBpIfW91hy8gsEPTE7MzjkqvLQj\n/b3/db+1m3Tpxw/tc/36z5r9HKSnHcs/lD2b7Fpe6x/KfadDx/uVtTc81V2o6J9f67m1Z5DX\nfbCDfv9HvB516NL8e0glS8rynT10nXiH7gYP7Z7D7rXeK9LM7nm8H6oNhbP24KK7t/jr35xt\nUCRZP36sdtHJjK39c5Cediz/ULb5VZr698Xf6dB1wn417A135p/eijaPStwZ5HUf7KCPwU+W\nvpbHHbraY/lNaunO30M3S4l26H7w738Nem3/Huk+231POb977vt9T2b9Pn19b2b+23kOs+rn\nAPsn38z7WbMfPtnwqGP5h7JZLe9m/Sr93O080q+GDn1/B7brDxuDznQxs84mPav7YAe9M9UP\nj+9n/yLekw4dgdT9Jt3sPXSXaIduB/8t7LXd4XV97P4OpP6IwnZU35ubf/yx+05e76Wa8bx9\nrl9/gn8U0uOO5R/KBsfrszv0SL/qC/zNOdkQdKZs7m88Pq77YAe9M+75jxl51KFDSP2PH8/e\nQ3eJdeh2MG/3HPaz2K3HbW+S/I2X/m5Jtyy5ePf2Z/fdM6KmOf/R3PWrTjY861j+oWwAaXaH\nLuP9aoB0c55frzM5uzhh3Qc7aFPvNOfsKPs86NARSKlpNu38PXSfoEP3g8Y/li1Ldz3mnWNJ\n2iOX6t33Oclu/r1TIP2q0991HnQs/1DWb+RbHTrWr/oC/2M/wO9Mb5V9VPfRDrodm/me31pU\nrEOHkPrj5/l76LEObQ0GZ1eGkWbe4yzA9XYsdlXHug7vA6x7689VfCvN+H16/fnV64B/GtJ4\nx/IPZX1I73Xo2Ct/D9h9fp3O5B8qCOs+3UHPPNJ52qFDSP2R3Tunv+Md2hrcmb8HvdbeqVzS\nWR/Itp+rVGX21mvPcK8NyXuWf/ElQqMdy38Fbk82FM22mN+hR/pVaT2J/6zrpO7d9Y07g7bu\n0x10Me9jlacdOoTU/2z3/D10OdKhrUH7E+jhOKu+Kd64RKi5Tu/YLM3qQv29DyD9xotWn3Ws\nAFLenv7eBzO8lHi/Gure7/1bYZ89szqTN4O27sMddHN0Oe/s2bMObUNqblPTbt13LhGKd2j7\nWbWuifIgVScbTPbWIceDfNefUTztWP6hbPOBbH1E906HHnnlt+o2d6fdXVZn8mbQ1n2+g57b\n6GcdOoA0NPCdi1af5puuDv7BQ7unHdp/BU76Dv5Whx555bfq/iOtzr32dw2dyX+R1NZ9sIMu\nhuOSBfJNHfqn6v7ke6SnHdqDdKs62v79Dv0s3/T8fnThb6r74ycbHuSbtvMn191cg4FE3a8q\n/E11gUTd39zg/1gxD1cESNRVFP7fFWPXBdKEbK1DAwlIi+QXd+j/WzF23b+sGbswkN7uM5Py\nryvGrvsvK8auCyQgLRIgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQg\nAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlI\nQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAIS\nkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAE\nJEGABCQgtUmS5OnAWIAEJCA1Sdp/jwZGAyQgAamOJyaJDYwHSEAC0pCJkP4EWROSXXdNSHbd\nNSHZdVeFZBdeE5Jdd01IYbeeC6l/VQISkIA0F1J7RoFDu5HYddeEZNddFZJdeE1Idt01IT3U\nscihXRggAQlIVqJ+gAQkID2cGgRIQAJSLK+d/gYSkIAUzXRIfCALJCCNhkuEgASkdSG9EyAB\nCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhA\nApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQ\ngCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQk\nIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJ\nSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEAC\nkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCA\nJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQg\nCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlI\nggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKS\nIEACEpAEARKQgCQIkIAEJEGABCQgvZw/QdaEZNddE5Jdd01Idt1VIdmF14Rk110TUtitl4YU\nZk1Idt01Idl114Rk110Vkl14TUh23TUhPezhQAISkIAEJCABCUhAAtJrARKQgCQIkIAEJEGA\nBCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAg\nAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRI\nQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAES\nkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAE\nJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECAB\n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\nAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQ\ngAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCaVQ\n3u0AAAg8SURBVAIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkC\nJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIA\nCUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgvZw/QdaEZNddE5Jdd01Idt1VIdmF14Rk\n110TUtitl4YUZk1Idt01Idl114Rk110Vkl14TUh23TUhPezhQAISkIAEJCABCUhAAtJrARKQ\ngCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQk\nIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJ\nSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEAC\nkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCA\nJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKSIEACEpAEARKQgCQIkIAEJEGABCQg\nCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAkCJCABCRBgAQkIAkCJCABSRAgAQlI\nggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJAiQgAUkQIAEJSIIACUhAEgRIQAKS\nIEACEpAEARKQgCQIkIAEJEGABCQgCQIkIAFJECABCUiCAAlIQBIESEACkiBAAhKQBAESkIAk\nCJCABCRBgAQkIAkCJCABSRAgAQlIggAJSEASBEhAApIgQAISkAQBEpCAJAiQgAQkQYAEJCAJ\nAiQgAUkQIAEJSM+TJMnjBwAJSEB6mqT9Nx4gAQlIz5JY/48ESEAC0rMEkP4EWROSXXdNSHbd\nNSHZdVeFZBdeE5Jdd01IYbdeHxIhX5ilIYnirOiK2VrdzTV4ibpAou7mGgykdbK1uptrMJDW\nydbqbq7BQFonW6u7uQZ/KqQJH8jOyjdt50+uu7kGfyyk55cIzco3bedPrru5Bn8upGXyTdv5\nk+tursFAou5XFf6mukCi7uYaDCTqflXhb6oLJOpursFAou5XFf6mukCi7uYaDCTqflXhb6oL\nJOpursFAou5XFf6mukCi7uYaDCTqflXhb6oLJOpursFAou5XFf6mukCi7uYaDCTqflXhb6oL\nJOpursFAou5XFf6mukCi7uYaDCTqflXhb6oLJOpursFAou5XFf6mukCi7uYaDCTqflXhb6oL\nJOpursFbg0TIrwmQCBEESIQIAiRCBAESIYIAiRBBgESIIEAiRBAgESIIkAgRBEiECAIkQgT5\nJEhJZMgdXqrej2bN1Uie/f78kiuTNFmwglVlqPO8wYpV+ihIiT+wcL1VqjxLsuJ6JP1/Dx+x\nZPXFN3uw+HX2HED66awIaUJPXgHSwu0FUt+l2tv25bn5t8QxgbfkvkI7kDQDweQlVqKv0LV8\nqVLWmNXKoYWJP2mB+vazG252VZV+mUnZ9yuvXNL+76zIzL72uZC6w5B6+Pkxyax69pLtmsOk\nJPEnL7ES7uosWSqom0Ta7EzS1w+3tHOvqEq/TAeSU67vXs7UeX3tsyB1rbHb7vY0cT23TGQg\n8e9Vx31mFy/lDo+3exiQ13+y2d+uMpxrmNrI+GNfy8dCqu9IEq+V6nqRXrMuJHdfuQKktpP9\nCCTvbFoS3exvV/EHR5vkdK/vgzS8xLrjPwxpoVO3sd3nUmeJ7Sb2RSKdzZ0kru/tI21WmlZP\nhOR3ry+DVPbvj4LX3k94RZInGW4XeyEIij1obmSSun7iDOqLTYMUdC8gvVvPKhMZSPx79asw\nugLyJMPNs3YvIXockrLVEyDFute3QXJ77orvkYaxYMTb2OI16IfqCouVGupFmjyMJcEkcXV7\n20Y3u6jKUCqJlQu7V7hBXsrHQurP8K8FKfI5kvvfEu+Q3HVZ+HOksrQ/IrFbOZRNgknC4tZt\nEjZW9TmSfYlQVyUs13ev8HMke10n55MgkaVeicjiAdKnZJEXAbJWgPQxWeHKaLJYgESIIEAi\nRBAgESIIkAgRBEiECAIkQgQB0i9Ksjve2sHbcTd6rtyYx+NkgbCNf1GMMXk7mJtxHkD6gbCN\nf1GMSfvr1VIgfVTYxr8oxhzMpR663IeA9ElhG/+iGHNrj+1yc215XPeJSfbX5gHnzCSHFs4l\nMyY7N7P9xMpuLGzjX5S7iLS75L/lcTZNajF5Pbivp5ya+/MSSKuEbfyLcheR18d2lzuQmsf9\ndelQlMVd0K0eOd1pJdWUq8nuD7xmlTAgrRC28S/KXcSlfo2pONU88vZQb1/d5uZYDReJqYaL\netjsgLRK2Ma/KJWI5g+mTcsjNc0HSzeTViM1nnJnquEuQFolbONfFGOaF6OL2bc8eiM2mKwe\nBtKqYRv/olQizuZwx3R+BMnHA6QVwjb+RWnspPWRXeTQrgVT1EeA5urORpYN2/gXpRaxN2eT\ndSN5dZBXticbdg2eYzVl30y4Vg8F0gphG/+i1CKqT45O3cjNmLw5/X2tBCWn5gOk+lT4ndY1\n4fT3SmEb/6LUIu5HbvXZucgHslk9eOi98YHsemEb/6I0IrL6yK7j4VwidLIuEbrliUmP1iPJ\nkmEbEyIIkAgRBEiECAIkQgQBEiGCAIkQQYBEiCBAIkQQIBEiCJAIEQRIhAgCJEIEARIhggCJ\nEEGARIgg/w89TTO0mO7wmgAAAABJRU5ErkJggg==",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Load ggplot2\n",
    "library(ggplot2)\n",
    "\n",
    "# BIC bar plot\n",
    "ggplot(bic_df, aes(x = reorder(Model, BIC), y = BIC, fill = Model)) +\n",
    "  geom_col(show.legend = FALSE) +\n",
    "  geom_text(aes(label = BIC), vjust = -0.5, size = 4) +\n",
    "  labs(\n",
    "    title = \"BIC Comparison Across Interaction Models (Bad Physical Health)\",\n",
    "    x = \"Model\",\n",
    "    y = \"BIC (lower = better)\"\n",
    "  ) +\n",
    "  theme_minimal(base_size = 13)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2484a07c-e87d-44cf-b99e-cbcfff6fd4e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#None of the interactions tested substantially improved the model fit.\n",
    "#, the effect of binge drinking on bad physical health seems consistent across groups — no strong interaction detected."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "409b1bb5-b858-4ebe-8896-7468076d7e30",
   "metadata": {},
   "source": [
    "# Step 13C: First-Order Interaction Models for Activity Limitation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "f92a49c9-7a8b-4b67-a2ab-414ce35b7b37",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Model     BIC\n",
      "1      Main 3176.77\n",
      "2      Race 3193.90\n",
      "3       Age 3184.69\n",
      "4    Income 3206.06\n",
      "5 Education 3197.96\n",
      "6    Gender 3172.91\n"
     ]
    }
   ],
   "source": [
    "# STEP XX: First-Order Interaction Models for Activity Limitation\n",
    "\n",
    "# A. Fit Interaction Models (binge * X) for Activity Limitation\n",
    "\n",
    "\n",
    "# Main model (no interaction)\n",
    "model_activity_lim <- svyglm(\n",
    "  activity_limit ~ binge + age_sq + race + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Race\n",
    "model_interaction_race <- svyglm(\n",
    "  activity_limit ~ binge * race + age_sq + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Age (squared)\n",
    "model_interaction_age <- svyglm(\n",
    "  activity_limit ~ binge * age_sq + race + sex + inc + edu +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Income\n",
    "model_interaction_income <- svyglm(\n",
    "  activity_limit ~ binge * inc + age_sq + race + sex + edu +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Education\n",
    "model_interaction_education <- svyglm(\n",
    "  activity_limit ~ binge * edu + age_sq + race + sex + inc +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "# Interaction: Binge * Gender\n",
    "model_interaction_gender <- svyglm(\n",
    "  activity_limit ~ binge * sex + age_sq + race + inc + edu +\n",
    "    emp + marital + ins + home + smoke + heavy + active + bmi +\n",
    "    asthma + arth + copd + chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")\n",
    "\n",
    "\n",
    "#B. Compute BIC for Model Comparison\n",
    "\n",
    "\n",
    "# Safe BIC for svyglm using deviance\n",
    "approx_bic <- function(model, n) {\n",
    "  k <- length(coef(model))         # number of parameters\n",
    "  dev <- model$deviance            # deviance instead of log-likelihood\n",
    "  bic <- dev + k * log(n)\n",
    "  return(round(bic, 2))\n",
    "}\n",
    "\n",
    "# Sample size used in the model\n",
    "n_obs <- nrow(model.frame(model_activity_lim))\n",
    "\n",
    "# Compute BIC for each model\n",
    "bic_main      <- approx_bic(model_activity_lim, n_obs)\n",
    "bic_race      <- approx_bic(model_interaction_race, n_obs)\n",
    "bic_age       <- approx_bic(model_interaction_age, n_obs)\n",
    "bic_income    <- approx_bic(model_interaction_income, n_obs)\n",
    "bic_education <- approx_bic(model_interaction_education, n_obs)\n",
    "bic_gender    <- approx_bic(model_interaction_gender, n_obs)\n",
    "\n",
    "\n",
    "#C. Summarize BIC Comparison Table\n",
    "\n",
    "\n",
    "bic_df_activitylim <- data.frame(\n",
    "  Model = c(\"Main\", \"Race\", \"Age\", \"Income\", \"Education\", \"Gender\"),\n",
    "  BIC   = c(bic_main, bic_race, bic_age, bic_income, bic_education, bic_gender)\n",
    ")\n",
    "\n",
    "print(bic_df_activitylim)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c98afeaf-f2b1-4303-a60a-6a3959c29437",
   "metadata": {},
   "source": [
    "# Visualize BIC Values for Activity Limitation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "id": "8ce0f7d9-b169-416d-bdbf-ad1ed389e2a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAANlBMVEUAAABNTU1oaGh8fHyM\njIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD/jAD///89EPH9AAAACXBIWXMA\nABJ0AAASdAHeZh94AAAgAElEQVR4nO2diXaiWgAEwSV7xuf//+xjE6FFQ5JWjF11ziSGIMVF\nShCdmWIPAL+mWHoFAB4BQgIwQEgABggJwAAhARggJAADhARggJAADBASgAFCAjDgDKloWT0f\nfuymv26qqZs3mXt66s+8hoVML2q3/d792/nnrFC5efnsbn6+bMq5KzS96N222uxfGosJy/QK\nNz+fG/tg5jMDPXP3+RvnD3KFkIpi3f3YfPsoR1M7pqf+1Pv7ZZxZ1HcX3c4/517V0J+6m0/F\n+TvMW6HNjA35Vs1z+rQ1vcLNz+dWamZIp7+bv3H+IN6Qmm8f63YXaX/8qA4779X393WxOc46\nPXV5PCHNm3N1OECUq9+GVBQfXwo3xdPEtr6wwjNCusS5kB6UK4S0/2zPIdofV8VL9+v14Alx\neury3DKk5+K9ufVe3fp1SF/6dtW536rYfeOehPQdrhHS8Bj+dnwW/OjPZSamfmyrU/jtR3e/\n57JYVX29VN9e2inVzXVX3FP1BL5+b+fcraoldYe+6nVCuW33zfHSntqlzR7C8S7NyWc9vTpy\ndv7OOVyNajzVr7e7fv7DofnSWhTFZ7c9noqP0zs0yyyf96d6Ger+cEp9YuzWs+O5eup6KZ73\n/cJlhXf9i6wqt3ZaRT/1+OuTU7vJx+u46frt9I2N8we5RkjdRm9+3EwecE6mvnWvmN727XN1\nzfu2+fZynNLseOVwzk09sRG9D5YwXtq6vz1zCMe7HPaG16L3d87hajQvcor6MDzaVy6vRTVP\nd25XlhN36Ja5PdWPh9ouqlvNsXFzfBXWbLZd9cB0Z5NTK7ztD5DbQQlPneW1b3AipNPH6xjS\ncTt9Y+P8Qa7zGun45Fmenk1MTK2ekp+rx7l6fD/r+5Vv9WNdtt9WzZTXatuX9SuB5+YRfW5e\nW1ePwO4gWhXVLNXjvTpd2vt+t5l5UaPbM/q7HF7n1U+p7bg653A1PuoV3jWvDAfH4i/WotlJ\nm5eJh6eC0R2qH9ohF6ofDXW05cW4Hm7j9hxg2z4ykyv80R2/NtVaHa8WfHaWdfE5lo0218nj\n1c82frjmbpw/yFWu2j13P+5HW3005/jnp+65c9s+tvWjvSuOORbdo1g+7Q/n+d3C36dE00ub\nOYT96C7d2Unr3NW7Wuccrsa2ecG363eh9usXa1HdfG/meDrsuKM7PLUvIndlofrzrz7E+D6c\nY9Mdqjf7syvcDmknJWya6xi7k2onNtfg8epnGz9cczfOH+QqIW0Op75zQ1p1pXy2j+JuME/z\nwHTPVZv20fx4e14PF96dQ5bb18+ppU0azw5BzN3ecGC4oH41Bq/hR/vlxbWob5b1mVZZTN3h\nsMxNcaofDHWknTJ2HE7q2lOB6RV+a3bu5/pwN9gM7YFqcGY3EdLJ4zV65OXhmrNx/iBXOLXb\nVa853/f9Fps6tdOp/TYc7KrDB2Z1uNu+eUV7OP8ezvnZTO5f655Z2qD2EaMVOQlpON9h3tPV\nOGrGU6fWor1ZH4zqlyTn71CdUp3qB0M91eoCWp5HZwvTK9x1XcoAmkPS4MxuIqThZA3pZDvN\n2Th/kCuE1JzUH37cDl9C9g+GTp0ZUr1XvVQn/0+vnxMP4du221GuENLJICdW4/jbuSG9VWv7\ndHjlM92BNtHe7od6qp26U/+Sv2iuMJwLqT4YvfWXNA5z1Yek4Znd90I63U6E9PWyJvbHwYXu\nz7J/NalTLxzpmy3dzb1pznlOXhcdvR/bekexn9qVg/c7u18OV6P86ald/QxRFpfu0LxwmNAf\nhjqaev7U7ri9m9dK0yvc5NIeekY7+7rYDc/svhfS6cM1Z+P8Qa50RDo+75XNJaZ9c0JyPAzJ\n1Kei/WDW9nghafzAtK+2y/63b9MhtbcvLG3WEE5C2rYL/DhexxutxrZ7sVyO9pUv1uJwz+PB\ne3SH9jV+/YQ+qZ9a2KSxZdNfeXivk5pe4UbUFjcKqTpurgZndt8L6fThmrNx/iDXCOm9PJ4f\n1G961B8Gql84Dd4elKnVof+pvRr6Mf3A1FdW35on0uYzEe1l4dGc7TXh5lMwF5Y2awgjc70H\nfTTvyHyU/VnYeDXeivKjv5rcP6F/sRbdPZur3BN3eGmu+L82Z52qHwx1tOWnjA3DM7P65en0\nCjeiwTsXh2ul+1U5+kTs7JA+9/pwzd04fxBvSAfW7Y/N1MNbb+MPesnU8ftz+/1eHphN/9uX\nwx3fx3N271KWnxeX9vUQxndZFf0OXxSDp4fRanTvb9aDXg0uSFxei+ZmdeZW9O+Ejd+Qbd+j\n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\nfKOJ28cw1QAAAABJRU5ErkJggg==",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "library(ggplot2)\n",
    "\n",
    "# BIC bar plot\n",
    "ggplot(bic_df_activitylim, aes(x = reorder(Model, BIC), y = BIC)) +\n",
    "  geom_col(fill = \"darkorange\") +\n",
    "  geom_text(aes(label = BIC), vjust = -0.5, size = 3.5) +\n",
    "  labs(\n",
    "    title = \"BIC Comparison — Interaction Models for Activity Limitation\",\n",
    "    x = \"Model (Interaction Variable)\",\n",
    "    y = \"BIC Value\"\n",
    "  ) +\n",
    "  theme_minimal()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89aa7406-1c46-4d3a-8a90-900a456c9a56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#the Gender interaction model (3172.91) has a lower BIC than the main model (3176.77).\n",
    "\n",
    "#This suggests that including an interaction term between binge drinking and gender improves the model fit\n",
    "#This suggests that the effect of binge drinking on activity limitation varies by gender."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71588cc8-1998-4a49-9df0-0954c37bdd55",
   "metadata": {},
   "source": [
    "# STEP 14: Second-Order Interaction Models for Activity Limitation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 142,
   "id": "b928d938-73e9-4ac9-8432-458b0286eb52",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                           Model     BIC\n",
      "1  activitylim_model_race_age_sq 3201.62\n",
      "2     activitylim_model_race_inc 3222.98\n",
      "3     activitylim_model_race_edu 3214.80\n",
      "4     activitylim_model_race_sex 3190.75\n",
      "5   activitylim_model_age_sq_inc 3213.94\n",
      "6   activitylim_model_age_sq_edu 3205.87\n",
      "7   activitylim_model_age_sq_sex 3180.82\n",
      "8      activitylim_model_inc_edu 3226.41\n",
      "9      activitylim_model_inc_sex 3201.56\n",
      "10     activitylim_model_edu_sex 3193.35\n",
      "                           Model     BIC\n",
      "7   activitylim_model_age_sq_sex 3180.82\n",
      "4     activitylim_model_race_sex 3190.75\n",
      "10     activitylim_model_edu_sex 3193.35\n",
      "9      activitylim_model_inc_sex 3201.56\n",
      "1  activitylim_model_race_age_sq 3201.62\n",
      "6   activitylim_model_age_sq_edu 3205.87\n",
      "5   activitylim_model_age_sq_inc 3213.94\n",
      "3     activitylim_model_race_edu 3214.80\n",
      "2     activitylim_model_race_inc 3222.98\n",
      "8      activitylim_model_inc_edu 3226.41\n"
     ]
    }
   ],
   "source": [
    "\n",
    "# Fit All Two-Way Interaction Models (Binge * X1 + Binge * X2)\n",
    "\n",
    "\n",
    "# Load required libraries\n",
    "library(survey)\n",
    "library(dplyr)\n",
    "\n",
    "# Define variables to be used in interaction pairs\n",
    "interaction_vars <- c(\"race\", \"age_sq\", \"inc\", \"edu\", \"sex\")\n",
    "\n",
    "# Define common covariates (used in every model)\n",
    "common_covariates <- c(\n",
    "  \"emp\", \"marital\", \"ins\", \"home\", \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\", \"kidney\", \"stroke\", \"disab\", \"MCC\", \"year\"\n",
    ")\n",
    "\n",
    "# Get sample size based on complete cases\n",
    "n_obs <- nrow(model.frame(model_activity_lim))\n",
    "\n",
    "# Initialize\n",
    "model_list <- list()\n",
    "bic_results <- data.frame(Model = character(), BIC = numeric(), stringsAsFactors = FALSE)\n",
    "\n",
    "# Generate all 2-way combinations of interaction variables\n",
    "combinations <- combn(interaction_vars, 2, simplify = FALSE)\n",
    "\n",
    "# Loop through combinations\n",
    "for (pair in combinations) {\n",
    "  var1 <- pair[1]\n",
    "  var2 <- pair[2]\n",
    "\n",
    "  remaining_vars <- setdiff(interaction_vars, c(var1, var2))\n",
    "  interaction_terms <- paste0(\"binge * \", var1, \" + binge * \", var2)\n",
    "  main_effects <- paste(c(remaining_vars, common_covariates), collapse = \" + \")\n",
    "  \n",
    "  # Construct full formula\n",
    "  formula_str <- paste(\"activity_limit ~\", interaction_terms, \"+\", main_effects)\n",
    "  full_formula <- as.formula(formula_str)\n",
    "  \n",
    "  # Fit the model\n",
    "  model_fit <- svyglm(\n",
    "    formula = full_formula,\n",
    "    design = brfss_svy,\n",
    "    family = quasibinomial()\n",
    "  )\n",
    "  \n",
    "  # Store model and BIC\n",
    "  model_name <- paste0(\"activitylim_model_\", var1, \"_\", var2)\n",
    "  model_list[[model_name]] <- model_fit\n",
    "  model_bic <- approx_bic(model_fit, n_obs)\n",
    "  \n",
    "  bic_results <- rbind(\n",
    "    bic_results,\n",
    "    data.frame(Model = model_name, BIC = model_bic, stringsAsFactors = FALSE)\n",
    "  )\n",
    "}\n",
    "\n",
    "\n",
    "# View Second-Order Interaction BIC Results\n",
    "\n",
    "\n",
    "print(bic_results)\n",
    "\n",
    "#Sort by BIC (lower = better)\n",
    "bic_results_sorted <- bic_results[order(bic_results$BIC), ]\n",
    "print(bic_results_sorted)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "3508f0f9-e5bf-4e3c-92ed-073c902bcd7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#The effect of binge drinking on activity limitation changes depending on race and age\n",
    "\n",
    "#That combined interaction gives the best model fit (lowest BIC) out of all the pairs tested\n",
    "\n",
    "#In second-order interaction models for activity limitation, the model including binge × age and binge × sex had the lowest BIC (3180.82), indicating that the effect of binge drinking on activity limitation is modified by both age and gender."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "6d2cbb29-8284-44c1-b202-2b169969d7d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Final model for activity limitation (based on BIC)\n",
    "final_model_activity_lim <- svyglm(\n",
    "  activity_limit ~ binge * age_sq + binge * sex +\n",
    "    inc + edu + emp + marital + ins + home +\n",
    "    smoke + heavy + active + bmi + asthma + arth + copd +\n",
    "    chd + diab + kidney + stroke + disab + MCC + year,\n",
    "  design = brfss_svy,\n",
    "  family = quasibinomial()\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "394c8fad-0bb8-4d06-a8c9-065e29fe14c3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "svyglm(formula = activity_limit ~ binge * age_sq + binge * sex + \n",
       "    inc + edu + emp + marital + ins + home + smoke + heavy + \n",
       "    active + bmi + asthma + arth + copd + chd + diab + kidney + \n",
       "    stroke + disab + MCC + year, design = brfss_svy, family = quasibinomial())\n",
       "\n",
       "Survey design:\n",
       "svydesign(ids = ~1, strata = ~strata_year, weights = ~weight, \n",
       "    data = brfss_merged2, nest = TRUE)\n",
       "\n",
       "Coefficients:\n",
       "                        Estimate Std. Error t value Pr(>|t|)    \n",
       "(Intercept)           -2.776e+00  3.869e-01  -7.175 1.79e-12 ***\n",
       "binge1                -1.219e+00  4.654e-01  -2.618 0.009020 ** \n",
       "age_sq                -2.016e-05  6.548e-05  -0.308 0.758275    \n",
       "sex1                   2.867e-01  1.882e-01   1.523 0.128095    \n",
       "inc$15k-$25k           4.080e-01  2.964e-01   1.376 0.169092    \n",
       "inc$25k-$35k           2.949e-01  3.259e-01   0.905 0.365874    \n",
       "inc$35k-$50k           2.979e-01  3.405e-01   0.875 0.381912    \n",
       "inc$50k-$75k           5.438e-01  2.924e-01   1.860 0.063348 .  \n",
       "inc<$15k               6.061e-01  3.324e-01   1.823 0.068668 .  \n",
       "eduAttended College    2.312e-01  2.186e-01   1.057 0.290685    \n",
       "eduHS Graduate         2.014e-01  2.312e-01   0.871 0.384056    \n",
       "eduLess than HS        2.038e-01  3.006e-01   0.678 0.497942    \n",
       "empNot in Labor Force  5.814e-01  1.868e-01   3.112 0.001932 ** \n",
       "empUnemployed          9.636e-01  4.044e-01   2.383 0.017441 *  \n",
       "maritalCohabiting     -2.221e-01  3.693e-01  -0.602 0.547645    \n",
       "maritalDivorced        3.980e-02  1.995e-01   0.199 0.841964    \n",
       "maritalNever Married   9.232e-02  2.479e-01   0.372 0.709643    \n",
       "ins0                   1.478e-01  2.375e-01   0.622 0.533953    \n",
       "homeOther              6.103e-01  3.351e-01   1.822 0.068927 .  \n",
       "homeRent               5.702e-02  1.847e-01   0.309 0.757667    \n",
       "smokeSmoker            4.134e-01  1.740e-01   2.376 0.017755 *  \n",
       "heavyYes               4.035e-01  3.584e-01   1.126 0.260658    \n",
       "activeNo               6.021e-01  1.684e-01   3.574 0.000374 ***\n",
       "bmiObese              -6.828e-02  2.012e-01  -0.339 0.734404    \n",
       "bmiOverweight          8.863e-02  2.026e-01   0.437 0.661904    \n",
       "asthmaYes             -1.137e-01  2.138e-01  -0.532 0.594849    \n",
       "arthYes                6.907e-01  2.212e-01   3.123 0.001864 ** \n",
       "copdYes                1.513e-01  2.498e-01   0.606 0.545009    \n",
       "chdYes                 5.021e-02  3.004e-01   0.167 0.867317    \n",
       "diabYes                6.136e-01  2.442e-01   2.512 0.012208 *  \n",
       "kidneyYes              3.353e-01  4.205e-01   0.797 0.425547    \n",
       "strokeYes              3.038e-01  2.728e-01   1.114 0.265813    \n",
       "disabYes               1.356e+00  1.961e-01   6.912 1.04e-11 ***\n",
       "MCCYes                -4.716e-01  3.185e-01  -1.481 0.139118    \n",
       "year2014              -4.693e-02  2.856e-01  -0.164 0.869508    \n",
       "year2015               2.025e-01  2.720e-01   0.744 0.456895    \n",
       "year2016              -3.856e-01  3.012e-01  -1.280 0.200847    \n",
       "year2017              -1.933e-01  2.898e-01  -0.667 0.504875    \n",
       "year2018              -3.643e-01  2.876e-01  -1.267 0.205640    \n",
       "year2019              -4.070e-01  2.876e-01  -1.415 0.157427    \n",
       "binge1:age_sq          1.787e-05  1.552e-04   0.115 0.908368    \n",
       "binge1:sex1            8.643e-01  4.226e-01   2.045 0.041210 *  \n",
       "---\n",
       "Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n",
       "\n",
       "(Dispersion parameter for quasibinomial family taken to be 0.9951197)\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "summary(final_model_activity_lim)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "4659ba7c-3e4d-4403-97c4-d2645b6b6778",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A matrix: 42 × 3 of type dbl</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>OR</th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>(Intercept)</th><td>0.06229245</td><td>0.02914506</td><td>0.1331392</td></tr>\n",
       "\t<tr><th scope=row>binge1</th><td>0.29564383</td><td>0.11856382</td><td>0.7372002</td></tr>\n",
       "\t<tr><th scope=row>age_sq</th><td>0.99997984</td><td>0.99985129</td><td>1.0001084</td></tr>\n",
       "\t<tr><th scope=row>sex1</th><td>1.33205425</td><td>0.92055071</td><td>1.9275076</td></tr>\n",
       "\t<tr><th scope=row>inc$15k-$25k</th><td>1.50377958</td><td>0.84037778</td><td>2.6908768</td></tr>\n",
       "\t<tr><th scope=row>inc$25k-$35k</th><td>1.34301216</td><td>0.70822311</td><td>2.5467704</td></tr>\n",
       "\t<tr><th scope=row>inc$35k-$50k</th><td>1.34707348</td><td>0.69031390</td><td>2.6286693</td></tr>\n",
       "\t<tr><th scope=row>inc$50k-$75k</th><td>1.72255945</td><td>0.97014534</td><td>3.0585222</td></tr>\n",
       "\t<tr><th scope=row>inc&lt;$15k</th><td>1.83325448</td><td>0.95454957</td><td>3.5208459</td></tr>\n",
       "\t<tr><th scope=row>eduAttended College</th><td>1.26009676</td><td>0.82032466</td><td>1.9356286</td></tr>\n",
       "\t<tr><th scope=row>eduHS Graduate</th><td>1.22312757</td><td>0.77679098</td><td>1.9259249</td></tr>\n",
       "\t<tr><th scope=row>eduLess than HS</th><td>1.22607292</td><td>0.67956795</td><td>2.2120743</td></tr>\n",
       "\t<tr><th scope=row>empNot in Labor Force</th><td>1.78851709</td><td>1.23936719</td><td>2.5809892</td></tr>\n",
       "\t<tr><th scope=row>empUnemployed</th><td>2.62107608</td><td>1.18488862</td><td>5.7980469</td></tr>\n",
       "\t<tr><th scope=row>maritalCohabiting</th><td>0.80079707</td><td>0.38785414</td><td>1.6533946</td></tr>\n",
       "\t<tr><th scope=row>maritalDivorced</th><td>1.04060254</td><td>0.70331153</td><td>1.5396501</td></tr>\n",
       "\t<tr><th scope=row>maritalNever Married</th><td>1.09671803</td><td>0.67416507</td><td>1.7841186</td></tr>\n",
       "\t<tr><th scope=row>ins0</th><td>1.15930008</td><td>0.72721675</td><td>1.8481102</td></tr>\n",
       "\t<tr><th scope=row>homeOther</th><td>1.84103599</td><td>0.95365400</td><td>3.5541334</td></tr>\n",
       "\t<tr><th scope=row>homeRent</th><td>1.05867174</td><td>0.73666060</td><td>1.5214413</td></tr>\n",
       "\t<tr><th scope=row>smokeSmoker</th><td>1.51194451</td><td>1.07447442</td><td>2.1275297</td></tr>\n",
       "\t<tr><th scope=row>heavyYes</th><td>1.49700398</td><td>0.74068895</td><td>3.0255898</td></tr>\n",
       "\t<tr><th scope=row>activeNo</th><td>1.82590157</td><td>1.31176817</td><td>2.5415440</td></tr>\n",
       "\t<tr><th scope=row>bmiObese</th><td>0.93399966</td><td>0.62924650</td><td>1.3863492</td></tr>\n",
       "\t<tr><th scope=row>bmiOverweight</th><td>1.09267561</td><td>0.73409442</td><td>1.6264120</td></tr>\n",
       "\t<tr><th scope=row>asthmaYes</th><td>0.89248439</td><td>0.58657287</td><td>1.3579359</td></tr>\n",
       "\t<tr><th scope=row>arthYes</th><td>1.99504784</td><td>1.29229872</td><td>3.0799503</td></tr>\n",
       "\t<tr><th scope=row>copdYes</th><td>1.16329997</td><td>0.71237918</td><td>1.8996440</td></tr>\n",
       "\t<tr><th scope=row>chdYes</th><td>1.05148978</td><td>0.58298946</td><td>1.8964850</td></tr>\n",
       "\t<tr><th scope=row>diabYes</th><td>1.84703335</td><td>1.14352173</td><td>2.9833558</td></tr>\n",
       "\t<tr><th scope=row>kidneyYes</th><td>1.39834505</td><td>0.61242426</td><td>3.1928338</td></tr>\n",
       "\t<tr><th scope=row>strokeYes</th><td>1.35495465</td><td>0.79313874</td><td>2.3147301</td></tr>\n",
       "\t<tr><th scope=row>disabYes</th><td>3.87925940</td><td>2.63957672</td><td>5.7011616</td></tr>\n",
       "\t<tr><th scope=row>MCCYes</th><td>0.62402651</td><td>0.33393958</td><td>1.1661064</td></tr>\n",
       "\t<tr><th scope=row>year2014</th><td>0.95415478</td><td>0.54468257</td><td>1.6714530</td></tr>\n",
       "\t<tr><th scope=row>year2015</th><td>1.22446086</td><td>0.71778443</td><td>2.0887948</td></tr>\n",
       "\t<tr><th scope=row>year2016</th><td>0.68004606</td><td>0.37648740</td><td>1.2283615</td></tr>\n",
       "\t<tr><th scope=row>year2017</th><td>0.82421773</td><td>0.46664264</td><td>1.4557925</td></tr>\n",
       "\t<tr><th scope=row>year2018</th><td>0.69466719</td><td>0.39497096</td><td>1.2217670</td></tr>\n",
       "\t<tr><th scope=row>year2019</th><td>0.66563912</td><td>0.37847218</td><td>1.1706949</td></tr>\n",
       "\t<tr><th scope=row>binge1:age_sq</th><td>1.00001787</td><td>0.99971314</td><td>1.0003227</td></tr>\n",
       "\t<tr><th scope=row>binge1:sex1</th><td>2.37323669</td><td>1.03517985</td><td>5.4408443</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A matrix: 42 × 3 of type dbl\n",
       "\\begin{tabular}{r|lll}\n",
       "  & OR & 2.5 \\% & 97.5 \\%\\\\\n",
       "\\hline\n",
       "\t(Intercept) & 0.06229245 & 0.02914506 & 0.1331392\\\\\n",
       "\tbinge1 & 0.29564383 & 0.11856382 & 0.7372002\\\\\n",
       "\tage\\_sq & 0.99997984 & 0.99985129 & 1.0001084\\\\\n",
       "\tsex1 & 1.33205425 & 0.92055071 & 1.9275076\\\\\n",
       "\tinc\\$15k-\\$25k & 1.50377958 & 0.84037778 & 2.6908768\\\\\n",
       "\tinc\\$25k-\\$35k & 1.34301216 & 0.70822311 & 2.5467704\\\\\n",
       "\tinc\\$35k-\\$50k & 1.34707348 & 0.69031390 & 2.6286693\\\\\n",
       "\tinc\\$50k-\\$75k & 1.72255945 & 0.97014534 & 3.0585222\\\\\n",
       "\tinc<\\$15k & 1.83325448 & 0.95454957 & 3.5208459\\\\\n",
       "\teduAttended College & 1.26009676 & 0.82032466 & 1.9356286\\\\\n",
       "\teduHS Graduate & 1.22312757 & 0.77679098 & 1.9259249\\\\\n",
       "\teduLess than HS & 1.22607292 & 0.67956795 & 2.2120743\\\\\n",
       "\tempNot in Labor Force & 1.78851709 & 1.23936719 & 2.5809892\\\\\n",
       "\tempUnemployed & 2.62107608 & 1.18488862 & 5.7980469\\\\\n",
       "\tmaritalCohabiting & 0.80079707 & 0.38785414 & 1.6533946\\\\\n",
       "\tmaritalDivorced & 1.04060254 & 0.70331153 & 1.5396501\\\\\n",
       "\tmaritalNever Married & 1.09671803 & 0.67416507 & 1.7841186\\\\\n",
       "\tins0 & 1.15930008 & 0.72721675 & 1.8481102\\\\\n",
       "\thomeOther & 1.84103599 & 0.95365400 & 3.5541334\\\\\n",
       "\thomeRent & 1.05867174 & 0.73666060 & 1.5214413\\\\\n",
       "\tsmokeSmoker & 1.51194451 & 1.07447442 & 2.1275297\\\\\n",
       "\theavyYes & 1.49700398 & 0.74068895 & 3.0255898\\\\\n",
       "\tactiveNo & 1.82590157 & 1.31176817 & 2.5415440\\\\\n",
       "\tbmiObese & 0.93399966 & 0.62924650 & 1.3863492\\\\\n",
       "\tbmiOverweight & 1.09267561 & 0.73409442 & 1.6264120\\\\\n",
       "\tasthmaYes & 0.89248439 & 0.58657287 & 1.3579359\\\\\n",
       "\tarthYes & 1.99504784 & 1.29229872 & 3.0799503\\\\\n",
       "\tcopdYes & 1.16329997 & 0.71237918 & 1.8996440\\\\\n",
       "\tchdYes & 1.05148978 & 0.58298946 & 1.8964850\\\\\n",
       "\tdiabYes & 1.84703335 & 1.14352173 & 2.9833558\\\\\n",
       "\tkidneyYes & 1.39834505 & 0.61242426 & 3.1928338\\\\\n",
       "\tstrokeYes & 1.35495465 & 0.79313874 & 2.3147301\\\\\n",
       "\tdisabYes & 3.87925940 & 2.63957672 & 5.7011616\\\\\n",
       "\tMCCYes & 0.62402651 & 0.33393958 & 1.1661064\\\\\n",
       "\tyear2014 & 0.95415478 & 0.54468257 & 1.6714530\\\\\n",
       "\tyear2015 & 1.22446086 & 0.71778443 & 2.0887948\\\\\n",
       "\tyear2016 & 0.68004606 & 0.37648740 & 1.2283615\\\\\n",
       "\tyear2017 & 0.82421773 & 0.46664264 & 1.4557925\\\\\n",
       "\tyear2018 & 0.69466719 & 0.39497096 & 1.2217670\\\\\n",
       "\tyear2019 & 0.66563912 & 0.37847218 & 1.1706949\\\\\n",
       "\tbinge1:age\\_sq & 1.00001787 & 0.99971314 & 1.0003227\\\\\n",
       "\tbinge1:sex1 & 2.37323669 & 1.03517985 & 5.4408443\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A matrix: 42 × 3 of type dbl\n",
       "\n",
       "| <!--/--> | OR | 2.5 % | 97.5 % |\n",
       "|---|---|---|---|\n",
       "| (Intercept) | 0.06229245 | 0.02914506 | 0.1331392 |\n",
       "| binge1 | 0.29564383 | 0.11856382 | 0.7372002 |\n",
       "| age_sq | 0.99997984 | 0.99985129 | 1.0001084 |\n",
       "| sex1 | 1.33205425 | 0.92055071 | 1.9275076 |\n",
       "| inc$15k-$25k | 1.50377958 | 0.84037778 | 2.6908768 |\n",
       "| inc$25k-$35k | 1.34301216 | 0.70822311 | 2.5467704 |\n",
       "| inc$35k-$50k | 1.34707348 | 0.69031390 | 2.6286693 |\n",
       "| inc$50k-$75k | 1.72255945 | 0.97014534 | 3.0585222 |\n",
       "| inc&lt;$15k | 1.83325448 | 0.95454957 | 3.5208459 |\n",
       "| eduAttended College | 1.26009676 | 0.82032466 | 1.9356286 |\n",
       "| eduHS Graduate | 1.22312757 | 0.77679098 | 1.9259249 |\n",
       "| eduLess than HS | 1.22607292 | 0.67956795 | 2.2120743 |\n",
       "| empNot in Labor Force | 1.78851709 | 1.23936719 | 2.5809892 |\n",
       "| empUnemployed | 2.62107608 | 1.18488862 | 5.7980469 |\n",
       "| maritalCohabiting | 0.80079707 | 0.38785414 | 1.6533946 |\n",
       "| maritalDivorced | 1.04060254 | 0.70331153 | 1.5396501 |\n",
       "| maritalNever Married | 1.09671803 | 0.67416507 | 1.7841186 |\n",
       "| ins0 | 1.15930008 | 0.72721675 | 1.8481102 |\n",
       "| homeOther | 1.84103599 | 0.95365400 | 3.5541334 |\n",
       "| homeRent | 1.05867174 | 0.73666060 | 1.5214413 |\n",
       "| smokeSmoker | 1.51194451 | 1.07447442 | 2.1275297 |\n",
       "| heavyYes | 1.49700398 | 0.74068895 | 3.0255898 |\n",
       "| activeNo | 1.82590157 | 1.31176817 | 2.5415440 |\n",
       "| bmiObese | 0.93399966 | 0.62924650 | 1.3863492 |\n",
       "| bmiOverweight | 1.09267561 | 0.73409442 | 1.6264120 |\n",
       "| asthmaYes | 0.89248439 | 0.58657287 | 1.3579359 |\n",
       "| arthYes | 1.99504784 | 1.29229872 | 3.0799503 |\n",
       "| copdYes | 1.16329997 | 0.71237918 | 1.8996440 |\n",
       "| chdYes | 1.05148978 | 0.58298946 | 1.8964850 |\n",
       "| diabYes | 1.84703335 | 1.14352173 | 2.9833558 |\n",
       "| kidneyYes | 1.39834505 | 0.61242426 | 3.1928338 |\n",
       "| strokeYes | 1.35495465 | 0.79313874 | 2.3147301 |\n",
       "| disabYes | 3.87925940 | 2.63957672 | 5.7011616 |\n",
       "| MCCYes | 0.62402651 | 0.33393958 | 1.1661064 |\n",
       "| year2014 | 0.95415478 | 0.54468257 | 1.6714530 |\n",
       "| year2015 | 1.22446086 | 0.71778443 | 2.0887948 |\n",
       "| year2016 | 0.68004606 | 0.37648740 | 1.2283615 |\n",
       "| year2017 | 0.82421773 | 0.46664264 | 1.4557925 |\n",
       "| year2018 | 0.69466719 | 0.39497096 | 1.2217670 |\n",
       "| year2019 | 0.66563912 | 0.37847218 | 1.1706949 |\n",
       "| binge1:age_sq | 1.00001787 | 0.99971314 | 1.0003227 |\n",
       "| binge1:sex1 | 2.37323669 | 1.03517985 | 5.4408443 |\n",
       "\n"
      ],
      "text/plain": [
       "                      OR         2.5 %      97.5 %   \n",
       "(Intercept)           0.06229245 0.02914506 0.1331392\n",
       "binge1                0.29564383 0.11856382 0.7372002\n",
       "age_sq                0.99997984 0.99985129 1.0001084\n",
       "sex1                  1.33205425 0.92055071 1.9275076\n",
       "inc$15k-$25k          1.50377958 0.84037778 2.6908768\n",
       "inc$25k-$35k          1.34301216 0.70822311 2.5467704\n",
       "inc$35k-$50k          1.34707348 0.69031390 2.6286693\n",
       "inc$50k-$75k          1.72255945 0.97014534 3.0585222\n",
       "inc<$15k              1.83325448 0.95454957 3.5208459\n",
       "eduAttended College   1.26009676 0.82032466 1.9356286\n",
       "eduHS Graduate        1.22312757 0.77679098 1.9259249\n",
       "eduLess than HS       1.22607292 0.67956795 2.2120743\n",
       "empNot in Labor Force 1.78851709 1.23936719 2.5809892\n",
       "empUnemployed         2.62107608 1.18488862 5.7980469\n",
       "maritalCohabiting     0.80079707 0.38785414 1.6533946\n",
       "maritalDivorced       1.04060254 0.70331153 1.5396501\n",
       "maritalNever Married  1.09671803 0.67416507 1.7841186\n",
       "ins0                  1.15930008 0.72721675 1.8481102\n",
       "homeOther             1.84103599 0.95365400 3.5541334\n",
       "homeRent              1.05867174 0.73666060 1.5214413\n",
       "smokeSmoker           1.51194451 1.07447442 2.1275297\n",
       "heavyYes              1.49700398 0.74068895 3.0255898\n",
       "activeNo              1.82590157 1.31176817 2.5415440\n",
       "bmiObese              0.93399966 0.62924650 1.3863492\n",
       "bmiOverweight         1.09267561 0.73409442 1.6264120\n",
       "asthmaYes             0.89248439 0.58657287 1.3579359\n",
       "arthYes               1.99504784 1.29229872 3.0799503\n",
       "copdYes               1.16329997 0.71237918 1.8996440\n",
       "chdYes                1.05148978 0.58298946 1.8964850\n",
       "diabYes               1.84703335 1.14352173 2.9833558\n",
       "kidneyYes             1.39834505 0.61242426 3.1928338\n",
       "strokeYes             1.35495465 0.79313874 2.3147301\n",
       "disabYes              3.87925940 2.63957672 5.7011616\n",
       "MCCYes                0.62402651 0.33393958 1.1661064\n",
       "year2014              0.95415478 0.54468257 1.6714530\n",
       "year2015              1.22446086 0.71778443 2.0887948\n",
       "year2016              0.68004606 0.37648740 1.2283615\n",
       "year2017              0.82421773 0.46664264 1.4557925\n",
       "year2018              0.69466719 0.39497096 1.2217670\n",
       "year2019              0.66563912 0.37847218 1.1706949\n",
       "binge1:age_sq         1.00001787 0.99971314 1.0003227\n",
       "binge1:sex1           2.37323669 1.03517985 5.4408443"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "exp(cbind(OR = coef(final_model_activity_lim), confint(final_model_activity_lim)))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e8a27210-6642-4527-a516-f2b744cbcc4a",
   "metadata": {},
   "source": [
    "# STEP 15: Stratified Models"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a5331a6-c2bc-414a-8e14-b49de7e5ab62",
   "metadata": {},
   "source": [
    "# Step 15A: Stratified Models(SelfRatedHealth)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "ebcc05ff-1471-4569-a063-10403cc62e8b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in safe_svyglm(brfss_multiracial):\n",
      "\"Some variables have only one level. Model skipped.\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        Group OR.binge1 Lower.2.5.. Upper.97.5..          p\n",
      "1       White 0.5587789   0.2871314     1.087425 0.08650965\n",
      "2       Black 4.0104402         NaN          NaN        NaN\n",
      "3    Hispanic 1.0651680         NaN          NaN        NaN\n",
      "4       Other 0.5944143         NaN          NaN        NaN\n",
      "5 Multiracial        NA          NA           NA         NA\n"
     ]
    }
   ],
   "source": [
    "# 1. Check if all categorical variables have at least two levels\n",
    "has_valid_factors <- function(data, vars) {\n",
    "  all(sapply(vars, function(var) {\n",
    "    val <- data[[var]]\n",
    "    !is.factor(val) || length(unique(val[!is.na(val)])) > 1\n",
    "  }))\n",
    "}\n",
    "\n",
    "# 2. Variables in your model\n",
    "vars_in_model <- c(\n",
    "  \"binge\", \"age_sq\", \"sex\", \"inc\", \"edu\", \"year\",\n",
    "  \"emp\", \"marital\", \"ins\", \"home\",\n",
    "  \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"MCC\"\n",
    ")\n",
    "\n",
    "# 3. Safe subset function (race variable)\n",
    "get_clean_subset <- function(design, group_name) {\n",
    "  subset_design <- subset(design, race == group_name)\n",
    "  subset_design$variables <- droplevels(subset_design$variables)\n",
    "  return(subset_design)\n",
    "}\n",
    "\n",
    "# 4. Model formula (outcome = srh)\n",
    "model_formula <- as.formula(\n",
    "  paste(\"srh ~\", paste(vars_in_model, collapse = \" + \"))\n",
    ")\n",
    "\n",
    "# 5. Wrapper to fit model safely\n",
    "safe_svyglm <- function(design) {\n",
    "  data_vars <- design$variables\n",
    "  if (has_valid_factors(data_vars, vars_in_model)) {\n",
    "    svyglm(model_formula, design = design, family = quasibinomial())\n",
    "  } else {\n",
    "    warning(\"Some variables have only one level. Model skipped.\")\n",
    "    return(NULL)\n",
    "  }\n",
    "}\n",
    "\n",
    "# 6. Prepare and fit models ( race groups)\n",
    "brfss_white       <- get_clean_subset(brfss_svy, \"Non-Hispanic White\")\n",
    "brfss_black       <- get_clean_subset(brfss_svy, \"Non-Hispanic Black\")\n",
    "brfss_hispanic    <- get_clean_subset(brfss_svy, \"Hispanic\")\n",
    "brfss_other       <- get_clean_subset(brfss_svy, \"Non-Hispanic Other\")\n",
    "brfss_multiracial <- get_clean_subset(brfss_svy, \"Non-Hispanic Multiracial\")\n",
    "\n",
    "model_white       <- safe_svyglm(brfss_white)\n",
    "model_black       <- safe_svyglm(brfss_black)\n",
    "model_hispanic    <- safe_svyglm(brfss_hispanic)\n",
    "model_other       <- safe_svyglm(brfss_other)\n",
    "model_multiracial <- safe_svyglm(brfss_multiracial)\n",
    "\n",
    "# 7. Function to extract OR and CI for binge\n",
    "extract_binge_or <- function(model) {\n",
    "  if (is.null(model) || !\"binge1\" %in% names(coef(model))) {\n",
    "    return(c(OR = NA, Lower = NA, Upper = NA, p = NA))\n",
    "  }\n",
    "  or <- exp(coef(model)[\"binge1\"])\n",
    "  ci <- exp(confint(model)[\"binge1\", ])\n",
    "  p  <- summary(model)$coefficients[\"binge1\", \"Pr(>|t|)\"]\n",
    "  return(c(OR = or, Lower = ci[1], Upper = ci[2], p = p))\n",
    "}\n",
    "\n",
    "# 8. Collect results\n",
    "results_stratified <- data.frame(\n",
    "  Group = c(\"White\", \"Black\", \"Hispanic\", \"Other\", \"Multiracial\"),\n",
    "  t(sapply(\n",
    "    list(model_white, model_black, model_hispanic, model_other, model_multiracial),\n",
    "    extract_binge_or\n",
    "  ))\n",
    ")\n",
    "\n",
    "# 9. Print results\n",
    "print(results_stratified)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "269c7a8c-485c-4d0e-935a-96c270233637",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message in safe_svyglm(brfss_multiracial):\n",
      "\"Some variables have only one level. Model skipped.\"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        Group OR.binge1 Lower.2.5.. Upper.97.5..          p\n",
      "1       White 0.5587789   0.2871314     1.087425 0.08650965\n",
      "2       Black 4.0104402         NaN          NaN        NaN\n",
      "3    Hispanic 1.0651680         NaN          NaN        NaN\n",
      "4       Other 0.5944143         NaN          NaN        NaN\n",
      "5 Multiracial        NA          NA           NA         NA\n"
     ]
    }
   ],
   "source": [
    "# 1. Check if all categorical variables have at least two levels\n",
    "has_valid_factors <- function(data, vars) {\n",
    "  all(sapply(vars, function(var) {\n",
    "    val <- data[[var]]\n",
    "    !is.factor(val) || length(unique(val[!is.na(val)])) > 1\n",
    "  }))\n",
    "}\n",
    "\n",
    "# 2. Variables in model\n",
    "vars_in_model <- c(\n",
    "  \"binge\", \"age_sq\", \"sex\", \"inc\", \"edu\", \"year\",\n",
    "  \"emp\", \"marital\", \"ins\", \"home\",\n",
    "  \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"MCC\"\n",
    ")\n",
    "\n",
    "# 3. Safe subset function (race variable)\n",
    "get_clean_subset <- function(design, group_name) {\n",
    "  subset_design <- subset(design, race == group_name)\n",
    "  subset_design$variables <- droplevels(subset_design$variables)\n",
    "  return(subset_design)\n",
    "}\n",
    "\n",
    "# 4. Model formula (outcome = srh)\n",
    "model_formula <- as.formula(\n",
    "  paste(\"srh ~\", paste(vars_in_model, collapse = \" + \"))\n",
    ")\n",
    "\n",
    "# 5. Wrapper to fit model safely\n",
    "safe_svyglm <- function(design) {\n",
    "  data_vars <- design$variables\n",
    "  if (has_valid_factors(data_vars, vars_in_model)) {\n",
    "    svyglm(model_formula, design = design, family = quasibinomial())\n",
    "  } else {\n",
    "    warning(\"Some variables have only one level. Model skipped.\")\n",
    "    return(NULL)\n",
    "  }\n",
    "}\n",
    "\n",
    "# 6. Prepare and fit models ( race groups)\n",
    "brfss_white       <- get_clean_subset(brfss_svy, \"Non-Hispanic White\")\n",
    "brfss_black       <- get_clean_subset(brfss_svy, \"Non-Hispanic Black\")\n",
    "brfss_hispanic    <- get_clean_subset(brfss_svy, \"Hispanic\")\n",
    "brfss_other       <- get_clean_subset(brfss_svy, \"Non-Hispanic Other\")\n",
    "brfss_multiracial <- get_clean_subset(brfss_svy, \"Non-Hispanic Multiracial\")\n",
    "\n",
    "model_white       <- safe_svyglm(brfss_white)\n",
    "model_black       <- safe_svyglm(brfss_black)\n",
    "model_hispanic    <- safe_svyglm(brfss_hispanic)\n",
    "model_other       <- safe_svyglm(brfss_other)\n",
    "model_multiracial <- safe_svyglm(brfss_multiracial)\n",
    "\n",
    "# 7. Function to extract OR and CI for binge\n",
    "extract_binge_or <- function(model) {\n",
    "  if (is.null(model) || !\"binge1\" %in% names(coef(model))) {\n",
    "    return(c(OR = NA, Lower = NA, Upper = NA, p = NA))\n",
    "  }\n",
    "  or <- exp(coef(model)[\"binge1\"])\n",
    "  ci <- exp(confint(model)[\"binge1\", ])\n",
    "  p  <- summary(model)$coefficients[\"binge1\", \"Pr(>|t|)\"]\n",
    "  return(c(OR = or, Lower = ci[1], Upper = ci[2], p = p))\n",
    "}\n",
    "\n",
    "# 8. Collect results\n",
    "results_stratified <- data.frame(\n",
    "  Group = c(\"White\", \"Black\", \"Hispanic\", \"Other\", \"Multiracial\"),\n",
    "  t(sapply(\n",
    "    list(model_white, model_black, model_hispanic, model_other, model_multiracial),\n",
    "    extract_binge_or\n",
    "  ))\n",
    ")\n",
    "\n",
    "# 9. Print results\n",
    "print(results_stratified)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "567bdce3-bb6a-48ae-803d-066c300d5823",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Group OR.binge1 Lower.2.5.. Upper.97.5..          p\n",
      "1    White 0.5587789   0.2871314     1.087425 0.08650965\n",
      "2    Black 4.0104402         NaN          NaN        NaN\n",
      "3 Hispanic 1.0651680         NaN          NaN        NaN\n",
      "4    Other 0.5944143         NaN          NaN        NaN\n"
     ]
    }
   ],
   "source": [
    "\n",
    "# 1. Define predictor variables (renamed + lowercase)\n",
    "vars_in_model <- c(\n",
    "  \"binge\", \"age_sq\", \"sex\", \"inc\", \"edu\", \"year\",\n",
    "  \"emp\", \"marital\", \"ins\", \"home\",\n",
    "  \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"MCC\"\n",
    ")\n",
    "\n",
    "# 2. Function to check if all categorical variables have >= 2 levels\n",
    "has_valid_factors <- function(data, vars) {\n",
    "  all(sapply(vars, function(var) {\n",
    "    val <- data[[var]]\n",
    "    !is.factor(val) || length(unique(val[!is.na(val)])) > 1\n",
    "  }))\n",
    "}\n",
    "\n",
    "# 3. Model formula for SRH\n",
    "model_formula <- as.formula(\n",
    "  paste(\"srh ~\", paste(vars_in_model, collapse = \" + \"))\n",
    ")\n",
    "\n",
    "# 4.subsetting by race/ethnicity\n",
    "get_clean_subset <- function(design, group_name) {\n",
    "  subset_design <- subset(design, race == group_name)\n",
    "  subset_design$variables <- droplevels(subset_design$variables)\n",
    "  return(subset_design)\n",
    "}\n",
    "\n",
    "# 5. survey-weighted model fitting\n",
    "safe_svyglm <- function(design) {\n",
    "  data_vars <- design$variables\n",
    "  if (has_valid_factors(data_vars, vars_in_model)) {\n",
    "    svyglm(model_formula, design = design, family = quasibinomial())\n",
    "  } else {\n",
    "    warning(\"Some variables have only one level. Model skipped.\")\n",
    "    return(NULL)\n",
    "  }\n",
    "}\n",
    "\n",
    "# 6. Subset survey design by race groups\n",
    "brfss_white    <- get_clean_subset(brfss_svy, \"Non-Hispanic White\")\n",
    "brfss_black    <- get_clean_subset(brfss_svy, \"Non-Hispanic Black\")\n",
    "brfss_hispanic <- get_clean_subset(brfss_svy, \"Hispanic\")\n",
    "brfss_other    <- get_clean_subset(brfss_svy, \"Non-Hispanic Other\")\n",
    "\n",
    "# 7. Fit stratified models\n",
    "model_white_srh    <- safe_svyglm(brfss_white)\n",
    "model_black_srh    <- safe_svyglm(brfss_black)\n",
    "model_hispanic_srh <- safe_svyglm(brfss_hispanic)\n",
    "model_other_srh    <- safe_svyglm(brfss_other)\n",
    "\n",
    "# 8. Extract Binge ORs\n",
    "extract_binge_or <- function(model) {\n",
    "  if (is.null(model) || !\"binge1\" %in% names(coef(model))) {\n",
    "    return(c(OR = NA, Lower = NA, Upper = NA, p = NA))\n",
    "  }\n",
    "  or <- exp(coef(model)[\"binge1\"])\n",
    "  ci <- exp(confint(model)[\"binge1\", ])\n",
    "  p <- summary(model)$coefficients[\"binge1\", \"Pr(>|t|)\"]\n",
    "  return(c(OR = or, Lower = ci[1], Upper = ci[2], p = p))\n",
    "}\n",
    "\n",
    "# 9. Combine into final output table\n",
    "results_stratified_srh <- data.frame(\n",
    "  Group = c(\"White\", \"Black\", \"Hispanic\", \"Other\"),\n",
    "  t(sapply(list(model_white_srh, model_black_srh, model_hispanic_srh, model_other_srh), extract_binge_or))\n",
    ")\n",
    "\n",
    "# 10. View the results\n",
    "print(results_stratified_srh)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "04e4afe7-94ea-475d-912f-917addcb12f3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "                    \n",
       "                        0    1\n",
       "  Hispanic            165   47\n",
       "  Non-Hispanic Black  194   37\n",
       "  Non-Hispanic Other  191   29\n",
       "  Non-Hispanic White 1794  305"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAAPFBMVEUAAAAAv8QzMzNNTU1o\naGh8fHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enr6+vw8PD4dm3///9yuarZAAAA\nCXBIWXMAABJ0AAASdAHeZh94AAAgAElEQVR4nO3diXYaCaKD4bpd3uMFN+//rpfdBcIblCKp\nR/85k2Bj4LNTCoud6WHZWru6QQ1o7b9Qh9TaDHVIrc1Qh9TaDHVIrc1Qh9TaDHVIrc1Qh9Ta\nDHVIrc1Qh9TaDM01pGHX7dOl1/B+v72eX19sGG5OFDePywuua3fh8f71+L2nH/W76/zBLQ43\nD++/udJm2NxDWk3p4mv4+PUX3U1v8hhx2ZBWPQDr87e/u86f3eLYJYU335C2v7+Mw4X3Sb+e\n0P5ir9M3Nr+93h5t4XeAt6dhePz2o353nd+c+3KRtzk195CWL5feJV08pDNvvA3jFdf0Ogyf\n30EwhrS6xQu8zanZh7Q5tToSb4a71Ruv9+P+Scfq/U/jcPu8/aijM9YfvHmE83GfcnS5h3G4\neZ7c2Me5w+5ip4rNif0vHxd/vh3Gp91Hre4GDpqTT+FhfZe0+xxOr2Tz9tu4eRr2cRX7T/j1\nfv0k62V6nY/bT/p9/0zuffqU7uTUw83qCneXXlmH++2ggdrsYg3pbvNM43n3FGB7BD5+PAE5\nPmP9wUdDOj779nB62+TcT4a0PVh3G/i4+A6wef8feDr0cT2v603sPofTK9m8PW7udidXsfvg\nl4l7d50P+4952L33z8cDx9N7pHFy6e3lxuVZarNr9iE9r4+x1YG3/rt09Rjp8X35vjom3tbv\nG/+szh7Xz2lOzth88OTFhtPLvSzf7z4eMR6de/ah3eo50uHOY3Lx1QW3gmF9ev03/+4DTz6F\n/V8GH6zJlazfvt1gplex++Cb9Q2sDvzJfc7hk37bvfd2wz66xdUTy/VKHjcTe9xd+fi8fN88\ndzpDbXbNPaTVMbM5rjaPTx52f4ver38fdgfQ+ABnvHxcw+bXk7PXB9D79IHX5NzTIe16PFzX\n5OIP29dB/mxPbx41vW8egB5/Csv9kF7OXcn6Ud4wvi2Pr+LoczgCrZe12sLD+vXF1+XRI7vT\nlzpvtle4uZL7jXXzwWeoza75X/6eHN03u+1s/jLe36Xc3ZyeMeyu4fDr52fDtX4ypLvX5WED\nh4vf7I/Izel9kwsfnZze7uT0MDzt1jG9it0H3K2eIP053OFsLrF9lrOmbh4wTh/ZHbg3hxc6\nX58fb3dfgsPrHWeoza6ZhzTe7Z57Lye/7Y7A3d/EN8PpGTCkz8+Gaz370O79aVzfQ+AGptf6\n5ZDGL4Y07L4DPL2K/Uvn4/Eujm5ye5c0eWS3fe/7eHjM9jQeSEeuDsm/+V9smLx1dki3/CFt\nnld8N6QvPoWX7aM1uJHtBcfn4eMp2Olln+8Pjyyn79899bs7emS3O/dl97hwubqru33484ZD\nAmqzizqk44dou4f43Id201NfPbQbh6MfBDq+8MP6sdunQ3pbnb++5elVTBWv9x/fFTo8tNuc\nfzu8Tx/Z7S/1uPvBhpvJE63x46HdGWqzizqkh2Hz83P7Fw22h/H2xYajMyaX2fz6+dlwrZ/e\nI424gd2LDU/r0/fbK3mdfPv4+MKfD2kzxZfjqzj76W9ObW5y913q5+HxZvLI7vBxN8Pk5wyf\nN7/d717eGM9Sm13UIa0epTxsX6h+3T4m2ryq9w5n7C5zeDX7/Nn7Kz869/yQtq8nn25g+/L3\nn2F3ev3K8ogvf69/ROhp+eWQVpO8O76Kw13wn/25++vc3OS4e/B2M04f2R24r9tP5WZ9u9tX\n51dzGl8PL38DtdlFHRJ+33X/7cbjMzYfezN51n7m7MkNTM89HdL09eTTDey+ITvsjtTDa4xw\n4Yfl8ushbR9uTa5i9wG7b8iOk+8UPU5v5vn4x/gO9vvNvp72t79e3cPh0zhDbXZxh3T6oz7D\nsP83CsdnbN5zM3mtDM8+fhZyOPf8kO7+HM46uvj6x27uXran39Y/9POEF755OLri80N62tzp\nfFzF4a5w8yNCR6/LrX9EaP8zQ+/DcPzi+P7U9kd9n9af1svz9g7tafX12G0HqM2uv/eKkM2L\nT8LvbD4dPbJr/6H+l4a0/Ubqy+2l/9Dj6l73z5Xaf67/pSHtnyKJXv3q85z/cv9LQ1o+b/45\n7R/Rrd/0ec5/OP3R3dp/oA6ptRnqkFqboQ6ptRnqkFqboQ6ptRnqkFqboQ6ptRnqkFqboXmG\ntGDHv4UrswdWuLoBYh3SPNkDK+yQFgFHgT2wwg5pEXAU2AMr7JAWAUeBPbDCDmkRcBTYAyvs\nkBYBR4E9sMIOaRFwFNgDK+yQFgFHgT2wwg5pEXAU2AMr7JAWAUeBPbDCDmkRcBTYAyvskBYB\n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\nhrR/x8mOOqT5sgf6C5OG9PEU6Z91n11W/SWF8oRqD2Yv/PaQZvT7IY1n3td7pNmyB/oLQ+6R\nRjjRIc2YPdBfmDGkc6c6pPmyB/oLI4Y0nnlfhzRj9kB/YcKQJi+DT19/6JBmyx7oLzQd0sdP\nM+xerRsn79vVIc2WPdBf6DqkH9QhzZY90F/YIfHLE6o9mL2wQ+KXJ1R7MHthh8QvT6j2YPbC\nDolfnlDtweyFHRK/PKHag9kLOyR+eUK1B7MXdkj88oRqD2Yv7JD45QnVHsxe2CHxyxOqPZi9\nsEPilydUezB7YYfEL0+o9mD2wv/gkP7PrQ7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyF\nHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun6\n7IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O\n6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0S\nvw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyF\nHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svw7p+uyFHRK/Dun6\n7IUdEr8O6frshR0Svw7p+uyFHRK/Dun67IUdEr8O6frshR0Svzyh+qjE7IUdEr88ofqoxOyF\nHRK/PKH6qMTshR0Svzyh+qjE7IUdEr88ofqoxOyFHRK/PKH6qMTshR0Svzyh+qjE7IUdEr88\nofqoxOyFHRK/PKH6qMTshR0Svzyh+qjE7IUdEr88ofqoxOK+hB3S/OUJ1bPB4r6EHdL85QnV\ns8HivoQd0vzlCdWzweK+hB3S/OUJ1bPB4r6EHdL85QnVs8HivoQd0vzlCdWzweK+hB3S/OUJ\n1bPB4r6EHdL85QnVs8HivoQd0vzlCdUezF7YIfHLE6o9mL2wQ+KXJ1R7MHthh8QvT6j2YPbC\nDolfnlDtweyFwUP6LPWXFMoTqj2YvZB0MH9d75HMsgf6C4PvkTqk2bIH+gs7JH55QrUHsxd2\nSPzyhGoPZi/skPjlCdUezF7YIfHLE6o9mL2wQ+KXJ1R7MHthh8QvT6j2YPbCDolfnlDtweyF\nHRK/PKHag9kLOyR+eUK1B7MXdkj88oRqD2Yv7JD45QnVHsxe2CHxyxOqPZi9sEPilydUezB7\nYYfEL0+o9mD2wktzii4AAAc8SURBVA6JX55Q7cHshR0Svzyh2oPZCzskfnlCtQezF3ZI/PKE\nag9mL+yQ+OUJ1R7MXtgh8csTqj2YvbBD4pcnVHswe2GHxC9PqPZg9sIOiV+eUO3B7IUdEr88\nodqD2Qs7JH55QrUHsxd2SPzyhGoPZi/skPjlCdUezF7YIfHLE6o9mL2wQ+KXJ1R7MHthh8Qv\nT6j2YPbCDolfnlDtweyFHRK/PKHag9kLOyR+eUK1B7MXdkj88oRqD2Yv7JD45QnVHsxe2CHx\nyxOqPZi9sEPilydUezB7YYfEL0+o9mD2wg6JX55Q7cHshR0Svzyh2oPZCzskfnlCtQezF3ZI\n/PKEag9mL+yQ+OUJ1R7MXtgh8csTqj2YvbBD4pcnVHswe2GHxC9PqPZg9sIOiV+eUO3B7IUd\nEr88odqD2Qs7JH55QrUHsxd2SPzyhGoPZi/skPjlCdUezF7YIfHLE6o9mL2wQ+KXJ1R7MHth\nh8QvT6j2YPbCDolfnlDtweyFHRK/PKHag9kLOyR+eUK1B7MXdkj88oRqD2Yv7JD45QnVHsxe\n2CHxyxOqPZi9sEPilydUezB7YYfEL0+o9mD2wg6JX55Q7cHshR0Svzyh2oPZCzskfnlCtQez\nF3ZI/PKEag9mL+yQ+OUJ1R7MXtgh8csTqj2YvbBD4pcnVHswe2GHxC9PqPZg9sIOiV+eUO3B\n7IUdEr88odqD2Qs7JH55QrUHsxd2SPzyhGoPZi/skPjlCdUezF7YIfHLE6o9mL2wQ+KXJ1R7\nMHthh8QvT6j2YPZC1yGNq05PT9+37JBmzB7oLzQd0nj45eP09H3rOqTZsgf6CzskfnlCtQez\nF3ZI/PKEag9mL8wc0j/rOLbWYuLeI80W/xauzB5Yofk90ib2V8D/KLAHVtghLQKOAntghR3S\nIuAosAdW2CEtAo4Ce2CF6iF9/DTD9PTPfrJhvi8B/RauzB5YoXxIP4j9FfA/CuyBFXZIi4Cj\nwB5YYYe0CDgK7IEVdkiLgKPAHlhhh7QIOArsgRV2SIuAo8AeWGGHtAg4CuyBFXZIi4CjwB5Y\nYYe0CDgK7IEVdkiLgKPAHlhhh7QIOArsgRV2SIuAo8AeWGGHtAg4CuyBFXZIi4CjwB5YYYe0\nCDgK7IEVdkiLgKPAHlhhh7QIOArsgRV2SIuAo8AeWGGHtAg4CuyBFXZIi4CjwB5YYYe0CDgK\n7IEVdkiLgKPAHlhhh7QIOArsgRV2SIuAo8AeWGGHtAg4CuyBFXZIi4CjwB5YYcKQ6Nn/p8zs\ngRVy65DmyR5YIbcOaZ7sgRVy65DmyR5YIbcOaZ7sgRVyCxlSa951SK3NUIfU2gx1SK3NUIfU\n2gx1SK3NkNOQxsNv49cfOPlgwo1/c/bvbeO289f+88+DKFye/HfqL/vi8oDjyW/j2Y+S5jkk\nxY2PX974NbYvj6BfDIkn3F33YezXXAkDuL/i498vvjpGHdLhxsevbtxhSDzh9MJXDIn8Jfy4\n/g7py44PuMOjoXH/1+XR25MPmenGD0fB6S1fazt72eX00d6PPgu+cHf+ePZieuB0SJOPHuc9\nEC7MdkiHr9m4/Oztnx+DP7vxT27patt4+HX6scc36iCc3Ma5i6mBk/+dfNSsB8KFWQ3p8Kx8\nPPnyT96YHICzfunOHAVHt3yFDV9sGM+eFArxNvCG1MDpkI4/qkM67uivrKOnrttf9n8IrCGd\n/mU5MV1lO77s9GM37/3pp8EX4pDGY6wMeDLS0yHt/6IS5juk5eSBwed/Gc174+OZo+DoULrI\ndnIELY8+YPzxkvjCcwfq8fkq4OHvm/HskH7E4+Y8pLN/uf31IV1vO7rsuWP0yuP0euHkwowh\nzQLskH7c+QNu8lfVufv+ub6IH39Lfn8U/NIGlz29lV8cpxzh2e8jnVm9DngsPTck8Zpsh3Tu\n9dHTP9t5X/4+/HbuhelrbMcvNuw+9pKXv2nC6Vt7H9yQFnh0LdMh9eXvn6X+An2Vs22bvdAe\n+NM6pCtytm2zF9oDf1qHdEXOtm32QnvgT7MfUmsJdUitzVCH1NoMdUitzVCH1NoMdUitzVCH\n1NoMdUgeDcPreLtcvtwNw/iwfsfb3e7E+/0w3L9rde3bOiSPhuF2uF8+D5tWA3of1yfuVuds\nTtyofe2bOiSPNutZ3gx/lsvXYfWH8rCa1cv6xOP6jIfhSQ1sX9cheTQMb5vf354fb9f7uRl2\nj+ZuNn9Cm/umZlyH5NGw/YO43T62O7y9PrF/V3Ouf0AebZdyP9w8Pb91SIH1D8ij7VI2v76f\neWjX3Osfk0f7Ib0s32+3LzY87F91eFgu/wy3amD7ug7Jo+2QHg6P4972r3pvXwcfXtXA9nUd\nkke7J0H3w3C7edV7+bq6Y7pfv5L3tnmfFNe+r0NqbYY6pNZmqENqbYY6pNZmqENqbYY6pNZm\nqENqbYY6pNZmqENqbYY6pNZmqENqbYY6pNZmqENqbYb+H09BXjEoPyKJAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "plot without title"
      ]
     },
     "metadata": {
      "image/png": {
       "height": 420,
       "width": 420
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Count binge drinkers per race\n",
    "table(brfss_merged2$race, brfss_merged2$binge)\n",
    "\n",
    "# Or plot it for better visibility\n",
    "library(ggplot2)\n",
    "ggplot(brfss_merged2, aes(x = race, fill = binge)) +\n",
    "  geom_bar(position = \"fill\") +\n",
    "  labs(title = \"Proportion of Binge Drinkers by Race\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "209afd6b-4f26-4d44-8e13-5e2e399bd3f2",
   "metadata": {},
   "source": [
    "# Step 15B :Stratified Models(BadPhysicalHealth)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "fb6a7d15-d6d3-4304-b959-985f686b9bb2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Group OR.binge1 Lower.2.5.. Upper.97.5..           p\n",
      "1    White 0.3886548   0.2078224    0.7268346 0.003168504\n",
      "2    Black 1.0453571         NaN          NaN         NaN\n",
      "3 Hispanic 6.8875151         NaN          NaN         NaN\n",
      "4    Other 0.7298836         NaN          NaN         NaN\n"
     ]
    }
   ],
   "source": [
    "# Model variables (renamed version)\n",
    "vars_in_model <- c(\n",
    "  \"binge\", \"age_sq\", \"sex\", \"inc\", \"edu\", \"year\",\n",
    "  \"emp\", \"marital\", \"ins\", \"home\",\n",
    "  \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"MCC\"\n",
    ")\n",
    "\n",
    "# Check if all categorical vars have ≥2 levels\n",
    "has_valid_factors <- function(data, vars) {\n",
    "  all(sapply(vars, function(var) {\n",
    "    val <- data[[var]]\n",
    "    !is.factor(val) || length(unique(val[!is.na(val)])) > 1\n",
    "  }))\n",
    "}\n",
    "\n",
    "# Formula for bad physical health\n",
    "model_formula <- as.formula(\n",
    "  paste(\"bad_phys ~\", paste(vars_in_model, collapse = \" + \"))\n",
    ")\n",
    "\n",
    "# Subset design \n",
    "get_clean_subset <- function(design, group_name) {\n",
    "  subset_design <- subset(design, race == group_name)\n",
    "  subset_design$variables <- droplevels(subset_design$variables)\n",
    "  return(subset_design)\n",
    "}\n",
    "\n",
    "# survey model\n",
    "safe_svyglm <- function(design) {\n",
    "  data_vars <- design$variables\n",
    "  if (has_valid_factors(data_vars, vars_in_model)) {\n",
    "    svyglm(model_formula, design = design, family = quasibinomial())\n",
    "  } else {\n",
    "    warning(\"Some variables have only one level. Model skipped.\")\n",
    "    return(NULL)\n",
    "  }\n",
    "}\n",
    "\n",
    "# Create subsets\n",
    "brfss_white    <- get_clean_subset(brfss_svy, \"Non-Hispanic White\")\n",
    "brfss_black    <- get_clean_subset(brfss_svy, \"Non-Hispanic Black\")\n",
    "brfss_hispanic <- get_clean_subset(brfss_svy, \"Hispanic\")\n",
    "brfss_other    <- get_clean_subset(brfss_svy, \"Non-Hispanic Other\")\n",
    "\n",
    "# Fit models\n",
    "model_white_bph    <- safe_svyglm(brfss_white)\n",
    "model_black_bph    <- safe_svyglm(brfss_black)\n",
    "model_hispanic_bph <- safe_svyglm(brfss_hispanic)\n",
    "model_other_bph    <- safe_svyglm(brfss_other)\n",
    "\n",
    "# Extract Binge ORs\n",
    "extract_binge_or <- function(model) {\n",
    "  if (is.null(model) || !\"binge1\" %in% names(coef(model))) {\n",
    "    return(c(OR = NA, Lower = NA, Upper = NA, p = NA))\n",
    "  }\n",
    "  or <- exp(coef(model)[\"binge1\"])\n",
    "  ci <- exp(confint(model)[\"binge1\", ])\n",
    "  p <- summary(model)$coefficients[\"binge1\", \"Pr(>|t|)\"]\n",
    "  return(c(OR = or, Lower = ci[1], Upper = ci[2], p = p))\n",
    "}\n",
    "\n",
    "# Build results table\n",
    "results_stratified_bph <- data.frame(\n",
    "  Group = c(\"White\", \"Black\", \"Hispanic\", \"Other\"),\n",
    "  t(sapply(list(model_white_bph, model_black_bph, model_hispanic_bph, model_other_bph), extract_binge_or))\n",
    ")\n",
    "\n",
    "print(results_stratified_bph)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e56abcc9-93cd-47c0-a5c6-df4b900c70e2",
   "metadata": {},
   "source": [
    "# Step 15C :Stratified Models(ActivityLimitation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "442a80c5-f7e7-427f-9c17-a219b0f8f7d1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     Group OR.binge1 Lower.2.5.. Upper.97.5..           p\n",
      "1    White 0.3685683   0.1877417    0.7235611 0.003817979\n",
      "2    Black 0.1495800         NaN          NaN         NaN\n",
      "3 Hispanic 1.0096740         NaN          NaN         NaN\n",
      "4    Other 1.1836372         NaN          NaN         NaN\n"
     ]
    }
   ],
   "source": [
    "# 1. Predictor variables (renamed format)\n",
    "vars_in_model <- c(\n",
    "  \"binge\", \"age_sq\", \"sex\", \"inc\", \"edu\", \"year\",\n",
    "  \"emp\", \"marital\", \"ins\", \"home\",\n",
    "  \"smoke\", \"heavy\", \"active\", \"bmi\",\n",
    "  \"asthma\", \"arth\", \"copd\", \"chd\", \"diab\",\n",
    "  \"kidney\", \"stroke\", \"disab\", \"MCC\"\n",
    ")\n",
    "\n",
    "# 2. Check if all categorical vars have ≥2 levels\n",
    "has_valid_factors <- function(data, vars) {\n",
    "  all(sapply(vars, function(var) {\n",
    "    val <- data[[var]]\n",
    "    !is.factor(val) || length(unique(val[!is.na(val)])) > 1\n",
    "  }))\n",
    "}\n",
    "\n",
    "# 3. Build model formula for activity limitation\n",
    "model_formula <- as.formula(\n",
    "  paste(\"activity_limit ~\", paste(vars_in_model, collapse = \" + \"))\n",
    ")\n",
    "\n",
    "# 4. Function to subset survey design by race\n",
    "get_clean_subset <- function(design, group_name) {\n",
    "  subset_design <- subset(design, race == group_name)\n",
    "  subset_design$variables <- droplevels(subset_design$variables)\n",
    "  return(subset_design)\n",
    "}\n",
    "\n",
    "# 5. model-fitting wrapper\n",
    "safe_svyglm <- function(design) {\n",
    "  data_vars <- design$variables\n",
    "  if (has_valid_factors(data_vars, vars_in_model)) {\n",
    "    svyglm(model_formula, design = design, family = quasibinomial())\n",
    "  } else {\n",
    "    warning(\"Some variables have only one level. Model skipped.\")\n",
    "    return(NULL)\n",
    "  }\n",
    "}\n",
    "\n",
    "# 6. Subset design by race\n",
    "brfss_white    <- get_clean_subset(brfss_svy, \"Non-Hispanic White\")\n",
    "brfss_black    <- get_clean_subset(brfss_svy, \"Non-Hispanic Black\")\n",
    "brfss_hispanic <- get_clean_subset(brfss_svy, \"Hispanic\")\n",
    "brfss_other    <- get_clean_subset(brfss_svy, \"Non-Hispanic Other\")\n",
    "\n",
    "# 7. Fit models\n",
    "model_white_al    <- safe_svyglm(brfss_white)\n",
    "model_black_al    <- safe_svyglm(brfss_black)\n",
    "model_hispanic_al <- safe_svyglm(brfss_hispanic)\n",
    "model_other_al    <- safe_svyglm(brfss_other)\n",
    "\n",
    "# 8. Extract OR and CI for binge1\n",
    "extract_binge_or <- function(model) {\n",
    "  if (is.null(model) || !\"binge1\" %in% names(coef(model))) {\n",
    "    return(c(OR = NA, Lower = NA, Upper = NA, p = NA))\n",
    "  }\n",
    "  or <- exp(coef(model)[\"binge1\"])\n",
    "  ci <- exp(confint(model)[\"binge1\", ])\n",
    "  p <- summary(model)$coefficients[\"binge1\", \"Pr(>|t|)\"]\n",
    "  return(c(OR = or, Lower = ci[1], Upper = ci[2], p = p))\n",
    "}\n",
    "\n",
    "\n",
    "# 9. Create results table\n",
    "results_stratified_al <- data.frame(\n",
    "  Group = c(\"White\", \"Black\", \"Hispanic\", \"Other\"),\n",
    "  t(sapply(list(model_white_al, model_black_al, model_hispanic_al, model_other_al), extract_binge_or))\n",
    ")\n",
    "\n",
    "# 10. Print results\n",
    "print(results_stratified_al)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bbe8b644-a6fa-407c-a85f-89339b8e834e",
   "metadata": {},
   "source": [
    "# Stratified ORs Side-by-Side by Race/Ethnicity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "2466684c-a081-42d6-8059-f60be98a9684",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning message:\n",
      "\"package 'tidyr' was built under R version 4.5.1\"\n",
      "\n",
      "Attaching package: 'tidyr'\n",
      "\n",
      "\n",
      "The following objects are masked from 'package:Matrix':\n",
      "\n",
      "    expand, pack, unpack\n",
      "\n",
      "\n"
     ]
    },
    {
     "ename": "ERROR",
     "evalue": "Error: object 'results_stratified_srh' not found\n",
     "output_type": "error",
     "traceback": [
      "Error: object 'results_stratified_srh' not found\nTraceback:\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "library(dplyr)\n",
    "library(gt)\n",
    "library(tidyr)\n",
    "\n",
    "\n",
    "# STEP 1: Standardize Column Names\n",
    "\n",
    "colnames(results_stratified_srh)[2:5] <- c(\"or\", \"lower\", \"upper\", \"p\")\n",
    "colnames(results_stratified_bph)[2:5] <- c(\"or\", \"lower\", \"upper\", \"p\")\n",
    "colnames(results_stratified_al)[2:5]  <- c(\"or\", \"lower\", \"upper\", \"p\")\n",
    "\n",
    "\n",
    "# STEP 2: Add Outcome Labels\n",
    "\n",
    "results_stratified_srh$outcome <- \"srh\"\n",
    "results_stratified_bph$outcome <- \"bad_phys\"\n",
    "results_stratified_al$outcome  <- \"activity_limit\"\n",
    "\n",
    "\n",
    "# STEP 3: Combine All Outcome Tables\n",
    "\n",
    "combined_stratified <- bind_rows(\n",
    "  results_stratified_srh,\n",
    "  results_stratified_bph,\n",
    "  results_stratified_al\n",
    ")\n",
    "\n",
    "\n",
    "# STEP 4: Create \"OR (CI)\" Column\n",
    "\n",
    "combined_stratified <- combined_stratified %>%\n",
    "  mutate(\n",
    "    or_ci = ifelse(\n",
    "      !is.na(or),\n",
    "      sprintf(\"%.2f (%.2f–%.2f)\", or, lower, upper),\n",
    "      \"NA\"\n",
    "    )\n",
    "  )\n",
    "\n",
    "\n",
    "# STEP 5: Pivot to Wide Format\n",
    "\n",
    "table_stratified <- combined_stratified %>%\n",
    "  select(Group, outcome, or_ci) %>%\n",
    "  pivot_wider(names_from = outcome, values_from = or_ci)\n",
    "\n",
    "\n",
    "# STEP 6: Generate GT Table\n",
    "\n",
    "gt_table <- table_stratified %>%\n",
    "  gt() %>%\n",
    "  tab_header(\n",
    "    title = md(\"**Table X. Stratified Odds Ratios for Binge Drinking and Health Outcomes by Race/Ethnicity**\"),\n",
    "    subtitle = \"Survey-weighted logistic regression models for Self-Rated Health, Bad Physical Health, and Activity Limitation\"\n",
    "  ) %>%\n",
    "  cols_label(\n",
    "    Group = \"Race/Ethnicity\",\n",
    "    srh = \"Self-Rated Health OR (95% CI)\",\n",
    "    bad_phys = \"Bad Physical Health OR (95% CI)\",\n",
    "    activity_limit = \"Activity Limitation OR (95% CI)\"\n",
    "  ) %>%\n",
    "  cols_align(align = \"center\", columns = everything()) %>%\n",
    "  tab_options(table.font.size = \"small\")\n",
    "\n",
    "\n",
    "# STEP 7: Save Table to HTML\n",
    "\n",
    "gtsave(gt_table, \"C:/Users/chava/Downloads/Recent_Research_Activity/Output/stratified_binge_ORs_by_race.html\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "0c8e02f4-b105-4cf6-b732-cfd905f4b446",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Question: Does the link between binge drinking and poor health differ across racial/ethnic groups?\n",
    "#White adults showed the strongest protective effect of binge drinking on activity limitation (OR = 0.72), \n",
    "#compared to other racial/ethnic groups.\n",
    "\n",
    "#For Black adults, the effect is only significant for activity limitation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "7c18d0db-4b99-43e0-b89f-c9297edba100",
   "metadata": {},
   "outputs": [
    {
     "ename": "ERROR",
     "evalue": "Error: object 'or_data' not found\n",
     "output_type": "error",
     "traceback": [
      "Error: object 'or_data' not found\nTraceback:\n",
      "1. .handleSimpleError(function (cnd) \n . {\n .     watcher$capture_plot_and_output()\n .     cnd <- sanitize_call(cnd)\n .     watcher$push(cnd)\n .     switch(on_error, continue = invokeRestart(\"eval_continue\"), \n .         stop = invokeRestart(\"eval_stop\"), error = NULL)\n . }, \"object 'or_data' not found\", base::quote(eval(expr, envir)))"
     ]
    }
   ],
   "source": [
    "# Load required packages\n",
    "library(ggplot2)\n",
    "\n",
    "# Forest plot with confidence intervals\n",
    "ggplot(or_data, aes(x = RaceEthnicity, y = OR, ymin = CI_low, ymax = CI_high)) +\n",
    "  geom_pointrange(position = position_dodge(width = 0.5), color = \"steelblue\", size = 0.8) +\n",
    "  geom_hline(yintercept = 1, linetype = \"dashed\", color = \"darkred\") +\n",
    "  facet_wrap(~ Outcome, ncol = 1, scales = \"free_y\") +\n",
    "  labs(\n",
    "    title = \"Stratified Odds Ratios of Binge Drinking and Health Outcomes by Race/Ethnicity\",\n",
    "    x = \"Race/Ethnicity\",\n",
    "    y = \"Odds Ratio (95% CI)\"\n",
    "  ) +\n",
    "  theme_minimal(base_size = 13) +\n",
    "  theme(\n",
    "    strip.text = element_text(face = \"bold\"),\n",
    "    axis.text.x = element_text(angle = 45, hjust = 1)\n",
    "  )\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "cfd87b1a-ea92-4e28-9e3e-20a443d93752",
   "metadata": {},
   "outputs": [],
   "source": [
    "# ggplot(or_data, aes(x = race, y = or, fill = outcome)) +\n",
    "#   geom_col(position = position_dodge(width = 0.7), width = 0.6) +\n",
    "#   geom_hline(yintercept = 1, linetype = \"dashed\", color = \"gray40\") +\n",
    "#   labs(\n",
    "#     title = \"Binge Drinking and Health: Odds Ratios by Race\",\n",
    "#     y = \"Odds Ratio\",\n",
    "#     x = \"Race/Ethnicity\"\n",
    "#   ) +\n",
    "#   theme_minimal() +\n",
    "#   scale_fill_brewer(palette = \"Set2\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "7abf4ac7-713e-4896-ab68-830d32a0c8fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#People with less education (HS graduates) are more likely to report poor health.\n",
    "\n",
    "#People with lower education levels (especially high school grads) were more likely to report poor health than college graduates.\n",
    "#These results suggest that education level and drinking behavior are both strongly related to self-reported health,\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "90e1fd86-de90-4391-826f-30991337c04e",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "1528e30f-b203-47b7-90ab-899b5bd560bf",
   "metadata": {},
   "source": [
    "# Forest plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "d58f3ac9-6b98-47c9-86b8-2f24750fea11",
   "metadata": {},
   "outputs": [
    {
     "ename": "ERROR",
     "evalue": "Error: object 'forest_data' not found\n",
     "output_type": "error",
     "traceback": [
      "Error: object 'forest_data' not found\nTraceback:\n",
      "1. .handleSimpleError(function (cnd) \n . {\n .     watcher$capture_plot_and_output()\n .     cnd <- sanitize_call(cnd)\n .     watcher$push(cnd)\n .     switch(on_error, continue = invokeRestart(\"eval_continue\"), \n .         stop = invokeRestart(\"eval_stop\"), error = NULL)\n . }, \"object 'forest_data' not found\", base::quote(eval(expr, envir)))"
     ]
    }
   ],
   "source": [
    "ggplot(forest_data, aes(x = estimate, y = term)) +\n",
    "  geom_point(size = 3, color = \"steelblue\") +\n",
    "  geom_errorbar(\n",
    "    aes(xmin = conf.low, xmax = conf.high),\n",
    "    orientation = \"y\",\n",
    "    width = 0.2,\n",
    "    color = \"steelblue\"\n",
    "  ) +\n",
    "  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"gray50\") +\n",
    "  scale_x_log10() +\n",
    "  labs(\n",
    "    title = \"Interaction: Binge Drinking × Education on Bad Physical Health\",\n",
    "    x = \"Adjusted Odds Ratio (log scale)\",\n",
    "    y = NULL\n",
    "  ) +\n",
    "  theme_minimal(base_size = 13)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "66e3e82d-f8a8-4d7a-a568-aa0fcf2d8002",
   "metadata": {},
   "outputs": [],
   "source": [
    "#People who binge drink seem to have slightly lower chances of reporting bad physical health than those who don’t binge drink.\n",
    "# does that mean binge drinking is healthy?\n",
    "#People who binge drink might be younger or healthier overall, so they don’t report bad health — but that’s not because of binge drinking.\n",
    "\n",
    "\n",
    "#That’s why you looked at interactions like:\n",
    "#BingeDrinker * Education\n",
    "\n",
    "#BingeDrinker * Age\n",
    "#In some groups — like people with less education — binge drinking is actually linked to worse health (OR > 1).\n",
    "\n",
    "\n",
    "#Binge drinkers overall look slightly healthier — but this is likely because they’re younger or have other advantages.\n",
    "\n",
    "#But when you look at specific groups, binge drinking shows a harmful effect, especially for people with less education or other risk factors."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 367,
   "id": "e85827ec-d298-4750-8a59-129c5bdda57a",
   "metadata": {},
   "outputs": [],
   "source": [
    "ggsave(\"C:/Users/chava/Downloads/Recent_Research_Activity/Output/interaction_binge_edu_forestplot.jpg\", \n",
    "       width = 8, height = 5, dpi = 300)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "471ed826-f36e-4e59-80ff-ef507acf66b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#None of the associations are statistically significant, as all p-values are > 0.05.\n",
    "\n",
    "\n",
    "# positive association (OR > 1) in Black adults\n",
    "\n",
    "# Weak negative or null associations (OR ≤ 1) in White, Hispanic, and Other adults\n",
    "\n",
    "#### This suggests that the impact of binge drinking on self-rated health may differ across racial/ethnic groups, even if it is not conclusive in this sample."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "c71b4590-c546-43f5-b564-3d067d89d7cd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "2762"
      ],
      "text/latex": [
       "2762"
      ],
      "text/markdown": [
       "2762"
      ],
      "text/plain": [
       "[1] 2762"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "nrow(brfss_merged2)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a5df152-5222-47ae-a2e2-d6bcd91ae7ef",
   "metadata": {},
   "source": [
    "### Self-rated health (SRH)\n",
    "table(brfss_merged2$srh, useNA = \"ifany\")\n",
    "\n",
    "# Bad physical health\n",
    "table(brfss_merged2$bad_phys, useNA = \"ifany\")\n",
    "\n",
    "# Activity limitation\n",
    "table(brfss_merged2$activity_limit, useNA = \"ifany\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "id": "0982d364-34d5-4496-8fdd-ded767be8169",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "          Hispanic Non-Hispanic Black Non-Hispanic Other Non-Hispanic White \n",
       "               212                231                220               2099 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "table(brfss_merged2$race, useNA = \"ifany\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c88d112-fbbb-4dae-b8bb-02a7ff69c6bb",
   "metadata": {},
   "source": [
    "# **Title: Exploring the Intersection of Binge Drinking, Social Determinants, and Physical Health Outcomes in U.S. Adults (2013–2019)**\n",
    "\n",
    "**INTRODUCTION**\n",
    "\n",
    "Binge drinking is a prevalent and persistent public health issue in the United States, associated with a range of adverse physical and mental health outcomes. Defined by the CDC as consuming four or more drinks on a single occasion for women, or five or more for men, binge drinking has been linked to increased risk of chronic disease, injury, and mortality. While prior research has extensively documented the prevalence and behavioral correlates of binge drinking, less is known about how its health consequences vary across sociodemographic groups and whether these consequences are moderated by structural determinants such as income, education, or insurance coverage.\n",
    "\n",
    "In particular, the burden of binge drinking and its downstream effects may not be evenly distributed. Emerging evidence suggests that individuals from racial and ethnic minority groups may suffer disproportionate harms from similar patterns of alcohol use, due to the compounding effects of social disadvantage. For instance, Price et al. (2023) found that racial/ethnic disparities in alcohol-related frequent mental distress were most pronounced among socially disadvantaged adults, highlighting the moderating role of social determinants in shaping the consequences of substance use.\n",
    "\n",
    "Building on this framework, the present study investigates the intersection between binge drinking, social determinants of health, and three key physical health outcomes among U.S. adults: **self-rated health (SRH)**, **bad physical health days**, and **activity limitation**. We use data from the Behavioral Risk Factor Surveillance System (BRFSS) from 2013 to 2019, a nationally representative survey that captures a wide array of health behaviors, chronic conditions, and access to care indicators.\n",
    "\n",
    "**Research Objectives**\n",
    "\n",
    "This study addresses the following primary research questions:\n",
    "\n",
    "1. What is the association between binge drinking and physical health outcomes (self-rated health, bad physical health, and activity limitation) after accounting for relevant sociodemographic and behavioral covariates?\n",
    "2. Do social determinants of health – including income, education, and insurance status – moderate this association?\n",
    "3. Are these relationships more pronounced among specific racial/ethnic subgroups, suggesting a \"double disadvantage\" for minoritized populations?\n",
    "\n",
    "**Rationale and Significance**\n",
    "\n",
    "* **Social determinants as effect modifiers**: Individuals with lower income or education and those without insurance often face higher levels of stress, limited access to healthcare, and greater exposure to environmental risk factors. These conditions may intensify the impact of alcohol on physical health.\n",
    "\n",
    "* **Emphasis on equity**: If binge drinking is more harmful for certain subgroups, prevention and treatment efforts must be tailored accordingly. Recognizing interaction effects can guide better allocation of public health resources.\n",
    "\n",
    "* **Expanding prior literature**: While much existing research (e.g., Price et al.) focuses on mental health outcomes, we aim to examine downstream physical health effects to offer a more comprehensive understanding of alcohol-related disparities.\n",
    "\n",
    "**Data and Measures**\n",
    "\n",
    "* **Binge drinking**: Self-reported, defined as ≥ 4 (women) / ≥ 5 (men) drinks in one sitting in the past 30 days.\n",
    "\n",
    "* **Physical health outcomes**:\n",
    "\n",
    "  * **Self-rated health**: Dichotomized as \"good/very good/excellent\" vs. \"fair/poor\".\n",
    "  * **Bad physical health**: ≥14 days in the past 30 when physical health was \"not good.\"\n",
    "  * **Activity limitation**: ≥14 days when poor health interfered with daily activities.\n",
    "\n",
    "* **Social determinants**: Education (4 levels), income (6 categories), and insurance status (insured/uninsured).\n",
    "\n",
    "* **Covariates**: Age, sex, race/ethnicity, marital status, employment status, health behaviors (e.g., smoking, physical activity), chronic conditions (e.g., asthma, diabetes), BMI, and survey year.\n",
    "\n",
    "**Analytical Approach**\n",
    "\n",
    "* **Survey-weighted logistic regression** was used to account for BRFSS's complex sampling design.\n",
    "* **Nested models** were built to assess how adding sociodemographic and clinical variables influenced the binge drinking-health relationship.\n",
    "* **Interaction models** tested moderation by race, education, income, and other social determinants.\n",
    "* **Stratified analyses** examined these associations within racial/ethnic groups to explore heterogeneity.\n",
    "\n",
    "By combining methodological rigor with a health equity lens, this study aims to clarify the pathways through which binge drinking contributes to poor physical health outcomes, and to identify which populations are most at risk.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5841e68f-d22e-42fa-a48c-1f2752ca1f71",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R 4.x (updated)",
   "language": "R",
   "name": "ir41"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
